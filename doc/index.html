<!DOCTYPE HTML>
<!--
  Editorial by Pixelarity
  pixelarity.com | hello@pixelarity.com
  License: pixelarity.com/license
-->
<html lang="en">
  <head>
    <title>CAT12 Manual</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/main.css" >
    
    
<!-- ############################# -->

  </head>
  <body class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper">

      <!-- Main -->
      <div id="main">
        <div class="inner">

        <!-- Content -->
        <section>

          <!-- Introduction -->
          <div id="content">
            
            <h1>Manual Computational Anatomy Toolbox CAT12</h1>
                          
            <!-- ################################################################################# -->
            <h2 id="intro">Introduction and overview</h2>
            
            <!-- ############################# -->
            <h4 id="intro_cat12">Introduction</h4>
            <p class="image right"><img width=100% alt="Human Brain" src="images/human_brain.png"></p>
            <p>
              The brain is the most complex organ of the human body, and no two brains are alike. The study of the human brain is still in its infancy, but rapid technical advances in image acquisition and image processing have allowed for ever more refined characterizations of its micro- and macro-structure. Enormous efforts, for example, have been made to map differences between groups (e.g., young vs. old, diseased vs. healthy, male vs. female), to capture changes over time (e.g., from infancy to old age, or in the framework of neuroplasticity, as a result of a clinical intervention), or to assess correlations of brain attributes (e.g., measures of length, volume, shape) with behavioral, cognitive, or clinical parameters.
            </p>
            <div class="image left"><img width=60% alt="Logo" src="images/cat_logo.png"></div>
            <p>
              CAT12 is a powerful suite of tools for morphometric analyses with an intuitive graphical user interface, but also usable as a shell script. CAT is suitable for beginners, casual users, experts, and developers alike providing a comprehensive set of analysis options, workflows, and integrated pipelines. The available analysis streams allow for voxel-based, surface-based, as well as region-based morphometric analyses. Importantly, CAT includes various quality control options and covers the entire analysis workflow, from cross-sectional or longitudinal data processing, to the statistical analysis, and visualization of results. 
            </p>

            <!-- ############################# -->
            <h4 id="overview">Overview about the manual</h4>
            <p>This manual is intended to help any user to perform a computational anatomy analysis using the CAT12 Toolbox. Although it mainly focuses on voxel-based morphometry (VBM) other variants of computational analysis such as deformation-based morphometry (DBM), surface-based morphometry (SBM), and region of interest (ROI) morphometric analysis are also presented and can be applied with few changes.</p>

            The manual can be divided into four main sections:<br>              
            <ul>
              <li>Naturally, a quick guide of how to <a href="#get_started">get started</a> is given at the beginning. This section provides information about <a href="#download">downloading and installing</a> the software and <a href="#starting">starting</a> the Toolbox. Also, a <a href="#basic_vbm">brief overview</a> of the steps of a VBM analysis is given.</li>
              <li>This is followed by a <a href="#process_data">detailed description of a basic VBM analysis</a> that guides the user step-by-step through the entire process - from preprocessing to contrast selection. This description should provide all the information necessary to successfully analyze most studies.</li>
              <li>There are some specific cases of VBM analyses, for which the basic analysis workflow has to be adapted. These cases are <a href="#long">longitudinal studies</a> and studies in <a href="#children">children or special patient populations</a>. Relevant changes to a basic VBM analysis are described here and how these changes can be applied. Only the changes are described here - steps such as quality control or smoothing are the same as those described in the basic analysis and are not repeated a second time.</li>
              <li>The guide concludes with <a href="#add_info">additional information</a> about spaces after registration, naming conventions used and other hints.</li>
            </ul>
            
            <!-- ################################################################################# -->
            <h2 id="quick">Quick start guide</h2>

            <!-- ############################# -->
            <h4 id="vbm_data">VBM data</h4>
            
            <ul>
              <li><a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.estwrite');">Segment</a> data using defaults (use <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.long');">Segment Longitudinal Data</a> for longitudinal data).<br>
              The resulting segmentations that can now be used for VBM are saved in the "mri" folder and are named "mwp1" for gray matter and "mwp2" for white matter. If you have used the longitudinal pipeline, the default segmentations for gray matter are named "mwp1r" or "mwmwp1r" if the  longitudinal model for detecting larger changes was selected.</li>
              <li>Get total intracranial volume<a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.calcvol');"> (TIV)</a> to correct for different brain sizes and volumes.<br>
              Select the xml-files that are saved in the "report" folder.</li>
              <li>Check the data quality with <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.check_homogeneity');">Sample Homogeneity</a> for VBM data (optionally consider TIV and age as nuisance variables).<br>
              Select the gray or white matter segmentations from the first step.</li>
              <li><a class="function" href="matlab:spm_jobman('interactive','','spm.spatial.smooth');">Smooth</a> data (recommended start value 6mm<sup>1</sup>).<br>
              Select the gray or white matter segmentations from the first step.</li>
              <li>Specify the <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">2nd-level Model</a> with the smoothed gray or white matter segmentations and check for design orthogonality and sample homogeneity:
              <ul>
                <li>Select "Two-sample t-test" or "Multiple regression" or use "Full factorial" for any cross-sectional data.</li>
                <li>Use "Flexible factorial" for longitudinal data.</li>
                <li>Use TIV as covariate (confound) to correct different brain sizes.</li>
                <li>Select threshold masking with an absolute value of 0.1. This threshold can ultimately be increased to 0.2 or even 0.25 if you still notice non-brain areas in your analysis.</li>
                <li>If you find a considerable correlation between TIV and any other parameter of interest it is advisable to use global scaling with TIV. For more information, refer to <a href="index.html#ortho">Orthogonality</a>.</li>
              </ul></li>
              <li><a class="function" href="matlab:spm_jobman('interactive','','spm.stats.fmri_est');">Estimate</a> the model and finally call <a class="function" href="matlab:[hReg xSPM SPM] = cat_spm_results_ui('Setup');">Results</a>.</li>
              <li>Optionally <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.T2x');">Transform and Threshold SPM-maps</a> to (log-scaled) p-maps or correlation maps.</li>
              <li>Optionally, you can try <a class="function" href="matlab:if exist('spm_TFCE'),spm_jobman('interactive','','spm.tools.tfce_estimate'), else cat_install_tfce, end;">Threshold-Free Cluster Enhancement</a> (TFCE) with the SPM.mat file of a previously estimated statistical design.</li>
              <li>Optionally <a class="function" href="matlab:cat_vol_slice_overlay;">Overlay Selected Slices</a>. If you are using log-p scaled maps from "Transform SPM-maps" without thresholds or the TFCE_log maps, use the following values as the lower range for the colormap for the thresholding: 1.3 (P&lt;0.05); 2 (P&lt;0.01); 3 (P&lt;0.001).</li>
              <li>Optionally use <a class="function" href="matlab:y=cat_surf_results;">Surface Overlay</a> for visualization of your results. Select the results (preferably saved as log-p maps with "Transform SPM-maps" or the TFCE_log maps with the different methods for multiple comparison correction) to display rendering views, slice overlay, and a glassbrain of your results.</li>
              <li>Optionally estimate results for ROI analysis using <a class="function" href="matlab:cat_stat_analyze_ROIs;">Analyze ROIs</a>. Here, the SPM.mat file of the already estimated statistical design will be used. For more information, see <a href="#atlas">Atlas Creation and ROI based Analysis</a>.</li>
            </ul>
        
            <!-- ############################# -->
            <h4 id="add_surf">Additional surface data</h4>
            
            <ul>
              <li><a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.estwrite');">Segment</a> data and also select "Surface and thickness estimation" under "Writing options" (for longitudinal data use <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.long');">Segment Longitudinal Data</a>).<br>
              The surfaces data are saved in the folder "surf" and are named "?h.thickness.*" for cortical thickness.</li>
              <li>Optionally, <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.stools.surfextract');">Extract Additional Surface Parameters</a> (e.g. sulcal depth, gyrification, cortical complexity).</li>
              <li><a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.stools.surfresamp');">Resample & smooth</a> surface data (suggested starting value 12mm for cortical thickness and 20-25mm for folding measures<b><sup>1</sup></b>, use the default merging of hemispheres).<br>
              Select the "lh.thickness.*" data in the folder "surf". The resampled data are named "s12.mesh.resampled_32k.thickness.*" for 12mm smoothed, merged hemispheres that were resampled to 32k template space.</li>
              <li>Check data quality of the resampled data using <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.check_homogeneity');">Sample Homogeneity</a>.</li>
              <li>Build <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">2nd-level Model</a> for the resampled data and check for design orthogonality and sample homogeneity.
              <ul>
                <li>Select "Two-sample t-test" or "Multiple regression" or use "Full factorial" for any cross-sectional data.</li>
                <li>Use "Flexible factorial" for longitudinal data.</li>
                <li>It is not necessary to use TIV as a covariate (confound) because cortical thickness or other surface values are usually not dependent on TIV.</li>
                <li>It is not necessary to use any threshold masking.</li>
                <li>If you find a considerable correlation between a nuisance parameter and any other parameter of interest it is advisable to use global scaling with that parameter. For more information, refer to <a href="index.html#ortho">Orthogonality</a>.</li>
              </ul></li>
              <li><a class="function" href="matlab:cat_stat_spm;">Estimate</a> the surface model and finally call <a class="function" href="matlab:[hReg xSPM SPM] = cat_spm_results_ui('Setup');">Results</a>.</li>
              <li>Optionally <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.T2x_surf');">Transform and Threshold SPM-maps</a> to (log-scaled) p-maps or correlation maps.</li>
              <li>Optionally, you can try <a class="function" href="matlab:if exist('spm_TFCE'),spm_jobman('interactive','','spm.tools.tfce_estimate'), else cat_install_tfce, end;">Threshold-Free Cluster Enhancement</a> (TFCE) with the SPM.mat file of a previously estimated statistical design.</li>
              <li>Optionally use <a class="function" href="matlab:y=cat_surf_results;">Surface Overlay</a> for visualization of your results. Select the results (preferably saved as log-p maps with "Transform SPM-maps" or the TFCE_log maps with the different methods for multiple comparison correction) for the merged hemispheres to display rendering views of your results.</li>
              <li>Optionally <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.stools.surf2roi');">Extract ROI-based Surface Values</a> such as gyrification or fractal dimension to provide ROI analysis. Since version 12.7 extraction of ROI-based thickness is not necessary anymore because this is now included in the segmentation pipeline.</li>
              <li>Optionally estimate results for ROI analysis using <a class="function" href="matlab:cat_stat_analyze_ROIs;">Analyze ROIs</a>. Here, the SPM.mat file of the already estimated statistical design will be used. For more information, see <a href="#atlas">Atlas Creation and ROI based Analysis</a>.</li>
            </ul>
        
            <!-- ############################# -->
            <h5 id="add_opts">Additional options</h5>
            <p>Additional parameters and options are displayed in the <a class="function" href="matlab:cat12('expert');">CAT12 expert mode</a>. Please note that this mode is for experienced users only.</p>
        
            <!-- ############################# -->
            <h5 id="errors">Errors during preprocessing</h5>
            <p>Please use the <a class="function" href="matlab:cat_io_senderrormail;">Report Error</a> function if any errors during preprocessing occurred. You first have to select the "err" directory, which is located in the folder of the failed record, and finally, the specified zip-file should be attached manually in the mail.</p>
        
            <!-- ############################# -->
            <h5><sup>1</sup>Note to filter sizes for Gaussian smoothing</h5>
            <p>Smoothing increases the signal-to-noise ratio. The matched filter theorem states that the filter that matches your signal maximizes the signal-to-noise ratio. If we expect signal with a Gaussian shape and a FWHM of, say 6mm in our images, then this signal will be best detected after we smooth our images with a 6mm FWHM Gaussian filter. If you are trying to study small areas like the amygdala, we can use smaller filter sizes because of the small size of these regions. For larger regions like the cerebellum, the effects are better detected with larger filters.<br>
            Please also note that for the analysis of cortical folding measures such as gyrification or cortical complexity the filter sizes have to be larger (i.e. in the range of 15-25mm). This is due to the underlying nature of this measure that reflects contributions from both sulci as well as gyri. Therefore, the filter size should exceed the distance between a gyral crown and a sulcal fundus.</p>

          
            <!-- ################################################################################# -->
            <h2 id="version">Version information</h2>
            
            <p>
              Preprocessing should remain unaffected until the next minor version number (12.x). New processing of your data is not necessary if the minor version number of CAT12 remains unchanged.
            </p>
            
            <!-- ###################################### -->
            <h3>Changes in version CAT12.8.2 (2130)</h3>

            <details>
              <summary><u>Important new features</u></summary>
              <ul>
                <li>The CAT12 manual is now converted to HTML and merged with the online help to a single HTML file with interactive Matlab links that can be called in Matlab.</li>
                <li>Added new thalamic nuclei <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','thalamic_nuclei.nii')}}))">atlas</a>.</li>
                <li>Moved some rarely used CAT12 options to expert mode.</li>
                <li>Added many new options to <a class="function" href="matlab:y=cat_surf_results;">visualize 3D (VBM) results</a> (e.g. new glass brain)</li>
                <li>The tool to check <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.check_homogeneity');">Sample Homogeneity</a>. has many new options and is now based on calculation of Z-score which is much faster for larger samples./li>
                <li>New <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">Basic Models</a> to easier define cross-sectional and longitudinal statistical designs. Some unnecessary options have been removed compared to "Basic Models" in SPM12 and some useful options have been added.</li>
              </ul>
            </details>            

            <!-- ###################################### -->
            <h3>Changes in version CAT12.8.1 (1975)</h3>
            <details>            
              <summary><u>Changes in preprocessing pipeline (which affects your results compared to CAT12.8)</u></summary>
              <ul>
                <li>The longitudinal pipeline has been largely updated and is no longer compatible with preprocessing with version 12.8:
                <ul>
                  <li>The estimate of subject-specific TPM should now be more stable and less sensitive to changes between time points.</li>
                  <li>For data where the brain/head is still growing between time points and major changes are expected, a new longitudinal development model was added. For this type of data, an adapted pipeline was created that is very similar to the longitudinal aging model, but uses a time point-independent affine registration to adjust for brain/head growth. In addition, this model uses a subject-specific TPM based on the average image.</li>
                  <li>An additional longitudinal report is now provided to better assess differences between time points.</li>
                </ul></li>
              </ul>        
            </details>
            
            <!-- ###################################### -->
            <h3>Changes in version CAT12.8 (1830)</h3>
               
            <details>
              <summary><u>Changes in preprocessing pipeline (which affects your results compared to CAT12.7)</u></summary>
              <ul>
                <li>Volumetric templates, atlases, and TPMs are now transformed to MNI152NLin2009cAsym space to better match existing standards. The templates_volume folder is now renamed to ''templates_MNI152NLin2009cAsym'' to indicate the template space used. The Dartel and Geodesic Shooting templates are renamed or relocated:
                <ul>
                  <li>templates_volumes/Template_0_IXI555_MNI152_GS.nii &rarr; templates_MNI152NLin2009cAsym/Template_0_GS.nii</li>
                  <li>templates_volumes/Template_1_IXI555_MNI152.nii &rarr; templates_MNI152NLin2009cAsym/Template_1_Dartel.nii</li>
                  <li>templates_volumes/TPM_Age11.5.nii &rarr; templates_MNI152NLin2009cAsym/TPM_Age11.5.nii</li>
                  <li>templates_volumes/Template_T1_IXI555_MNI152_GS.nii &rarr; templates_MNI152NLin2009cAsym/Template_T1.nii</li>
                  <li>spm12/toolbox/FieldMap/T1.nii &rarr; templates_MNI152NLin2009cAsym/T1.nii</li>
                  <li>spm12/toolbox/FieldMap/brainmask.nii &rarr; templates_MNI152NLin2009cAsym/brainmask.nii</li>
                </ul></li>
                <li>The volumetric atlases have been revised and are now defined with a spatial resolution of 1mm, except for the Cobra atlas, which is defined with 0.6mm resolution. The labels of the original atlases were either transformed from the original data or recreated using a maximum likelihood approach when manual labels were available for all subjects (Cobra, LPBA40, IBSR, Hammers, Neuromorphometrics). In addition, the original labels are now used for all atlases if possible. Some atlases were updated to include new regions (Julichbrain, Hammers)  and a new atlas of thalamic nuclei was added. Please note that this will also result in slight differences in ROI estimates compared to previous versions.</li>
                <li>The bounding box of the Dartel and Geodesic Shooting templates has been changed, resulting in a slightly different image size of the spatially registered images (i.e. modulated normalized segmentations). Therefore, older preprocessed data should not (and cannot) be mixed with the new processed data (which is intended).</li>
                <li>Transformed T1 Dartel/GS surface templates to the new MNI152NLin2009cAsym space:
                <ul>
                  <li>templates_surfaces/lh.central.Template_T1_IXI555_MNI152_GS.gii  &rarr; templates_surfaces/lh.central.Template_T1.gii </li>
                  <li>templates_surfaces/rh.central.Template_T1_IXI555_MNI152_GS.gii  &rarr; templates_surfaces/rh.central.Template_T1.gii </li>
                  <li>templates_surfaces_32k/lh.central.Template_T1_IXI555_MNI152_GS.gii  &rarr; templates_surfaces_32k/lh.central.Template_T1.gii </li>
                  <li>templates_surfaces_32k/rh.central.Template_T1_IXI555_MNI152_GS.gii  &rarr; templates_surfaces_32k/rh.central.Template_T1.gii </li>
                </ul></li>
                <li>The surface pipeline has been optimized to better handle data at different spatial resolutions.</li>
                <li>Older preprocessing pipelines (12.1, 12.3, 12.6) were removed because their support became too difficult.</li>
              </ul>
            </details>            

            <details>
              <summary><u>Important new features</u></summary>
              <ul>
                <li>The Mahalanobis distance in the <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.check_homogeneity');">Quality Check</a> is now replaced by the normalized ratio between overall weighted image quality (IQR) and mean correlation. A low ratio indicates good quality before and after preprocessing and means that IQR is highly rated (resulting in a low nominal number/grade) and/or mean correlation is high. This is hopefully a more intuitive measure to combine image quality measurement before and after preprocessing.</li>
                <li>CAT12 now allows the use of the BIDS directory structure for storing data (not possible for the longitudinal pipeline). A BIDS path can be defined relative to the participant level directory. The segmentation module now supports the input of nii.gz files (not possible for the longitudinal pipeline).</li>
                <li>The <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">Basic Models</a> function has been completely restructured and simplified. There are now only two models available for: (1) cross-sectional data and (2) longitudinal data. Options that are not relevant for VBM or SBM have been removed. In addition, a new experimental option has been added that allows a voxel-wise covariate to be defined. This can be used (depending on the contrast defined) to (1) remove the nuisance effect of structural data (e.g. GM) on functional data or (2) examine the relationship (regression) between functional and structural data. Additionally, an interaction can be modeled to investigate whether the regression between functional and structural data differs between two groups. Please note that the saved vSPM.mat file can only be evaluated with the TFCE toolbox.</li>
                <li>Added a new function cat_io_data2mat.m to save spatially registered volume or resampled surface data as Matlab data matrix for further use with machine learning tools. Volume data can be resampled to lower spatial resolutions and can optionally be masked to remove non-brain areas.</li>
                <li>Added a new function <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.ROIsum');">cat_vol_ROI_summarize.m</a> to summarise co-registered volume data within a region of interest (ROI). This tool can be used in order to estimate ROI information for other (co-registered) modalities (i.e. DTI, (rs)fMRI) which can be also defined as 4D data. Several predefined summary functions are available, as well as the possibility to define your own function.</li>
                <li>Added a new function <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.quality_measures');">cat_stat_quality_measures.m</a> to estimate and save quality measures for very large samples.</li>
                <li>Added standalone tools for de-facing, DICOM import, and estimating and saving quality measures for large samples.</li>
              </ul>
            </details>            
        
            <!-- ###################################### -->
            <h3>Changes in version CAT12.7 (1700)</h3>

            <details>            
              <summary><u>Changes in preprocessing pipeline (which affects your results compared to CAT12.6)</u></summary>
              <ul>
                <li>Geodesic shooting registration and surface estimation are now used by default.</li>
                <li>The surface pipeline is largely updated: (1) Parameters for surface reconstruction were optimized. (2) Freesurfer distance method Tfs is now implemented, which is computed as the average of  the closest distances from the pial to the white matter surface and from the white matter to the pial surface. This reduces the occurrence of larger thickness values and results in more reliable thickness measures. For mapping of 3D data the old thickness metric from PBT is more appropriate and is still used.</li>
                <li>An additional longitudinal model is implemented that also takes into account deformations between time points. The use of deformations between the time points makes it possible to estimate and detect larger changes, while subtle effects over shorter periods of time in the range of weeks or a few months can be better detected with the model for small changes.</li>
                <li>Minor changes were made to the segmentation approach to improve accuracy and reliability.</li>
                <li>Internal resampling is now using a new ''optimal'' resolution setting to better support high-resolution data.</li>
                <li>Changed recommendation and defaults for smoothing size to smaller values.</li>
                <li>Renamed template folder for volumes to templates_volumes.</li>
                <li>Atlases installed in spm12/atlas are now called cat12_atlasname.</li>
                <li>The old AAL atlas has been replaced by the AAL3 atlas.</li>
                <li>Cobra atlas is updated because of some previous inconsistencies.</li>
              </ul>
            </details>            

            <details>            
              <summary><u>Important new features</u></summary>
              <ul>
                <li>New GUI</li>
                <li>Added older preprocessing pipelines (12.1, 12.3, 12.6) to provide compatible versions to previous preprocessing. These older preprocessing pipelines are available via the <a class="function" href="matlab:spm_jobman('interactive')">SPM batch editor</a> (SPM &rarr; Tools &rarr; CAT12) or through expert mode.</li>
                <li>Added simple batch for cross-sectional and longitudinal data that combines several processing steps from preprocessing to smoothing. These batches are available via the <a class="function" href="matlab:spm_jobman('interactive')">SPM batch editor</a>(SPM &rarr; Tools &rarr; CAT12) or through expert mode.</li>
                <li>The function <a class="function" href="matlab:y=cat_surf_results;">Display surface results</a> can now also visualize results from VBM analysis and map the 3D volume information onto the surface using an absmax mapping function inside the cortical band. The function is now renamed to ''Surface Overlay''.</li>
                <li>You can call <a class="function" href="matlab:[hReg xSPM SPM] = cat_spm_results_ui('Setup');">Results</a> now from the CAT12 GUI with some new functionality for surfaces and the option to call TFCE results.</li>
                <li>CAT12 now uses Piwik for anonymized CAT12 user statistics (i.e. version information, potential errors). See <a href="cat_statistics.html">CAT12 user statistics</a> for more information. This can be optionally disabled in <a class="function" href="matlab:edit('cat_defaults');">cat_defaults.m</a>.</li>
                <li>The extraction of ROI-based thickness is not necessary anymore because this is now included in the segmentation pipeline in cat_main.m.</li>
                <li>Changed gifti-format after resampling to use external dat-files. This increases processing speed and prevents the SPM.mat file for surfaces from becoming too large. This can be optionally disabled in <a class="function" href="matlab:edit('cat_defaults');">cat_defaults.m</a>.</li>
                <li>The use of own atlases for ROI processing is now supported.</li>
                <li>Updated and extended examples for statistical designs and respective contrasts in the CAT12 manual.</li>
              </ul>
            </details>            
            
            <!-- ###################################### -->
            <h3>Changes in version CAT12.6 (1445)</h3>

            <details>            
              <summary><u>Changes in preprocessing pipeline (which affects your results compared to CAT12.5)</u></summary>
              <ul>
                <li>Two main parts of the preprocessing of CAT12 were largely updated: (1) Incorrect estimates of the initial affine registration were found to be critical for all subsequent preprocessing steps and mainly concerned skull-stripping and tissue segmentation. This was a particular problem in the brains of older people or children, where the thickness of the skull differs from that of the template. The new estimate of the initial affine registration should now be more robust. In the CAT report, the registered contour of the skull and the brain is now overlayed onto the image to allow for easier quality control. (2) Skull-stripping now uses a new adaptive probability region-growing (APRG) approach, which should also be more robust. APRG refines the probability maps of the SPM approach by region-growing techniques of the gcut approach with a final surface-based optimization strategy. This is currently the method with the most accurate and reliable results.</li>
                <li>The longitudinal pipeline should now also be more sensitive for the detection of effects over longer time periods with VBM (ROI and SBM approaches are not affected by the length of the period). In earlier versions, the average image was used to estimate the spatial registration parameters for all time points. Sometimes this average image was not as accurate if the images of a subject were too different (e.g. due to large ventricular changes). Now, we rather use the average spatial registration parameters (i.e. deformations) of all time points, which makes the approach more robust for longer periods of time. However, the SPM12 Longitudinal Toolbox can be a good alternative for longer periods of time if you want to analyze your data voxel by voxel. Surface-based preprocessing and also the ROI estimates in CAT12 are not affected by the potentially lower sensitivity to larger changes, as the realigned images are used independently to create cortical surfaces, thickness, or ROI estimates.</li>
              </ul>
            </details>            

            <details>
              <summary><u>Important new features</u></summary>
              <ul>
                <li>CAT report now additionally plots the contour of the registered skull and brain onto the image and visualizes skull-stripping. <a class="function" href="matlab:y=cat_surf_results;">Display surface results</a> is largely updated. </li>
                <li>Parallelization options in CAT12 now enable subsequent batch jobs and are also  supported for longitudinal preprocessing.</li>
              </ul>
            </details>            
            
            <!-- ###################################### -->
            <h3>Changes in version CAT12.5 (1355)</h3>

            <details>
              <summary><u>Changes in preprocessing pipeline (which affects your results compared to CAT12.3)</u></summary>
              <ul>
                <li>Detection of white matter hyperintensities (WMHs) is updated and again enabled by default.</li>
                <li>The default internal interpolation setting is now "Fixed 1 mm" and offers a good trade-off between optimal quality and preprocessing time and memory demands. Standard structural data with a voxel resolution around 1 mm or even data with high in-plane resolution and large slice thickness (e.g. 0.5x0.5x1.5 mm) will benefit from this setting. If you have higher native resolutions the highres option "Fixed 0.8 mm" will sometimes offer slightly better preprocessing quality with an increase of preprocessing time and memory demands.</li>
              </ul>
            </details>            

            <details>            
              <summary><u>Important new features</u></summary>
              <ul>
                <li>CAT12 can now deal with lesions that have to be set to zero in your image using the Stroke Lesion Correction (SLC) in expert mode. These lesion areas are not used for segmentation or spatial registration, thus these preprocessing steps should be almost unaffected.</li>
              </ul>
            </details>            
            
            <!-- ###################################### -->
            <h3>Changes in version CAT12.4 (1342)</h3>
              
            <ul>
              <li>This version had some severe errors in spatial registration which affected all spatially registered data and should not be used anymore.</li>
            </ul>
            
            <!-- ###################################### -->
            <h3>Changes in version CAT12.3 (1310)</h3>
               
            <details>            
              <summary><u>Changes in preprocessing pipeline (which affects your results compared to CAT12.2)</u></summary>
              <ul>
                <li>Skull-stripping is again slightly changed and the SPM approach is now used as default. The SPM approach works quite well for the majority of data. However, in some rare cases, parts of GM (i.e. in the frontal lobe) might be cut. If this happens the GCUT approach is a good alternative.</li>
                <li>Spatial adaptive non-local mean (SANLM) filter is again called as a very first step because noise estimation and de-noising works best for original (non-interpolated) data.</li>
                <li>Detection of white matter hyperintensities (WMHs) is currently disabled by default, because of unreliable results for some data.</li>
              </ul>
            </details>            

            <details>            
              <summary><u>Important new features</u></summary>
              <ul>
                <li>Cobra atlas has been largely extended and updated.</li>
              </ul>
            </details>            
            
            <!-- ###################################### -->
            <h3>Changes in version CAT12.2 (1290)</h3>

            <details>            
              <summary><u>Changes in preprocessing pipeline (which affects your results compared to CAT12.1)</u></summary>
              <ul>
                <li>Skull-stripping now additionally uses SPM12 segmentations by default: The default gcut approach in CAT12.1 removed too much of the surrounding (extracranial) CSF, which led to a slight underestimation of TIV for atrophied brains. The skull-stripping approach based on the SPM12 segmentations prevents this through a more conservative approach. However, sometimes parts of the meninges (i.e. dura mater) or other non-brain parts remain in the GM segmentation. By combining both approaches a more reliable skull-stripping is achieved.</li>
                <li>More reliable estimation of TIV: The changed skull-stripping also affects the estimation of TIV, which is now more reliable, especially for atrophied brains.</li>
              </ul>
            </details>            

            <details>            
              <summary><u>Important new features</u></summary>
              <ul>
                <li>Automatic check for design orthogonality and sample homogeneity using SPM.mat in <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">Basic Models</a></li>
                <li>Added equi-volume model by Bok and a multi-save option for <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.stools.vol2surf');">mapping native volumes to individual surfaces.</a></li>
                <li>Added <a href="https://github.com/ThomasYeoLab/CBIG/tree/master/stable_projects/brain_parcellation/Schaefer2018_LocalGlobal">Local-Global Intrinsic Functional Connectivity parcellation</a> by Schaefer et al. for resting-state fMRI data.</li>
              </ul>
            </details>            
          
            <!-- ################################################################################# -->
            <h2 id="get_started">Getting started</h2>

            <!-- ############################# -->
            <h4 id="download">Download and installation</h4>
            
            <ul>
              <li>The CAT12 Toolbox runs within SPM12. That is, SPM12 must be installed and added to your Matlab search path before the CAT12 Toolbox can be installed (see the <a href="http://www.fil.ion.ucl.ac.uk/spm/">SPM site</a> and <a href="http://en.wikibooks.org/wiki/SPM">SPM Wiki</a> for more help).
              </li>
              <li><a href="https://neuro-jena.github.io/cat/index.html#DOWNLOAD">Download</a> and unzip the CAT12 Toolbox. You will get a folder named &quot;cat12&quot;, which contains various Matlab files and compiled scripts. Copy the folder &quot;cat12&quot; into the SPM12 &quot;toolbox&quot; folder.
              </li>
              <li>On newer MAC OS systems (10.15 or higher: Catalina, Big Sur, Monterey, Ventura) you may need to follow the <a href="https://en.wikibooks.org/wiki/SPM/Installation_on_64bit_Mac_OS_(Intel)#macOS_Catalina">SPM12 installation</a> instructions to prevent issues with MEX files.
              </li>
              <li>Older CAT12 versions can be found <a href="http://www.neuro.uni-jena.de/cat12/">here</a>.</li>
            </ul>

            <!-- ############################# -->
            <h4 id="starting">Starting the toolbox</h4>
            
            <ul>
              <li>Start Matlab</li>
              <li>Start SPM12 (i.e., type &quot;spm pet&quot;)</li>
              <li>Select &quot;cat12&quot; from the SPM menu (see <a href="#figure1">Figure 1</a>). You will find the drop-down menu between the &quot;Display&quot; and the &quot;Help&quot; button (you can also call the Toolbox directly by typing &quot;cat12&quot; on the Matlab command line). This will open the CAT12 Toolbox as an additional window (Fig. 2).</li>
            </ul>
            
            <table class="img">
              <tr>
                <td colspan="1" rowspan="1">
                <p><img id="figure1" width=70% alt="spm_gui" src="images/spm_gui.png"></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img id="figure2" width=90% alt="cat_gui" src="images/cat_gui.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <figcaption><b>Figure 1:</b> SPM12 menu</figcaption>
                </td>
                <td colspan="1" rowspan="1">
                <figcaption><b>Figure 2:</b> CAT12 Window</figcaption>
                </td>
              </tr>
            </table>
            
            <!-- ############################# -->
            <h4 id="basic_vbm">Basic VBM analysis (overview)</h4>
            
            <p>The CAT12 Toolbox comes with different modules, which may be used for analysis. Usually, a VBM analysis comprises the following steps:</p>
            <u>(a) Preprocessing:</u><br><br>
            
            <ol>
              <li>T1 images are <b>normalized</b> to a template space and <b>segmented</b> into gray matter (GM), white matter (WM), and cerebrospinal fluid (CSF). The preprocessing parameters can be adjusted via the module &quot;Segment Data&quot;.</li>
              <li>After the preprocessing is finished, a <b>quality check</b> is highly recommended. This can be achieved via the modules &quot;Display slices&quot; and &quot;Check sample&quot;. Both options are located in the CAT12 window under &quot;Check Data Quality&quot;. Furthermore, quality parameters are estimated and saved in xml-files for each data set during preprocessing. These quality parameters are also printed on the report PDF-page and can be additionally used in the module &quot;Check sample&quot;.</li>
              <li>Before entering the GM images into a statistical model, image data needs to be <b>smoothed</b>. Of note, this step is not implemented into the CAT12 Toolbox but achieved via the standard SPM module &quot;Smooth&quot;.</li>
            </ol>

            <u>(b) Statistical analysis:</u><br><br>
            <ol>
              <li>The smoothed GM images are entered into a statistical analysis. This requires building a statistical model (e.g. T-Tests, ANOVAs, multiple regressions). This is done by the standard SPM modules &quot;Specify 2nd Level&quot; or preferably &quot;Basic Models&quot; in the CAT12 window covering the same function but providing additional options and a simpler interface optimized for structural data.</li>
              <li>The statistical model is estimated. This is done with the standard SPM module &quot;Estimate&quot; (except for surface-based data where the function &quot;Estimate Surface Models&quot; should be used instead).</li>
              <li>If you have used total intracranial volume (TIV) as a confound in your model to correct for different brain sizes it is necessary to check whether TIV reveals a considerable correlation with any other parameter of interest and rather uses global scaling as an alternative approach.</li>
              <li>After estimating the statistical model, contrasts are defined to get the results of the analysis. This is done with the standard SPM module &quot;Results&quot;.</li>
            </ol>
            <p><em>The sequence of &quot;preprocessing &rarr; quality check &rarr; smoothing &rarr; statistical analysis&quot; remains the same for every VBM or SBM analysis, even when different steps are adapted (see <a href="#children">Processing of Data such as Children</a>).</em></p>
            
            <b>A few words about the Batch Editor...</b><br>
            <ul>
              <li>As soon as you select a module from the CAT12 Toolbox menu, a new window (the Batch Editor) will open. The Batch Editor is the environment where you will set up your analysis (see <a href="#figure3">Figure 3</a>). For example, an &quot;&lt;-X&quot; indicates where you need to select files (e.g. your image files, the template, etc.). Other parameters have either default settings (which can be modified) or require input (e.g. choosing between different options, providing text or numeric values, etc.).</li>
              <li>Once all missing parameters are set, a green arrow will appear on the top of the window (the current snapshots in <a href="#figure3">Figure 3</a> show the arrow still in gray). Click this arrow to run the module or select &quot;File &rarr; Run Batch&quot;. It is very useful to save the settings before you run the batch (click on the disk symbol or select &quot;File &rarr; Save Batch&quot;).
  
              <div class="box right"><sup>*</sup> Additional CAT12-related information can be found by selecting &quot;VBM Website&quot; in the CAT12 window (Tools &rarr; Internet &rarr; VBM Website). This will open a website. Here, look for &quot;VBM subpages&quot; on the right.</div></li>
            
              <li>Of note, you can always find helpful information and parameter-specific explanations at the bottom of the Batch Editor window<b><sup>*</sup></b>.
              </li>
              <li>All settings can be saved either as .mat file or as .m script file and reloaded for later use. The .m script file has the advantage of being editable with a text editor.</li>
            </ul>
            
            <br><p><img id="figure3" width=80% alt="Batch Editor" src="images/batch_gui.jpg"></p>
            <figcaption><b>Figure 3:</b> The Batch Editor is the environment where the analysis is set up. Left: For all settings marked with &quot;&lt;-X&quot;, files have to be selected (&quot;Select Files&quot;). Right: Parameters can be edited and adapted (&quot;Edit Value&quot;).</figcaption>
            
            <!-- ################################################################################# -->
            <h2 id="overview_process">Overview of CAT12 processing</h2>
            
            <!-- ############################# -->
            <h4 id="major_process">CAT12 major processing steps</h4>

            <p>As shown in <a href="#figure4">Figure 4</a>, CAT's processing workflow comprises two main steps: voxel-based processing and surface-based processing. The former is a prerequisite for the latter, but not the other way round. That is, while voxel-based processing is always required for surface-based analyses, users not interested in surface-based analyses can simply omit this second step to save processing time. The &quot;Voxel-based processing&quot; step (<a href="#figure4">Figure 4</a>, left) can be thought of as one module for tissue segmentation and another one for spatial registration. An optional third module allows for the generation of ROIs and the calculation of ROI-based measures. The &quot;Surface-based processing&quot; step (<a href="#figure4">Figure 4</a>, right) can be thought of as one module for surface creation and another one for surface registration. An optional third module allows for the generation of surfaced-based ROIs and the calculation of ROI-based measures. As shown in <a href="#figure4">Figure 4</a>, the different modules utilize different priors, templates, and atlases. Those are briefly explained in the next paragraph.</p>

            <p><u>Voxel-based processing:</u> While the final tissue segmentation in CAT is independent of tissue priors, the segmentation procedure is initialized using Tissue Probability Maps (TPMs). The standard TPMs (as provided in SPM) suffice for the vast majority of applications, and customized TPMs are only recommended for data obtained in young children. Please note that these TPMs should contain 6 classes: GM/WM/CSF and 3 background classes. For spatial registration, CAT uses Geodesic Shooting (<a href="https://doi.org/10.1016/j.neuroimage.2010.12.049">Ashburner and Friston, 2011</a>) or the older DARTEL approach (<a href="https://doi.org/10.1016/j.neuroimage.2007.07.007">Ashburner, 2007</a>) with predefined templates. Those templates are an appropriate choice for most studies and, again, sample-specific Shooting templates may only be advantageous for young children. For the voxel-based ROI analyses, CAT offers a selection of volume-based atlases in the predefined template space. Thus, any atlas-based ROI analysis requires a normalization of the individual scans to CAT's default Shooting template. On that note, the aforementioned creation and selection of a customized (rather than the predefined) DARTEL or Geodesic Shooting template will disable the third module for the voxel-based ROI analysis. </p>

            <p><u>Surface-based processing:</u> During the surface registration, the cortical surfaces of the two hemispheres are registered to the Freesurfer <a href="https://surfer.nmr.mgh.harvard.edu/fswiki/FsAverage">&quot;FsAverage&quot; template</a> (as provided with CAT). For surface-based ROI analyses, CAT provides a selection of surface-based atlases. As the surface registration module uses the Freesurfer &quot;FsAverage&quot; template, surface-based ROI analyses are not impacted by any template modification during voxel-based processing. In contrast to voxel-based ROI analyses, surface-based ROI analyses can, therefore, be applied regardless of whether the predefined or customized versions of the DARTEL or Geodesic Shooting template have been used.</p>

            <p><img id="figure4" width=80% alt="cat_processing_steps" src="images/cat_processing_steps.png"></p>
            <figcaption><b>Figure 4:</b> Overview of CAT's major processing steps.</figcaption>
            
            <!-- ############################# -->
            <h4 id="process_details">CAT12 processing steps in detail</h4>

            <p>The modules described in the previous section help understand the CAT's overall processing workflow, including its priors, templates, and atlases. Also, data processing in CAT can be separated into three main processes: (1) the initial voxel-based processing, (2) the main voxel-based processing, and (3) the surface-based processing (optional), as further detailed below and visualized in <a href="#figure5">Figure 5</a>.</p>

            <p>The <em>&quot;initial voxel-based processing&quot;</em> begins with a spatial adaptive non-local means (SANLM) denoising filter (<a href="https://doi.org/10.1002/jmri.22003">Manjon et al., 2010</a>), which is followed by internal resampling to properly accommodate low-resolution images and anisotropic spatial resolutions. The data are then bias-corrected and affine-registered (to further improve the outcomes of the following steps) followed by the standard SPM &quot;unified segmentation&quot; (<a href="https://doi.org/10.1016/j.neuroimage.2005.02.018">Ashburner and Friston, 2005</a>). The outcomes of the latter step will provide the starting estimates for the subsequent refined voxel-based processing.</p>

            <p>The <em>&quot;refined voxel-based processing&quot;</em> uses the output from the unified segmentation and proceeds with skull-stripping of the brain. The brain is then parcellated into the left and right hemisphere, subcortical areas, and the cerebellum. Furthermore, local white matter hyperintensities are detected (to be later accounted for during the spatial normalization and cortical thickness estimation). Subsequently, a local intensity transformation of all tissue classes is performed, which is particularly helpful to reduce the effects of higher gray matter intensities in the motor cortex, basal ganglia, or occipital lobe before the final adaptive maximum a posteriori (AMAP) segmentation. This final AMAP segmentation step (<a href="https://doi.org/10.1109/42.563663">Rajapakse et al., 1997</a>), which does not rely on a priori information of the tissue probabilities, is then refined by applying a partial volume estimation (<a href="https://doi.org/10.1016/j.neuroimage.2004.05.007">Tohka et al., 2004</a>), which effectively estimates the fractional content for each tissue type per voxel. As a last default step, the tissue segments are spatially normalized to a common reference space using Geodesic Shooting (<a href="https://doi.org/10.1016/j.neuroimage.2010.12.049">Ashburner and Friston, 2011</a>) registrations.</p>

            <div class="box right"><sup>*</sup> Topology defects are holes and handles that prevent the surface from being homeomorphic with a sphere.</div>

            <p>Optionally, the <em>&quot;surface-based processing&quot;</em> will be run following the completion of the voxel-based processing steps. Here, the cortical thickness estimation and reconstruction of the central surface occur in one step using a projection-based thickness (PBT) method (<a href="https://doi.org/10.1016/j.neuroimage.2012.09.050">Dahnke et al., 2013</a>). Importantly, this PBT allows the appropriate handling of partial volume information, sulcal blurring, and sulcal asymmetries without explicit sulcus reconstruction (<a href="https://doi.org/10.1016/j.neuroimage.2012.09.050">Dahnke et al., 2013</a>). After the initial surface reconstruction, topological defects<b><sup>*</sup></b> are repaired using spherical harmonics (<a href="https://doi.org/10.1002/hbm.21095">Yotter et al., 2011a</a>). The topological correction is followed by a surface refinement, which results in the final central surface mesh. This mesh provides the basis to extract folding patterns (i.e., based on the position of mesh nodes relative to each other), where the resulting local values (e.g., absolute mean curvature) are projected onto each node. Subsequently, the individual central surfaces are spatially registered to the Freesurfer &quot;FsAverage&quot; template using a spherical mapping with minimal distortions (<a href="https://doi.org/10.1016/j.neuroimage.2011.02.007">Yotter et al., 2011b</a>). In the last step, the local thickness values are transferred onto the Freesurfer &quot;FsAverage&quot; template. While this last step is performed by default during the surface-based processing, it can be repeated to also transfer measurements of cortical folding (e.g., gyrification) as well as other measurements or data (e.g., functional or quantitative MRI) to the Freesurfer &quot;FsAverage&quot; template. Note that the spatial registration of cortical measurements is combined with a spatial smoothing step in CAT to prepare the data for statistical analysis.</p>
            
            <p><img id="figure5" width=80% alt="cat_processing_pipeline" src="images/cat_processing_pipeline.png"></p>
            <figcaption><b>Figure 5:</b> Schematic flowchart of CAT's processing pipeline.</figcaption>
            
            <!-- ################################################################################# -->
            <h2 id="process_data">Preprocessing data</h2>
            
            <!-- ############################# -->
            <h5 id="module1">First Module: Segment Data</h5>

            <p>Please note that additional parameters for expert users are displayed in the GUI if you set the option cat.extopts.expertgui to &quot;1&quot; in cat_defaults.m or call cat12 by:<br>
            <code>cat12(&quot;expert&quot;)</code></p>
            <p>CAT12 &rarr; Preprocessing &rarr; Segment Data<br>

            Parameters:</p>
            
            <ul>
              <li>Volumes &lt;-X &rarr; Select Files &rarr; <em>[select the new files]</em> &rarr; Done
              <ul>
                <li>Select one volume for each subject. As the Toolbox does not support multispectral data (i.e., different imaging methods for the same brain, such as T1-, T2-, diffusion-weighted, or CT images), it is recommended to choose a T1-weighted image.</li>
                <li>Importantly, the images need to be in the same orientation as the priors; you can double-check and correct them via using &quot;Display&quot; in the SPM menu. The priors are located in your SPM folder &quot;SPM12 &rarr; tpm &rarr; TPM.nii&quot;)</li>
              </ul></li>
              <li>Split job into separate processes &rarr; <em>[use defaults or modify]</em>
              <ul>
                <li>To use multi-threading the CAT12 segmentation job with multiple subjects can be split into separate processes that run in the background. If you don't want to run processes in the background then set this value to 0.</li>
                <li>Keep in mind that each process needs about 1.5..2GB of RAM, which should be considered to choose the appropriate number of processes.</li>
              </ul></li>

              <li>Options for initial SPM12 affine registration &rarr; <em>[use defaults or modify]</em>
              <ul>
                <li>The defaults provide a solid starting point. The SPM12 tissue probability maps (TPMs) are used for the initial spatial registration and segmentation. Alternatively, customized TPMs can be chosen (e.g. for children data) that were created with the Template-O-Matic (TOM) Toolbox. Please note that these TPMs should contain 6 classes: GM/WM/CSF and 3 background classes.</li>
              </ul></li>

              <li>Extended options for CAT12 segmentation &rarr; <em>[use defaults or modify]</em>
              <ul>
                <li>Again, the defaults provide a solid starting point. Using the extended options you can adjust specific parameters or the strength of different corrections (&quot;0&quot; means no correction and &quot;0.5&quot; is the default value that works best for a large variety of data).</li>
                <li>CAT12 provides a template for the high-dimensional Shooting registration that should work for most data. However, a customized Shooting template can be selected (e.g. for children data) that was created using the Shooting toolbox. For more information on the necessary steps, see the section &quot;Customized Shooting Template&quot;.</li>
              </ul></li>

              <li>Writing options &rarr; <em>[use defaults or modify]</em>
              <ul>
                <li>For <b>GM, and WM image volumes</b> see <a href="#reg_info">information about native, normalized, and modulated volumes</a>.
                <br><u>Note:</u> The default option &quot;Modulated normalized&quot; results in an analysis of relative differences in regional GM volume that have to be corrected for individual brain size in the statistical analysis using total intracranial volume (TIV).</li>
                <li>A <b>Bias, noise, and globally intensity corrected T1 image</b>, in which MRI inhomogeneities and noise are removed and intensities are globally normalized, can be written in normalized space. This is useful for quality control and also to create an average image of all normalized T1 images to display/overlay the results.
                <br><u>Note:</u> For a basic VBM analysis use the defaults.</li>
                <li>A <b>partial volume effect (PVE) label image volume</b> can also be written in normalized or native space or as a DARTEL export file. This is useful for quality control.
                <br><u>Note:</u> For a basic VBM analysis use the defaults.</li>
                <li>The <b>Jacobian determinant</b> for each voxel can be written in normalized space. This information can be used to do a Deformation-Based Morphometry (DBM) analysis. 
                <br><u>Note:</u> For a basic VBM analysis this is not needed.</li>
                <li>Finally, <b>deformation fields</b> can be written. This option is useful to re-apply normalization parameters to other co-registered images (e.g. fMRI or DTI data).
                <br><u>Note:</u> For a basic VBM analysis this is not needed.</li>
              </ul></li>
            </ul><br>

            <p>The resulting files are saved in the respective subfolders and are following the CAT12 <a href="#naming">naming convention</a>.</p>

            <p><b>Note:</b> If the segmentation fails, this is often due to an unsuccessful initial spatial registration. In this case, you can try to set the origin (anterior commissure) in the Display tool. Place the cursor roughly on the anterior commissure and press &quot;Set Origin&quot; The now displayed correction in the coordinates can be applied to the image with the button &quot;Reorient&quot;. This procedure must be repeated for each data set individually.</p>
            
            <!-- ############################# -->
            <h5 id="module2">Second Module: Display Slices (optionally)</h5>

            <p>CAT12 &rarr; Data Quality &rarr; Single Slice Display<br>

            Parameters:</p>

            <ul>
              <li>Sample data &lt;-X &rarr; Select Files &rarr; <em>[select the new files]</em> &rarr; Done
              <ul>
                <li>Select the newly written data [e.g. the &quot;wm*&quot; files, which are the normalized bias-corrected volumes for VBM or the resampled and smoothed surfaces for SBM]. This tool will display one horizontal slice for each subject, thus giving a good overview of whether the segmentation and normalization procedures yielded reasonable results. For example, if the native volume had artifacts or if the native volumes had a wrong orientation, the results may look odd. Solutions: Use &quot;Check Reg&quot; from the SPM main menu to make sure that the native images have the same orientation as the MNI Template (&quot;SPM &rarr; templates &rarr; T1&quot;). Adjust if necessary using &quot;Display&quot; from the SPM main menu.</li>
              </ul></li>
              <li>Proportional scaling &rarr; <em>[use defaults or modify]</em>
              <ul>
                <li>Check &quot;yes&quot;, if you display T1 volumes.</li>
              </ul></li>
              <li>Spatial orientation</li>
              <li>Show slice in mm &rarr; <em>[use defaults or modify]</em>
              <ul>
                <li>This module displays horizontal slices. This default setting provides a good overview.</li>
              </ul></li>
            </ul>
            
            <!-- ############################# -->
            <h5 id="module3">Third Module: Estimate Total Intracranial Volume (TIV)</h5>

            <p>CAT12 &rarr; Statistical Analysis &rarr; Estimate TIV<br>

            Parameters:</p>

            <ul>
              <li>XML files &lt;-X &rarr; Select Files &rarr; <em>[select xml-files]</em> &rarr; Done
              <ul>
                <li>Select the xml-files in the report-folder [e.g. the &quot;cat_*.xml&quot;].</li>
              </ul></li>
              <li>Save values &rarr; TIV only
              <ul>
                <li>This option will save the TIV values for each data set in the same order as the selected xml-files. Optionally you can also save the global values for each tissue class, which might be interesting for further analysis, but is not recommended if you are interested in only using TIV as a covariate.</li>
              </ul></li>
              <li>Output file &rarr; <em>[use defaults or modify]</em></li>
            </ul>

            <p><b>Please note that TIV is strongly recommended as a covariate for all VBM analyses to correct different brain sizes. This step is not necessary for deformation- or surface-based data. Please also make sure that TIV does not correlate too much with your parameters of interest (please make sure that you use &quot;Centering&quot; with &quot;Overall mean&quot;, otherwise the check for orthogonality in SPM sometimes does not work correctly). In this case, you should use global scaling with TIV.</b></p>
            
            <!-- ############################# -->
            <h5 id="module4">Fourth Module: Check Sample Homogeneity</h5>

            <p>CAT12 &rarr; Data Quality &rarr; Check Sample Homogeneity<br>

            Parameters:<br>

            <ul>
              <li>Data &rarr; New: Sample data &lt;-X &rarr; Select Files &rarr; <em>[select gray matter volumes]</em> &rarr; Done
              <ul>
                <li>Select the newly written data [e.g. the &quot;mwp1*&quot; files, which are the modulated (m) normalized (w) GM segments (p1)]. It is recommended to use the unsmoothed segmentations that provide more anatomical details. This tool visualizes the correlation between the volumes using a boxplot and correlation matrices. Thus, it will help to identify outliers. Any outlier should be carefully inspected for artifacts or pre-processing errors using &quot;Check worst data&quot; in the GUI. If you specify different samples the mean correlation is displayed in separate boxplots for each sample.</li>
              </ul></li>
              <li>Load quality measures (leave empty for autom. search) &rarr; <em>[optionally select xml-files with quality measures]</em>
              <ul>
                <li>Optionally select the xml-files that are saved for each data set. These files contain useful information about some estimated quality measures that can be also used for checking sample homogeneity. Please note, that the order of the xml-files must be the same as the other data files. Leave empty for automatically searching for these xml-files.</li>
              </ul></li>
              <li>Global scaling with TIV <em>[use defaults or modify]</em>
              <ul>
                <li>This option is to correct mean Z-scores for TIV by global scaling. It is only meaningful for VBM data.</li>
              </ul></li>
              <li>Nuisance &rarr; <em>[enter nuisance variables if applicable]</em>
              <ul>
                <li>For each nuisance variable which you want to remove from the data before calculating the correlation, select &quot;New: Nuisance&quot; and enter a vector with the respective variable for each subject (e.g. age in years). All variables have to be entered in the same order as the respective volumes. You can also type &quot;spm_load&quot; to upload a *txt file with the covariates in the same order as the volumes. A potential nuisance parameter can be TIV if you check segmented data with the default modulation.</li>
              </ul></li>
            </ul>

            <br><p>A window opens with a plot in which the mean Z-scores for all volumes is displayed. High mean Z-scores values mean that your data are more similar to each other. If you click in the plot, the corresponding data is displayed in the lower right corner and allow a closer look. The slider below the image changes the displayed slice. The pop-up menus in the top right-hand corner provide more options. Here you can select other measures that are displayed in the boxplot (e.g. optional quality measures such as noise, bias, weighted overall image quality if these values were loaded). Finally, most deviating data can be displayed in the SPM graphics window to check the data more closely. For surfaces, two additional measures are available (if you have loaded the xml-files ) to utilize the quality check of the surface extraction. The Euler number gives you an idea about the number of topology defects, while the defect size indicates how many vertices of the surface are affected by topology defects. Because topology defects are mainly caused by noise and other image artifacts (e.g. motion) this gives you an impression about the potential quality of your extracted surface.</p>

            <p>The boxplot in the SPM graphics window displays the mean Z-score values for each subject and indicates the homogeneity of your sample. A small mean Z-score in the boxplot does not always mean that this volume is an outlier or contains an artifact. If there are no artifacts in the image and if the image quality is reasonable you don't have to exclude this volume from the sample. This tool is intended to utilize the process of quality checking and there are no clear criteria defined to exclude a volume only based on the mean Z-score value. However, volumes with a noticeable lower mean Z-score (e.g. below two standard deviations) are indicated and should be checked more carefully. The same holds for all other measures. Data with deviating values have not necessarily to be excluded from the sample, but these data should be checked more carefully with the &quot;Check most deviating data&quot; option. The order of the most deviating data is changed for every measure separately. Thus, the check for the most deviating data will give you a different order for mean correlation and other measures which allows you to judge your data quality using different features.</p>

            <p>If you have loaded quality measures, you can also display the ratio between weighted overall image quality (IQR) and mean Z-score. These two are the most important measures for assessing image quality. Mean Z-score measures the homogeneity of your data used for statistical analysis and is therefore a measure of image quality <b>after</b> pre-processing. Data that deviate from your sample increase variance and therefore minimize effect size and statistical power. The weighted overall image quality, on the other hand, combines measurements of noise and spatial resolution of the images <b>before</b> pre-processing. Although CAT12 uses effective noise-reduction approaches (e.g. spatial adaptive non-local means filter) pre-processed images are also affected and should be checked.</p>

            <p>The product between IQR and mean Z-scores makes it possible to combine these two measures of image quality before and after pre-processing. A low ratio indicates good quality before and after preprocessing and means that IQR is highly rated (resulting in a low nominal number/grade) and/or mean Z-score is high. Both measures contribute to the ratio and are normalized before by their standard deviation. In the respective plot, the product value is colour-coded and each point can be selected to get the filename and display the selected slice to check data more closely.</p>
            
            <!-- ############################# -->
            <h5 id="module5">Fifth Module: Smooth</h5>

            <p>SPM menu &rarr; Smooth<br>

            Parameters:</p>

            <ul>
              <li>Images to Smooth &lt;-X &rarr; Select Files &rarr; <em>[select grey matter volumes]</em> &rarr; Done
              <ul>
                <li>Select the newly written data [e.g. the &quot;mwp1&quot; files, which are the modulated (m) normalized (w) grey matter segments (p1)].</li>
              </ul></li>
              <li>FWHM &rarr; <em>[use defaults or modify]</em>
              <ul>
                <li>6-8mm kernels are widely used for VBM. To use this setting select &quot;edit value&quot; and type &quot;6 6 6&quot; for a kernel with 6mm FWHM.</li>
              </ul></li>
              <li>Data Type &rarr; <em>[use defaults or modify]</em></li>
              <li>Filename Prefix &rarr; <em>[use defaults or modify]</em></li>
            </ul>
            
            <!-- ###################################### -->
            <h2 id="build_stats">Building the statistical model</h2>

            <p>Starting with CAT12.8, a new batch mode is used to create statistical models. Now, only cross-sectional and longitudinal data are distinguished and only factorial designs and a few other necessary models are offered, but covering all possible designs. The advantage of this new batch is that it provides tailored options for VBM and many of the rather confusing and unnecessary options in &quot;Basic Models&quot; or &quot;Specify 2nd-level&quot; have now been removed and some VBM-specific options such as correction for TIV are newly provided. This should make it easier to build the statistical model in CAT12. However, the &quot;Full factorial&quot; design now used for cross-sectional data is a bit more complicated to use. However, you are free to use the old statistical batch from the SPM12 GUI (&quot;Basic Models&quot; or &quot;Specify 2nd-level&quot;) as an alternative.</p>
            <p>Here are some hints on how to relate the old models to the new factorial design. For cross-sectional VBM data, you usually have 1..n samples (which corresponds to factor levels) and optionally covariates and nuisance parameters:</p>
            
            <table>
              <tr style="font-weight: 600;">
                <td colspan="1" rowspan="1" width="25%;">
                <p>Number of factor levels</p>
                </td>
                <td colspan="1" rowspan="1" width="20%;">
                <p>Number of covariates</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>Statistical Model</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p> 1</p>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>one-sample t-test</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p> 1</p>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>single regression</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p> 1</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>&gt;1</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>multiple regression</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p> 2</p>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>two-sample t-test</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>&gt;2</p>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>Anova</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>&gt;1</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>&gt;0</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>AnCova (for nuisance parameters) or Interaction (for covariates)</p>
                </td>
              </tr>
            </table>
            
            <!-- ############################# -->
            <h4 id="stat_options">General notes and options for statistical models</h4>
            
            <b>Please note that when using <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">"Basic Models"</a> in the CAT12 GUI, some unnecessary options have been removed compared to the "Basic Models" in SPM12, and some useful options have been added. We therefore strongly recommend preferring to use the models in CAT12, which offer some advantages especially when defining longitudinal designs.</b><br><br>
            
            <u>Covariates</u><br>
            This option allows for the specification of covariates and nuisance variables. TIV correction should be rather defined in &quot;Correction of TIV&quot;.<br>
            Note that SPM does not make any distinction between effects of interest (including covariates) and nuisance effects. Covariates and nuisance parameters are handled in the same way in the GLM and differ only in the contrast used.
            <ul>
              <li>Covariates &rarr; New Covariate</li>
              <li>Vector &lt;-X  enter the values of the covariates (e.g. age in years) in the same order as the respective file names or type spm_load to upload a *.txt file with the covariates in the same order as the volumes</li>
              <li>Name &lt;-X  Specify Text (e.g. age)</li>
              <li>Interactions &rarr; None (or optionally "With Factor 1" to account for differences between the groups)</li>
              <li>Centering &rarr; Overall mean</li>
            </ul>
            
            <u>Masking</u>
            <p>Absolute masking is recommended for GM or WM volume data to ensure that you dont analyze regions that dont contain enough GM or WM or regions outside the brain. The default value of 0.1 is a good starting point for VBM data to ensure that only the intended tissue map is analyzed. You can gradually increase this value up to &quot;0.2&quot; but you must make sure that your effects are not cut off.<br>
            If you analyze surface data, no additional masking is necessary.
            </p>

            <u>Correction of TIV</u><br>
            For modulated VBM data, it is strongly recommended to always correct for TIV to account for different brain sizes. There are three options for TIV correction available:<br><br>
            <ol>
              <li><em>ANCOVA</em>: Here, any variance that can be explained by TIV is removed from your data (i.e. in every voxel or vertex). This is the preferred option when there is no correlation between TIV and your parameter of interest. For example, a parameter of interest may be a variable in a multiple regression design that you want to relate to your structural data. If TIV is correlated with this parameter, not only will the variance explained by TIV be removed from your data, but also parts of the variance of your parameter of interest, which should be avoided.<br>
              Note that for two-sample T-tests and Anova with more than 2 groups, an interaction is modeled between TIV and group that prevents any group differences from being removed from your data, even if TIV differs between your groups.<br>
              Use the <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.chec_SPM');">Check Design Orthogonality</a> option to test for any correlations between your parameters.</li>
              <li><em>Global scaling</em>: If TIV correlates with your parameter of interest, you should rather use global scaling with TIV. The easiest way to define global scaling is to use <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">"Basic Models"</a> in the CAT12 GUI. If you prefer "Basic Models" in SPM12, see <a href="#ortho">here</a> for a detailed description how to define global scaling.</li>
              <li><em>No</em>: Use this option to disable TIV correction for deformation- or surface-based data where TIV correction is not necessary.</li>
            </ol>

            <u>Check design orthogonality and homogeneity</u><br>
            In order to identify images with poor image quality or even artefacts you can use <a href="#module4">Check Sample Homogeneity</a>. The idea of this option is to check the Z-score of all files across the sample using the files that are already defined in SPM.mat.<br>
  
            <p>The Z-score is calculated for all images and the mean for each image is plotted using a boxplot (or violin plot) and the indicated filenames. The larger the mean (absolute) Z-score the more deviant is this image from the sample mean. In the plot outliers from the sample are usually isolated from the majority of images which are clustered around the sample mean. The mean Z-score is plotted at the y-axis and the x-axis reflects the image order.<br>
            The advantage of rechecking sample homogeneity at this point is that the given statistical model (design) is used and potential nuisance parameters are taken into account. If you have longitudinal data, the time points of each data set are linked in the graph to indicate intra-subject data. Unsmoothed data (if available and in the same folder) are automatically detected and used. Finally, report files are used if present (i.e., if data has not been moved or the folders renamed) and quality parameters are loaded and displayed.<br>
            If you have modeled TIV as a nuisance parameter, you must check whether TIV is orthogonal (in other words independent) to any other parameter of interest in your analysis (e.g. parameters you are testing for) using <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.chec_SPM');">Check Design Orthogonality</a>. See <a href="#ortho">here</a> for a detailed description.<p>

            <u>Voxel-wise covariate (experimental!)</u><br>
            This experimental option allows the specification of a voxel-wise covariate. If you have more than one modality (i.e., functional and structural data), this can be used (depending on the contrast you define) to:
            <ol>
              <li>Remove the confounding effect of structural data (e.g. GM) on functional data or</li>
              <li>Investigate the relationship (regression) between functional and structural data.</li>
            </ol>
            <p>In addition, an interaction can be modeled to examine whether the regression between functional and structural data differs between two groups.<br>
            Please note that the saved vSPM.mat file can only be analyzed with the TFCE toolbox r221 or newer.</p>

            <u>Visualization of results</u><br>
            There exist different options to call results after statistical analysis:<br><br>
            <ol>
              <li>General function to <a class="function" href="matlab:[hReg xSPM SPM] = cat_spm_results_ui('Setup');">call results</a></li>
              <li><a class="function" href="matlab:cat_vol_slice_overlay;">Slice Overlay</a> to display volume results (i.e. VBM)</li>
              <li><a class="function" href="matlab:y=cat_surf_results;">Surface Overlay</a> that allows to overlay results from surfaces or volumes</li>
            </ol>
            Please note that options 2 an 3 require that the results are already thresholded (e.g. using <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.T2x');">Transform and Threshold SPM-maps</a>) or were analyzed with the <a class="function" href="matlab:if exist('spm_TFCE'),spm_jobman('interactive','','spm.tools.tfce_estimate'), else cat_install_tfce, end;">TFCE</a> toolbox (preferred approach).

            <!-- ############################# -->
            <h5 id="two_sample">Two-sample T-Test</h5>
                        
            <p>CAT12 &rarr; Basic Models<br>
            Parameters:<br>
            
            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Two-sample t-test&quot;
              <ul>
                <li>Group 1 scans &rarr; Select Files &rarr; <em>[select the smoothed grey matter data for group 1; following this script these are the &quot;smwp1&quot; files]</em> &rarr; Done</li>
                <li>Group 2 scans &rarr; Select Files &rarr; <em>[select the smoothed grey matter data for group 2]</em> &rarr; Done</li>
                <li>Independence &rarr; Yes</li>
                <li>Variance &rarr; Equal or Unequal</li>
              </ul></li>
              <li>Covariates</li>              
              <li>Masking
              <ul>
                <li>Threshold masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
                <li>Implicit Mask &rarr; Yes</li>
                <li>Explicit Mask &rarr; &lt;None&gt;</li>
              </ul></li>
              <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
              <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>

            <!-- ############################# -->
            <h5 id="full_fact">Full factorial model (for a 2x2 Anova)</h5>

            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Any cross-sectional data (Full factorial)&quot;
              <ul>
                <li>Factors &rarr; &quot;New: Factor; New: Factor&quot;<br>
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;sex&quot;)]</em></li>
                  <li>Levels &rarr; 2</li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal or Unequal</li>
                </ul>
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;age&quot;)]</em></li>
                  <li>Levels &rarr; 2</li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal or Unequal</li>
              </ul></ul>
              <ul>
                <li>Specify Cells &rarr; &quot;New: Cell; New: Cell; New: Cell; New: Cell&quot;<br>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;1 1&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the young males)]</em></li>
                </ul>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;1 2&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the old males)]</em></li>
                </ul>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;2 1&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the young females)]</em></li>
                </ul>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;2 2&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the old females)]</em></li>
                </ul>
              </ul></li>
            </ul>
            <ul>
              <li>Covariates* (see the text box in example for two-sample T-test)</li>
              <li>Masking
              <ul>
                <li>Threshold Masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
                <li>Implicit Mask &rarr; Yes</li>
                <li>Explicit Mask &rarr; &lt;None&gt;</li>
              </ul>
              <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
              <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>

            
            <!-- ############################# -->
            <h5 id="mult_regress">Multiple regression (linear)</h5>

            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Multiple Regression&quot;
              <ul>
                <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of all subjects)]</em> &rarr; Done</li>
                <li>Covariates &rarr; &quot;New: Covariate&quot;
                <ul>
                  <li>Vector &rarr; <em>[enter the values in the same order as the respective file names of the smoothed images]</em></li>
                  <li>Name &rarr; <em>[specify (e.g. &quot;age&quot;)]</em></li>
                  <li>Centering &rarr; Overall mean</li>
                </ul></li>
                <li>Intercept &rarr; Include Intercept</li>
              </ul></li>
              <li>Covariates</li>              
              <li>Masking
              <ul>
                <li>Threshold masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
                <li>Implicit Mask &rarr; Yes</li>
                <li>Explicit Mask &rarr; &lt;None&gt;</li>
              </ul></li>
              <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
              <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>
            
            <!-- ############################# -->
            <h5 id="mult_regress_poly">Multiple regression (polynomial)</h5>

            <p>To use a polynomial model, you need to estimate the polynomial function of your parameter before analyzing it. To do this, use the function cat_stat_polynomial (included with CAT12 &gt;r1140):<br>
            <code>y = cat_stat_polynomial(x,order)</code></p>
            <p>where &quot;x&quot; is your parameter and &quot;order&quot; is the polynomial order (e.g. 2 for quadratic).</p>
            <p><u>Example for polynomial order 2 (quadratic)</u></p>
            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>
            
            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Multiple Regression&quot;
              <ul>
                <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of all subjects)]</em> &rarr; Done</li>
                <li>Covariates &rarr; &quot;New: Covariate&quot;
                <ul>
                  <li>Vector &rarr; <em>[specify linear term (e.g. &quot;y(:,1)&quot;)]</em></li>
                  <li>Name &rarr; <em>[specify (e.g. &quot;age-linear&quot;)]</em></li>
                  <li>Centering &rarr; Overall mean</li>
                </ul>
                <li>Covariates &rarr; &quot;New: Covariate&quot;
                <ul>
                  <li>Vector &rarr; <em>[specify quadratic term (e.g. &quot;y(:,2)&quot;)]</em></li>
                  <li>Name &rarr; <em>[specify (e.g. &quot;age-quadratic&quot;)]</em></li>
                  <li>Centering &rarr; Overall mean</li>
                </ul></li>
                <li>Intercept &rarr; Include Intercept</li>
              </ul></li>
              <li>Covariates</li>              
              <li>Masking
              <ul>
                <li>Threshold masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
                <li>Implicit Mask &rarr; Yes</li>
                <li>Explicit Mask &rarr; &lt;None&gt;</li>
              </ul></li>
              <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
              <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>
                        
            <!-- ############################# -->
            <h5 id="full_fact_interact">Full factorial model (interaction)</h5>

            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Any cross-sectional data (Full factorial)&quot;
              <ul>
                <li>Factors &rarr; &quot;New: Factor&quot;<br>
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;sex&quot;)]</em></li>
                  <li>Levels &rarr; 2</li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal or Unequal</li>
                </ul>
              </li>
                <li>Specify Cells &rarr; &quot;New: Cell; New: Cell&quot;<br>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;1&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the males)]</em></li>
                </ul>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;2&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the females)]</em></li>
                </ul>
              </ul>
            </li>
            <li>Covariates &rarr; &quot;New: Covariate&quot;
            <ul>
              <li>Covariate
              <ul>
                <li>Vector &rarr; <em>[enter the values in the same order as the respective file names of the smoothed images]</em></li>
                <li>Name &rarr; <em>[specify (e.g. &quot;age&quot;)]</em></li>
                <li>Interactions &rarr; With Factor 1</li>
                <li>Centering &rarr; Overall mean</li>
              </ul></li>
            </ul></li>
            <li>Masking
            <ul>
              <li>Threshold Masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
              <li>Implicit Mask &rarr; Yes</li>
              <li>Explicit Mask &rarr; &lt;None&gt;</li>
            </ul>
            <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
            <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>
            
            <!-- ############################# -->
            <h5 id="full_fact_poly">Full factorial model (polynomial interaction)</h5>

            <p>To use a polynomial model you have to estimate the polynomial function of your parameter prior to the analysis. Use the function cat_stat_polynomial (provided with CAT12 &gt;r1140) for that purpose:<br>
            <code>y = cat_stat_polynomial(x,order)</code></p>
            <p>where &quot;x&quot; is your parameter and &quot;order&quot; is the polynomial order (e.g. 2 for quadratic).</p>
            <p><u>Example for polynomial order 2 (quadratic)</u></p>
            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Any cross-sectional data (Full factorial)&quot;
              <ul>
                <li>Factors &rarr; &quot;New: Factor&quot;<br>
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;sex&quot;)]</em></li>
                  <li>Levels &rarr; 2</li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal or Unequal</li>
                </ul>
              </li>
                <li>Specify Cells &rarr; &quot;New: Cell; New: Cell&quot;<br>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;1&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the males)]</em></li>
                </ul>
                Cell
                <ul>
                  <li>Levels &rarr; <em>[specify text (e.g. &quot;2&quot;)]</em></li>
                  <li>Scans &rarr; <em>[select files (e.g. the smoothed GM data of the females)]</em></li>
                </ul>
              </ul>
            </li>
            <li>Covariates &rarr; &quot;New: Covariate; New: Covariate&quot;
            <ul>
              <li>Covariate
              <ul>
                <li>Vector &rarr; <em>[specify linear term (e.g. &quot;y(:,1)&quot;)]</em></li>
                <li>Name &rarr; <em>[specify (e.g. &quot;age-linear&quot;)]</em></li>
                <li>Interactions &rarr; With Factor 1</li>
                <li>Centering &rarr; Overall mean</li>
              </ul></li>
              <li>Covariate
              <ul>
                <li>Vector &rarr; <em>[specify quadratic term (e.g. &quot;y(:,2)&quot;)]</em></li>
                <li>Name &rarr; <em>[specify (e.g. &quot;age-quadratic&quot;)]</em></li>
                <li>Interactions &rarr; With Factor 1</li>
                <li>Centering &rarr; Overall mean</li>
              </ul></li>
            </ul></li>
            <li>Masking
            <ul>
              <li>Threshold Masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
              <li>Implicit Mask &rarr; Yes</li>
              <li>Explicit Mask &rarr; &lt;None&gt;</li>
            </ul>
            <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
            <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>
            
            <!-- ############################# -->
            <h5 id="estimate">Estimating the statistical model</h5>

            <p>CAT12 &rarr; Estimate (Surface) Models</p>

            <p>Select SPM.mat which you just built.</p>
            Note that for surface data you should rather use this estimation option instead of &quot;Estimate&quot; in the SPM12 GUI, otherwise the underlying surface after calling the results will be mistakenly be the surface of the first selected data set instead of the average surface.
                        
            <!-- ############################# -->
            <h5 id="ortho">Checking for design orthogonality</h5>

            <p>If you have modeled TIV as a nuisance parameter, you must check whether TIV is orthogonal (in other words independent) to any other parameter of interest in your analysis (e.g. parameters you are testing for). This means that TIV should not correlate with any other parameter of interest, otherwise not only the variance explained by TIV is removed from your data, but also parts of the variance of your parameter of interest.</p>
            <p>Please use &quot;Overall mean&quot; as &quot;Centering&quot; for the TIV covariate. Otherwise, the orthogonality check sometimes even indicates a meaningful co-linearity only because of scaling issues.</p>
            <p>To check the design orthogonality, you can either use the respective option in the statistical models or the &quot;Review&quot; function in the SPM12 GUI:</p>
            <p>SPM menu &rarr; Review</p>
            
            <ul>
              <li>Select SPM.mat &lt;-X &rarr; Select Files &rarr; <em>[select the SPM.mat which you just built]</em> &rarr; Done</li>
              <li>Design &rarr; Design orthogonality</li>
            </ul>

            <table class="img">
              <tr>
                <td colspan="1" rowspan="1">
                <p><img id="figure6" width=60% alt="non_orthogonal" src="images/ortho.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <figcaption><b>Figure 6:</b> Gray boxes between the parameters point to a co-linearity (correlation): the darker the box the larger the correlation (which also holds for inverse correlations). If you click in the box the co-linearity between the parameters is displayed.</figcaption>
                </td>
              </tr>
            </table>

            <p>The larger the correlation between TIV and any parameter of interest, the more cautious one must be when using TIV as a nuisance parameter. In this case an alternative approach is to use global scaling with TIV. If you use &quot;Basic Models&quot; in the SPM12 GUI, the following settings for this approach can be used (otherwise the global scaling option in the CAT12 function prepares that for you):</p>
            <ul>
              <li>Global Calculation &rarr; User &rarr; Global Values &lt;-X &rarr; Define the TIV values here</li>
              <li>Global Normalisation &rarr; Overall grand mean scaling &rarr; Yes &rarr; Grand mean scaled value &rarr; Define here the mean TIV of your sample (or as approximation a value of 1500 which might fit for the majority of data from adults)</li>
              <li>Normalisation &rarr; Proportional</li>
            </ul>

            <p>This approach is (proportionally) scaling the data according to the individual TIV values. Instead of removing variance explained by TIV all data are scaled by their TIV values. This is also similar to the approach that was used in VBM8 (&quot;modulate for non-linear effects only&quot;), where global scaling was internally used with an approximation of TIV (e.g. inverse of affine scaling factor).</p>

            <p>Please note that global normalization also affects the absolute masking threshold as your images are now scaled to the &quot;Grand mean scaled value&quot; of the Global Normalization option. If you have defined the mean TIV of your sample (or an approximate value of 1500) here, no change of the absolute threshold is required. Otherwise, you will have to correct the absolute threshold because your values are now globally scaled to the &quot;Grand mean scaled value&quot; of the Global Normalization option.</p>

            <p>An alternative approach for all models with more than one group should not be unmentioned. This is to use TIV as a nuisance parameter with interaction and mean centering with the factor &quot;group&quot;. This interaction is automatically taken into account when you use the TIV ANCOVA correction in CAT12 &quot;Basic Models&quot;. That approach will result in separate columns of TIV for each group. The values for the nuisance parameters are here mean-centered for each group. As the mean values for TIV are corrected separately for each group, it is prevented that group differences in TIV have a negative impact on the group comparison of the image data in the GLM. Variance explained by TIV is here removed separately for each group without affecting the differences between the groups.</p>

            <p>Unfortunately, no clear advice for either of these two approaches can be given and the use of these approaches will also affect the interpretation of your findings.</p>
            
            <!-- ############################# -->
            <h5 id="contrasts">Defining contrasts</h5>

            <p>SPM menu &rarr; Results &rarr; <em>[select the SPM.mat file]</em> &rarr; Done (this opens the Contrast Manager) &rarr; Define new contrast (i.e., choose &quot;t-contrast&quot; or &quot;F-contrast&quot;; type the contrast name and specify the contrast by typing the respective numbers, as shown below).</p>

            <p>You can also use the SPM Batch Editor to automate that procedure:</p>

            <p>SPM Batch Editor &rarr; SPM &rarr; Stats &rarr; Contrast Manager</p>

            <p>Please note that all zeros at the end of the contrast don't have to be defined, but are sometimes remained for didactic reasons.</p>

            <table class="img">
              
              <tr>
                <td colspan="1" rowspan="1">
                <p><b>Two-sample T-test</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=15% alt="model_2sample" src="images/model_2sample.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Group A &gt; Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Group A &lt; Group B </li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>-1 1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any differences between Group A and B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>eye(2)-1/2</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Effects of interest (for plotting)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 1 0<br>
                1 0 0</p>
                </td>
              </tr>

              <tr>
                <td colspan="1" rowspan="1">
                <p><b>2x2 ANOVA</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=20% alt="Anova2x2" src="images/model_anova2x2.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For young males &gt; old males</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1 0 0 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For young females &gt; old females</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0 0 1 -1 0</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For young males &gt; young females</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 0 -1 0 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For old males &gt; old females</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0 1 0 -1 0</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For males &gt; females (main effect sex)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 1 -1 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For young &gt; old (main effect age)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1 1 -1 0</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For young &gt; old & males &gt; females</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1 -1 1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For young &gt; old & males &lt; females</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>-1 1 1 -1 0</p>
                </td>
              </tr>              
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect age in males</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1 0 0 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect age in females</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0 0 1 -1 0</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect sex in young subjects</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 0 -1 0 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect sex in old subjects</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0 1 0 -1 0</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect sex</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 1 -1 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect age</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1 1 -1 0</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For interaction sex by age</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1 -1 1 0</p>
                </td>
              </tr>              
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Any difference between the 4 groups</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>eye(4)-1/4</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Effects of interest (for plotting)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>eye(4)</p>
                <br>
                </td>
              </tr>

              <tr>
                <td colspan="1" rowspan="1">
                <p><b>Multiple Regression (Linear)</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=15% alt="model_2sample" src="images/model_mult_reg2.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For positive regression slope (correlation)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For negative regression slope (correlation)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 -1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Any regression slope (effects of interest)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1</p>
                </td>
              </tr>
              <tr>
                <td colspan="2">
                <p><em>The two leading zeros in contrast indicate the constant (sample effect, 1st column in the design matrix) and TIV (2nd column in the design matrix). If no additional covariate such as TIV is defined you must skip one of the leading zeros (e.g. &quot;0 1&quot; and &quot;0 -1&quot;).</em></p>
                </td>
              </tr>
            
              <tr>
                <td colspan="1" rowspan="1">
                <p><b>Multiple Regression (Polynomial)</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=20% alt="regression2" src="images/model_mult_reg.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For positive linear effect </li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0 0 1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For positive quadratic effect</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 0 1</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For negative linear effect</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For negative quadratic effect</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 0 -1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any linear effect</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any quadratic effect</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 0 1</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any linear or quadratic effect (effects of interest)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>[zeros(2,2) eye(2)]</p>
                </td>
              </tr>
              <tr>
                <td colspan="2">
                <p><em>The two leading zeros in the contrast indicate the constant (sample effect, 1st column in the design matrix) and TIV (2nd column in the design matrix). If no additional covariate such as TIV is defined you must skip one of the leading zeros (e.g. &quot;0 1&quot;).</em></p>
                </td>
              </tr>            

              <tr>
                <td colspan="1" rowspan="1">
                <p><b>Interaction (Linear)</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=20% alt="interaction2x2" src="images/model_interact.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For regression slope Group A &gt; Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0 0 1 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For regression slope Group A &lt; Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 0 0 -1 1 0</p>
                </td>
              </tr>

              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any difference in regression slope</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Effects of interest (for plotting)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>[zeros(2,2) eye(2)]</p>
                </td>
              </tr>
              <tr>
                <td colspan="2">
                <p><em>The two leading zeros in the contrast indicate the main effect &quot;group&quot; and should be always set to &quot;0&quot; in the contrast, because we are rather interested in the interaction.</em></p>
                </td>
              </tr>
            
              <tr>
                <td colspan="1" rowspan="1">
                <p><b>Interaction (Polynomial)</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=25% alt="interaction_squared" src="images/model_interact_poly.png"></p>
                
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For linear regression slope Group A &gt; Group B </li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 -1 0 0 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For linear regression slope Group A &lt; Group B </li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 -1 1 0 0 0</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For quadratic regression Group A &gt; Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 0 0 1 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For quadratic regression Group A &lt; Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 0 0 -1 1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any difference in linear regression slope</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 -1 0 0 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any difference in quadratic regression</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 0 0 1 -1 0</p>
                </td>
              </tr>
              
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any difference in regression</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 -1 0 0 0<br>
                0 0 0 0 1 -1 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Effects of interest (for plotting)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>[zeros(4,2) eye(4)]</p>
                </td>
              </tr>
              
            </table>
            
            <p>The two leading zeros in the contrast indicate the main effect &quot;group&quot; and should be always set to &quot;0&quot; in the contrast, because we are rather interested in the interaction.</p>
            <p><u>Defining F-contrasts</u></p>
            <p>For Anovas (e.g. comparison between groups) the test for any difference between the groups can be defined with:<br>
            <code>eye(n)-1/n</code></p>
            <p>where n is the number of columns of interest.</p>
            <p>For interaction effects (e.g. any interaction between covariate and group) you need to add leading zeros to leave out the group effects:<br>
            <code>[zeros(n,m) eye(n)-1/n]</code></p>
            <p>where m is the number of group effects.</p>
            <p>For a regression design (e.g. any regression slope) you are not interested in differential effects as described above, but rather in any effect of a regression parameter:<br>
            <code>[zeros(n,m) eye(n)]</code></p>
            <p>where n is the number of columns of interest (e.g. regression parameters) and m is the number of leading columns you need to exclude (i.e. effects of no interest such as the constant or any other covariates of no interest).</p>
            <p>In order to plot any contrast estimate or fitted response, however, you have to define the effects of interest by using:<br>
            <code>[zeros(n,m) eye(n)]</code></p>
            <p>where n is the number of columns of interest and m is the number of leading columns you need to exclude (i.e. effects of no interest such as the constant or any other covariates of no interest).</p>
            <p><em>This F-contrast (effects of interest) is necessary to correctly plot contrast estimates or fitted responses. Thus, it's recommended to always define this contrast.</em></p>
            
            <p><u>Getting Results</u></p>
            <div class="box right"><sup>*</sup> To determine the extent threshold empirically (instead of saying 100 voxels or 500 voxels, which is completely arbitrary), simply execute it first without specifying an extent threshold. This gives you an output (i.e., the standard SPM glass brain with significant effects). If you click on &quot;Table&quot; (SPM main menu) you will get a table with all relevant values (MNI coordinates, p-values, cluster size etc.). Below the table you will find additional information, such as &quot;Expected Number of Voxels per Cluster&quot;. Remember this number (this is your empirically determined extent threshold). Re-run SPM &rarr; Results etc. and enter this number when prompted for the &quot;Extent Threshold&quot;. There is also a hidden option in &quot;CAT12 &rarr; Data presentation &rarr; Threshold and transform spmT-maps&quot; to define the extent threshold as p-value or to use the &quot;Expected Number of Voxels per Cluster&quot;.</div>
            
            <p>SPM menu &rarr; Results &rarr; <em>[select a contrast from Contrast Manager]</em> &rarr; Done</p>

            <ul>
              <li>Mask with other contrasts &rarr; No</li>
              <li>Title for comparison: [use the pre-defined name from the Contrast Manager or change it]</li>
              <li>P value adjustment to:</li>
            </ul>
            <ul>
              <li>None (uncorrected for multiple comparisons), set threshold to 0.001</li>
              <li>FDR (false discovery rate), set threshold to 0.05, etc.</li>
              <li>FWE (family-wise error), set threshold to 0.05, etc.</li>
            </ul>
            <ul>
              <li>Extent threshold: (either use &quot;none&quot; or specify the number of voxels)<b><sup>*</sup></b></li>
            </ul>
            
            <!-- ###################################### -->
            <h2 id="long">CAT12 for longitudinal data</h2>

            <!-- ############################# -->
            <h4>Background</h4>

            <p>The majority of morphometric studies are based on cross-sectional data in which one image is acquired for each subject. However, to map structural changes over time (e.g., in the framework of use-dependent plasticity, neurodevelopment, or aging), longitudinal designs that consider additional time points for each subject are necessary. The handling of these longitudinal data requires a customized processing, as a voxel- or point-wise comparability needs to be assured not only across subjects, but also across time points within subjects. This requires an inverse-consistent (or &quot;symmetric&quot;) realignment as well as an intra-subject bias field correction (<a href="https://doi.org/10.3389/fnins.2012.00197">Ashburner and Ridgway, 2012</a>; <a href="https://doi.org/10.1016/j.neuroimage.2010.07.020">Reuter et al., 2010</a>; <a href="https://doi.org/10.1016/j.neuroimage.2011.02.076">Reuter and Fischl, 2011</a>). Thus, CAT first realigns the images from all time points using inverse-consistent rigid-body registrations and applies intra-subject bias-field corrections. Subsequently, the resulting images are processed individually (see Figure <a href="#figure4">4</a>, <a href="#figure5">5</a>) using the standard pipeline.</p>
            <p>That is, images are tissue-classified and the necessary deformations for spatial registration to the standard template are estimated. However, instead of applying the individual spatial transformations (as done in a cross-sectional analysis), a mean transformation for all time points is calculated and applied to all individual images (<a href="#figure7">Figure 7</a>). The resulting normalized tissue segments can then be used for voxel-based analyses. Optionally, the processed images for all time points can be used to additionally extract the cortical surfaces and to calculate surface parameters, such as cortical thickness or diverse folding measures using the surface-based processing pipeline. Furthermore, the processing of the individual time points is initialized by the processed results from the (unbiased) average image. This reduces random variations in the processing procedure and improves the robustness and sensitivity of the overall longitudinal analysis. This latter processing stream of surface data is similar to the longitudinal approach employed in Freesurfer (<a href="https://doi.org/10.1016/j.neuroimage.2010.07.020">Reuter et al., 2010</a>; <a href="https://doi.org/10.1016/j.neuroimage.2011.02.076">Reuter and Fischl, 2011</a>).</p>
            <p>Please note that three different longitudinal models are offered. The first longitudinal model is optimized for processing and capturing smaller changes over time in response to short-term plasticity effects (e.g. from learning and training). This model will probably not be as sensitive for larger longitudinal changes where large parts of the brain change over time (e.g. atrophy due to Alzheimer&quot;s disease or aging). This is due to the effect of estimating the parameters of spatial registration from the deformations of all time points and then applying them to all time points. If a large atrophy occurs between the time points, this can lead to a displacement of tissue boundaries and might result in areas with reduced volumes over time, which are surrounded by areas with increased volume due to these displacement problems. For data with larger volume changes over time, you should choose the longitudinal model, which is optimized to detect larger changes (e.g. due to ageing). This model also takes into account the deformations between time points and prevents the problems mentioned above. Finally, there also exists a longitudinal processing pipeline for neurodeveopmental data where we can also see changes in head size which should be taken into account.</p>
            <p>Additional attention is then required for the setup of the statistical model. The following section therefore describes the data preprocessing and model setup for longitudinal data.</p>
            <p><img id="figure7" width=100% alt="cat_long_pipeline" src="images/cat_long_pipelines.png"></p>
            <figcaption><b>Figure 7:</b> CATs longitudinal processing workflows to examine (a) neuroplasticity, (b) aging, and (c) neurodevelopment<br>
            The first step in all three workflows is the creation of a high-quality average image over all time points. For this purpose, CAT realigns the images from all time points for each participant using inverse-consistent (or symmetric) rigid-body registrations and intra-subject bias field correction. While this is sufficient to create the required average image for the neuroplasticity and aging workflows, the neurodevelopmental workflow requires non-linear registrations in addition. In either case, the resulting average image is segmented using CATs regular processing workflow to create a subject-specific tissue probability map (TPM). This TPM is used to enhance the time point-specific processing to create the final segmentations. The final tissue segments are then registered to MNI space to obtain a voxel-comparability across time points and subjects, which differs between all three workflows. In the neuroplasticity workflow, an average of the time point-specific registrations is created to register the tissue segments of all time points to MNI space. The aging workflow does the same in principle but adds additional (very smooth) deformations between the individual images across time points to account for inevitable age-related changes over time (e.g., enlargements of the ventricles). In contrast, the neurodevelopmental workflow needs to account for major changes, such as overall head and brain growth, which requires independent non-linear registrations to MNI space of all images across time points (which are obtained using the default cross-sectional registration model).<br>
            For surface-based processing, the neuroplasticity and aging models use the processing of the time point average image to create an average surface. The average is then adapted (deformed) to time point specific maps used in the surface creation, whereas the neurodevelopment workflow has to run the independent cross-sectional surface pipeline for each time point.</figcaption>
            
            <!-- ############################# -->
            <h4>Preprocessing of longitudinal data - overview</h4>
            <p>The CAT12 Toolbox supplies a batch for longitudinal study design. Here, for each subject the respective images need to be selected. Intra-subject realignment, bias correction, segmentation, and spatial registration are calculated automatically. Preprocessed images are written as mwp1r* and mwp2r* for grey and white matter respectively. By selecting the optimized pipeline to detect larger changes an additional &quot;mw&quot; is prepended to the name due to the additional warping and modulation steps. To define the segmentation and registration parameters, the defaults in cat_defaults.m are used. Optionally surfaces can be extracted in the same way as in the cross-sectional pipeline and the realigned tissue segmentations are used for this step.</p>
            
            <!-- ############################# -->
            <h4>Choose of longitudinal model and comparison to SPM12 longitudinal registration</h4>
            <p>SPM12 also offers a batch for pairwise or serial longitudinal registration. In contrast to CAT12, this method relies on the deformations needed to non-linearly register the images of all time points to the mean image. Local volume changes can be calculated from these deformations, which are then multiplied (modulated) by the segmented mean image.</p>
            <p>However, not only the underlying methods differ between SPM12 and the CAT12 longitudinal, but also the focus of possible applications. SPM12 additionally regularizes the deformations with regard to the time differences between the images and has its strengths more in finding larger effects over longer periods of time (e.g. ageing effects or atrophy). The use of deformations between the time points makes it possible to estimate and detect larger changes, while subtle effects over shorter periods of time in the range of weeks or a few months are more difficult to detect. In contrast, longitudinal preprocessing in CAT12 has been initially developed and optimized to detect more subtle effects over shorter periods of time (e.g. brain plasticity or training effects after a few weeks or even shorter times), but now also offers a longitudinal model that is optimized to detect larger changes. With these two different longitudinal models, CAT12 attempts to combine the advantages of both approaches, providing flexibility for a wide range of potential data.</p>
            <p>Unfortunately, there is no clear recommendation for one method or the other method. As a rule of thumb, however, the following could apply: The shorter the time periods and the smaller the expected changes, the more likely the longitudinal model for small changes is the right choice. To find effects of ageing or atrophy due to a (neurodegenerative) disease after a longer period of time, I recommend the longitudinal model for large changes in CAT12.</p>
            <p>Please note that surface-based preprocessing and ROI estimates are not affected by the selected longitudinal model, as the realigned images are used independently to generate cortical surfaces, thickness, or ROI estimates.</p>
            
            <!-- ############################# -->
            <h4 id="long_opt">Optional change of parameters for preprocessing</h4>

            <p>You can change the tissue probability map (TPM) via GUI or by changing the entry in the file cat_defaults.m (i.e. for children data). Any parameters that cannot be changed via the GUI must be set in the file cat_defaults.m:</p>
            <p>Change your working directory to &quot;/toolbox/CAT12&quot; in your SPM directory:</p>
            <p>&rarr; select &quot;Utilities &rarr; cd&quot; in the SPM menu and change to the respective folder.</p>
            <p>Then enter &quot;open cat_defaults.m&quot; in your matlab command window. The file is opened in the editor. If you are not sure how to change the values, open the module &quot;Segment Data&quot; in the batch editor as a reference.</p>
            
            <!-- ############################# -->
            <h4 id="long_process">Preprocessing of longitudinal data</h4>

            <p>CAT12 &rarr; Segment longitudinal data</p>

            Parameters:<br>

            <ul>
              <li>Longitudinal Data
              <ul>
                <li>Select mode of longitudinal data selection for time points or subjects</li>
                <li>In case of &quot;timepoints&quot; you can create multiple time points where each time point has to contain the same number and order of subjects.</li>
                <li>If you have a varying number of time points for each subject you have to use the &quot;subjects&quot; mode where you have to define the files of each subject separately.</li>
                <li>Select all data for each subject or time point. As the Toolbox does not support multispectral data yet (i.e., different imaging methods for the same brain, such as T1-, T2-, diffusion-weighted or CT images), choose a T1-weighted image.</li>
                <li>Select &quot;New: Subject&quot; or &quot;New: Timepoint&quot; to add data for a new subject or time point</li>
              </ul></li>
            </ul>
            <ul>
              <li>Longitudinal Model
              <ul>
                <li>Depending on your type of longitudinal data you can either select the pipeline that is optimized for detecting small changes (e.g. brain plasticity or training effects after a few weeks or even shorter periods of time) or large changes (e.g. ageing or developmental effects).</li>
              </ul></li>
            </ul>

            <p>&rarr; For all other options you can follow the instructions for preprocessing of cross-sectional data as described before. Please note that not all writing options are available for longitudinal data.</p>
            <p>For the naming conventions of all written files see <a href="#naming">Naming Convention of Output Files</a>. The GM segments are mwp1r* (or mwmwp1r* for the model with larger changes) , the WM segments are named mwp2r* (mwmwp2r*) if you have selected the option to modulate the data. Without modulation the leading &quot;m&quot; is omitted.</p>
            
            <!-- ############################# -->
            <h4>Statistical analysis of longitudinal data - overview</h4>

            <p>The main interest in longitudinal studies is in the change of tissue volume over time in a group of subjects or the difference in these changes between two or more groups. The setup of the statistical model needed to evaluate these questions is described in three examples. First, the case of only one group of 8 subjects with 2 time points each (e.g. normal aging) is shown. Then, the case of two groups of subjects with 4 time points is described. Here, we can test for a time by group interaction if we assume that the time points are acquired at the same time and are therefore comparable between the groups. If the time points are not acquired at the same time and are therefore not comparable between the groups, we can use the third design. This design models a time by group interaction using an additional covariate (e.g. age at scanning) and offers more flexibility.</p>
            <p>These examples should cover most analyses - the number of time points / groups just needs to be adjusted. Unlike the analysis of cross-sectional data, as described above, we need to use the flexible factorial model, which takes into account that the time points for each subject are dependent data.</p>
            <p>Please note that it's not strictly necessary to use TIV as a covariate (nuisance) because we are analyzing intra-individual effects that do not need to be corrected and TIV should not change over time.</p>
            
            Again, we recommend using <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.factorial_design');">"Basic Models"</a> in CAT12 GUI, where some unnecessary options have been removed compared to "Basic Models" in SPM12 and some useful options have been added. The same <a href="#stat_options">notes and options</a> apply here as for the cross-section designs.<br>

            <!-- ############################# -->
            <h5 id="long_one">Longitudinal data in one group</h5>

            <p>This model supports the analysis between all time points for one group.</p>
            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Longitudinal data (Flexible factorial)&quot;
              <ul>
                <li>Factors &rarr; &quot;New: Factor; New: Factor&quot;<br>

                <div class="box right">SPM is internally handling some keyword factors such as subject or repl. If you use subject as keyword for the first factor the conditions can be easier defined by only labeling the time points as input (see below).</div>
      
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;subject&quot;)]</em></li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal</li>
                </ul>

                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;time&quot;)]</em></li>
                  <li>Independence &rarr; No</li>
                  <li>Variance &rarr; Equal</li>
                </ul>

                <div class="box right">There are 3 different methods to define all subjects, time points and groups:<br>
                  <ul>
                    <li>Subjects: quite flexible, but annoying to define for many subjects</li>
                    <li>Specify all: quite flexible, but you have to know how to define a factor matrix</li>
                    <li>Groups & Timepoints: easy to define, but restricted to designs with the same number of timepoints per subject</li>
                  </ul>
                </div>
              </li>

              <li>Specify Subjects or all Scans & Factors &rarr; &quot;Subjects&quot; &rarr; &quot;New: Subject; New: Subject; New: Subject; New: Subject&quot;<br>

                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 1st Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 2nd Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>
    
                <div class="box right">It is also possible to deal with missing values for the data. For example, if you normally have three time points, but for some data only two time points for the baseline and the last scan are available, this can be defined by "1 3".</div>
      
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 3rd Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 4th Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 5th Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 6th Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 7th Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 8th Subject)]</em></li>
                  <li>Conditions &rarr; &quot;1 2&quot; [for two time points]</li>
                </ul>

              <li>Main effects & Interaction &rarr; &quot;New: Main effect&quot;<br>
              
                Main effect
                <ul>
                  <li>Factor number &rarr; 2</li>
                </ul>
    
                Main effect
                <ul>
                  <li>Factor number &rarr; 1</li>
                </ul>

              <div class="box right">Dont use covariates that dont change over time, such as sex or TIV. These are treated as constant values and ignored in the statistical analysis because the subject factors are defined anyway.<br>
              In general, its quite difficult to use meaningful covariates in a flexible factorial design that make sense, and in most designs its not recommended unless you are absolutely sure of what you are doing.</div>
      
              </ul></li>
            
            <li>Covariates</li>
            <li>Masking

            <ul>
              <li>Threshold Masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
              <li>Implicit Mask &rarr; Yes</li>
              <li>Explicit Mask &rarr; &lt;None&gt;</li>
            </ul></li>

            <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
            <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>
            
            <!-- ############################# -->
            <h5 id="long_two">Longitudinal data in two (or more) groups</h5>

            <p>This model supports the analysis between all time points between two groups.</p>
            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Longitudinal data (Flexible factorial)&quot;
              <ul>
                <li>Factors &rarr; &quot;New: Factor; New: Factor; New: Factor&quot;<br>
                  
                <div class="box right">SPM is internally handling some keyword factors such as subject or repl. If you use subject as keyword for the first factor the conditions can be easier defined by only labeling the time points as input (see below).</div>
      
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;subject&quot;)]</em></li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal</li>
                </ul>
    
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;group&quot;)]</em></li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal or Unequal</li>
                </ul>

                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;time&quot;)]</em></li>
                  <li>Independence &rarr; No</li>
                  <li>Variance &rarr; Equal</li>
                </ul>

                <div class="box right">There are 3 different methods to define all subjects, time points and groups:<br>
                  <ul>
                    <li>Subjects: quite flexible, but annoying to define for many subjects</li>
                    <li>Specify all: quite flexible, but you have to know how to define a factor matrix</li>
                    <li>Groups & Timepoints: easy to define, but restricted to designs with the same number of timepoints per subject</li>
                  </ul>
                </div>
              </li>

              <li>Specify Subjects or all Scans & Factors &rarr; &quot;Subjects&quot; &rarr; &quot;New: Subject; New: Subject; New: Subject; New: Subject&quot;<br>

                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 1st Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 2 3 4]' &quot; [first group with four time points]</li>
                </ul>
    
                Subject<br>
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 2nd Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 2 3 4]' &quot; [first group with four time points]</li>
                </ul>
    
                <div class="box right">Do not forget the additional single quote! Otherwise you have to define the conditions as  [1 1; 1 2; 1 3; 1 4]  for the first group.</div>
      
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 3rd Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 2 3 4]' &quot; [first group with four time points]</li>
                </ul>
    
                <div class="box right">It is also possible to deal with missing values for the data. For example, if you normally have three time points, but for some data only two time points for the baseline and the last scan are available, this can be defined by "1 3".</div>
      
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 4th Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 2 3 4]' &quot; [first group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 1st Subject of second group)]</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 2 3 4]' &quot; [second group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 2nd Subject of second group)]</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 2 3 4]' &quot; [second group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 3rd Subject of second group)</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 2 3 4]' &quot; [second group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 4th Subject of second group)]</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 2 3 4]' &quot; [second group with four time points]</li>
                </ul>

              <li>Main effects & Interaction &rarr; &quot;New: Interaction; New: Main effect&quot;<br>
              
                Interaction
                <ul>
                  <li>Factor numbers &rarr; 2 3 [Interaction between group and time]</li>
                </ul>

                Main effect
                <ul>
                  <li>Factor number &rarr; 1</li>
                </ul>

              <div class="box right">Dont use covariates that dont change over time, such as sex or TIV. These are treated as constant values and ignored in the statistical analysis because the subject factors are defined anyway.<br>
              In general, its quite difficult to use meaningful covariates in a flexible factorial design that make sense, and in most designs its not recommended unless you are absolutely sure of what you are doing.</div>
      
            </ul></li>
          
            <li>Covariates</li>
            <li>Masking

            <ul>
              <li>Threshold Masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
              <li>Implicit Mask &rarr; Yes</li>
              <li>Explicit Mask &rarr; &lt;None&gt;</li>
            </ul></li>

            <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
            <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>
            
            <!-- ############################# -->
            <h5 id="long_two_interact">Longitudinal data in two (or more) groups with interaction of covariate by group</h5>

            <p>This model supports the analysis of linear increase or decreases over time that differ between two groups. In order to analyze non-linear time effects, a polynomial covariate can be used. Furthermore, this model can be also reduced to one group accordingly or you can use other parameters such as performance over time to analyze dependencies to that variable (e.g. linear increase w.r.t. to performance).</p>
            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>
            <ul>
              <li>Directory &lt;-X &rarr; Select Files &rarr; <em>[select the working directory for your analysis]</em> &rarr; Done</li>
              <li>Design &rarr; &quot;Longitudinal data (Flexible factorial)&quot;
              <ul>
                <li>Factors &rarr; &quot;New: Factor; New: Factor; New: Factor&quot;<br>

                <div class="box right">SPM is internally handling some keyword factors such as subject or repl. If you use subject as keyword for the first factor the conditions can be easier defined by only labeling the time points as input (see below).</div>
      
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;subject&quot;)]</em></li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal</li>
                </ul>
    
                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;group&quot;)]</em></li>
                  <li>Independence &rarr; Yes</li>
                  <li>Variance &rarr; Equal or Unequal</li>
                </ul>

                Factor
                <ul>
                  <li>Name &rarr; <em>[specify text (e.g. &quot;time&quot;)]</em></li>
                  <li>Independence &rarr; No</li>
                  <li>Variance &rarr; Equal</li>
                </ul>

                <div class="box right">There are 3 different methods to define all subjects, time points and groups:<br>
                  <ul>
                    <li>Subjects: quite flexible, but annoying to define for many subjects</li>
                    <li>Specify all: quite flexible, but you have to know how to define a factor matrix</li>
                    <li>Groups & Timepoints: easy to define, but restricted to designs with the same number of timepoints per subject</li>
                  </ul>
                </div>
              </li>

              <li>Specify Subjects or all Scans & Factors &rarr; &quot;Subjects&quot; &rarr; &quot;New: Subject; New: Subject; New: Subject; New: Subject&quot;<br>

                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 1st Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 1 1 1]' &quot; [first group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 2nd Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 1 1 1]' &quot; [first group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 3rd Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 1 1 1]' &quot; [first group with four time points]</li>
                </ul>
    
                <div class="box right">Do not forget the additional single quote! Otherwise you have to define the conditions as  [1 1; 1 2; 1 3; 1 4]  for the first group.</div>
      
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 4th Subject of first group)]</em></li>
                  <li>Conditions &rarr; &quot; [1 1 1 1; 1 1 1 1]' &quot; [first group with four time points]</li>
                </ul>
    
                <div class="box right">Please note that, in contrast to the previous model, all time points are coded here with only one value. The differentiation between the time points is now made by the covariate.</div>
      
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 1st Subject of second group)]</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 1 1 1]' &quot; [second group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 2nd Subject of second group)]</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 1 1 1]' &quot; [second group with four time points]</li>
                </ul>
    
                <div class="box right">It is also possible to deal with missing values for the data. For example, if you normally have three time points, but for some data only two time points for the baseline and the last scan are available, this can be defined by "1 3".</div>
      
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 3rd Subject of second group)</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 1 1 1]' &quot; [second group with four time points]</li>
                </ul>
    
                Subject
                <ul>
                  <li>Scans &rarr; <em>[select files (the smoothed GM data of the 4th Subject of second group)]</em></li>
                  <li>Conditions &rarr; &quot; [2 2 2 2; 1 1 1 1]' &quot; [second group with four time points]</li>
                </ul>

              <li>Main effects & Interaction &rarr; &quot;New: Interaction; New: Main effect&quot;<br>
              
                Interaction
                <ul>
                  <li>Factor numbers &rarr; 2 3 [Interaction between group and time]</li>
                </ul>

                Main effect
                <ul>
                  <li>Factor number &rarr; 1</li>
                </ul>
                
              </ul></li>
            </ul>
          
            <ul>
              <li>Covariates &rarr; &quot;New: Covariate&quot;
              <ul>
                <li>Covariate
                <ul>
                  <li>Vector &rarr; <em>[enter the values for the time-points in the same order as the respective file names of the smoothed images]</em></li>
                  <li>Name &rarr; <em>[specify (e.g. &quot;time&quot;)]</em></li>
                  <li>Interactions &rarr; With Factor 2</li>
                  <li>Centering &rarr; Overall mean</li>
                </ul></li>
              </ul></li>
            <li>Masking

            <ul>
              <li>Threshold Masking &rarr; Absolute &rarr; <em>[specify a value (e.g. &quot;0.1&quot;)]</em></li>
              <li>Implicit Mask &rarr; Yes</li>
              <li>Explicit Mask &rarr; &lt;None&gt;</li>
            </ul></li>

            <li>Correction of TIV &rarr; ANCOVA,  Global scaling, or No</li>
            <li>Check design orthogonality and homogeneity &rarr; <em>[use defaults]</em></li>
            </ul>

            <!-- ############################# -->
            <h5 id="long_contrast">Contrasts for longitudinal models</h5>

            <p>SPM menu &rarr; Results &rarr; <em>[select the SPM.mat file]</em> &rarr; Done (this opens the Contrast Manager) &rarr; Define new contrast (i.e., choose &quot;t-contrast&quot; or &quot;F-contrast&quot;; type the contrast name and specify the contrast by typing the respective numbers, as shown below).</p>

            <p>You can also use the SPM Batch Editor to automate that procedure:</p>

            <p>SPM Batch Editor &rarr; SPM &rarr; Stats &rarr; Contrast Manager</p>

            <p>Please note that all zeros at the end of the contrast don't have to be defined, but are sometimes remained for didactic reasons.</p>

            <table class="img">
              
              <tr>
              <td colspan="1" rowspan="1">
                <p><b>Longitudinal data in one group (example for two time points)</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=25% alt="model_long1" src="images/model_long1.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Time 1 &gt; Time 2 </li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p> 1 -1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Time 1 &lt; Time 2 </li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>-1 1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any differences in Time (effects of interest)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>eye(2)-1/2</p>
                </td>
              </tr>

              <tr>
                <td colspan="1" rowspan="1">
                <p><b>Longitudinal data in two groups (example for two time points)</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=25% alt="model_long2" src="images/model_long2.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Time 1 &gt; Time 2 in Group A</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>1 -1 0 0</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Time 1 &gt; Time 2 in Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 -1</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Time 1 &gt; Time 2 in Groups A and B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>1 -1 1 -1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For Time 1 &gt; Time 2 & Group A &gt; Group B (interaction)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>1 -1 -1 1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1">
                <em>Here n1 and n2 are the number of subjects in Group A and B respectively and k is the number of time points.</em>
                  
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any differences in Time in Group A</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>eye(k)-1/k</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any differences in Time in Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>[zeros(k) eye(k)-1/k]</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect Time</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>[eye(k)-1/k eye(k)-1/k]</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                <li>For interaction Time by Group</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>[eye(k)-1/k 1/k-eye(k)]</p>
                </td>
              </tr>

              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For main effect Group<b><sup>*</sup></b></li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                  
                <div class="box right"><sup>*</sup> This contrast may artificially inflate your results. More information about that issue can be found here:<br>
                https://doi.org/10.3389/fnins.2019.00352</div>
                
                <p>[ones(1,k)/k -ones(1,k)/k ones(1,n1)/n1 -ones(1,n2)/n2]</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Effects of interest (for plotting)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>[eye(k)-1/k zeros(k); zeros(k) eye(k)-1/k]</p>
                </td>
              </tr>
            
              <tr>
              <td colspan="1" rowspan="1">
                <p><b>Longitudinal data in two groups with interaction of covariate by group (example for two time points)</b></p>
                </td>
                <td colspan="1" rowspan="1">
                <p><img class="border" width=25% alt="model_long_cov" src="images/model_long_cov.png"></p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>T-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For regression slope Group A &gt; Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 -1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For regression slope Group A &lt; Group B</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 -1 1</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>F-test</p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>

              <tr class="grey">
                <td colspan="1" rowspan="1">
                <ul>
                  <li>For any differences in regression slope</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 -1</p>
                </td>
              </tr>

              <tr>
                <td colspan="1" rowspan="1">
                <ul>
                  <li>Effects of interest (for plotting)</li>
                </ul>
                </td>
                <td colspan="1" rowspan="1">
                <p>0 0 1 0<br>
                0 0 0 1</p>
                </td>
              </tr>

            </table>
            
            <!-- ###################################### -->
            <h2 id="children">Processing of data such as children</h2>
            <u>Background</u>
            <p>For most analyses, CAT12 provides all necessary tools. Since the new segmentation algorithm is no longer dependent on Tissue Probability Maps (TPMs) and pre-defined Shooting templates for healthy adults exist, most questions can be evaluated using the default Toolbox settings. However, the Toolbox settings may not be optimal for some special cases, such as analysis in children or certain patient groups. Below we present strategies for dealing with these specific cases.</p>
            
            <u>Customized tissue probability maps - overview</u>
            <p>For pediatric MRI data, it is a good idea to create customized TPMs, which reflect age and gender of the population. The <a href="https://neuro-jena.github.io/software.html#tom">TOM8 Toolbox</a> provides the necessary parameters to customize these TPMs.<br>
            You can also try the <a href="https://www.medizin.uni-tuebingen.de/de/das-klinikum/einrichtungen/kliniken/kinderklinik/kinderheilkunde-iii/forschung-iii/software">CerebroMatic Toolbox</a> by Marko Wilke that uses a more flexible template creation approach and additionally allows for the creation of customized Shooting templates.<br>
            Please note that these TPMs should contain 6 classes: GM/WM/CSF and 3 background classes.</p>
            
            <!-- ############################# -->
            <h4 id="tpm">Customized Tissue Probability Maps</h4>

            <u>Within TOM8 Toolbox or Cerebromatic toolbox</u>
            <p>&rarr; create your own customized TPM based on the respective toolbox&quot;s instructions</p>
            
            <u>Implementation into CAT12</u>
            <p>CAT12 &rarr; Segment Data</p>
            
            Parameters:<br>
            <ul>
              <li>Options for initial SPM12 affine registration
              <ul>
                <li>Tissue Probability Map (&rarr; Select your customized TPMs here)</li>
              </ul></li>
            </ul>
            
            <!-- ############################# -->
            <h4 id="cust_templates">Customized Dartel- or Shooting-Template</h4>

            <u>Overview</u>
            <p>An individual (customized) template can be created for all cases involving a representative number of subjects. This means that an average template of the study sample is created from the tissue segments of the grey matter and white matter tissue segments of all subjects.</p>
            <p>Please note that the use of your own template results in deviations and unreliable results for ROI-based estimations as the atlases are different. Therefore, all ROI outputs in CAT12 are disabled if you use your own customized template.</p>
            
            <u>Steps to create a customized DARTEL template based on your own subjects</u>
            <p>Several steps are required to create normalized tissue segments with customized templates. These steps can be bundled using dependencies in the Batch Editor. The last step (&quot;Normalise to MNI space&quot;) can be repeated with the customized templates if additional output files are required (e.g. you have only saved GM segmentations but are also interested in the WM segmentations or you would like to use a different smoothing size).</p>
            <p>In the first step, the T1 images are segmented and the tissue segments are normalized to the Tissue Probability Maps by means of an affine transformation. Start by selecting the module &quot;Segment Data&quot;.</p>
            <p>CAT12 &rarr; Segment Data</p>

            Parameters:<br>
            <p> &rarr; for all options except &quot;writing options&quot; use the same settings as you would for a &quot;standard&quot; VBM analysis.</p>

            <ul>
              <li>Writing Options
              <ul>
                <li>&quot;Grey Matter&quot;&rarr; &quot;Modulated normalized&quot; &rarr; &quot;No&quot;</li>
                <li>&quot;Grey Matter&quot;&rarr; &quot;DARTEL export&quot; &rarr; &quot;affine&quot;</li>
                <li>&quot;White Matter&quot;&rarr; &quot;Modulated normalized&quot; &rarr; &quot;No&quot;</li>
                <li>&quot;White Matter&quot;&rarr; &quot;DARTEL export&quot; &rarr; &quot;affine&quot;</li>
            </ul></li>
            </ul>

            <p>These settings will generate the volumes &quot;rp1*-affine.nii&quot; and &quot;rp2*-affine.nii&quot;, i.e. the grey (rp1) and white (rp2) matter segments after affine registration. The following modules can be selected directly in the batch editor (SPM &rarr; Tools &rarr; CAT12 &rarr; CAT12: Segment Data and SPM &rarr; Tools &rarr; DARTEL Tools &rarr; Run DARTEL (create Templates)). It makes sense to add and specify these modules together with the &quot;Segment Data&quot; module described above, within the Batch Editor and to set dependencies so that all processing takes place within one batch. To this effect, add the following two steps:</p>
            <p>SPM &rarr; Tools &rarr; Dartel Tools &rarr; Run Dartel (create Templates)</p>

            Parameters:<br>
              Images &rarr; select two times &quot;new: Images&quot;<br>  
              <ul>
                <li>Images: &rarr; select the &quot;rp1*-affine.nii&quot; files or create a dependency.</li>
                <li>Images: &rarr; select the &quot;rp2*-affine.nii&quot; files or create a dependency.</li>
              </ul>
  
            <p> &rarr; all other options: use defaults or modify as you wish</p>
            <p>SPM &rarr; Tools &rarr; Dartel Tools &rarr; Normalise to MNI space</p>
            
            Parameters:<br>
            DARTEL Template &rarr; select the final created template with the ending &quot;_6&quot;.

            <ul>
              <li>Select according to &rarr; &quot;Many Subjects&quot;
              <ul>
                <li>Flow fields: &rarr; select the &quot;u_*.nii&quot; files or create a dependency.
                <ul>
                  <li>Images: &rarr; New: Images &rarr; select the &quot;rp1*-affine.nii&quot; files or create a dependency.</li>
                  <li>Images: &rarr; New: Images &rarr; select the &quot;rp2*-affine.nii&quot; files or create a dependency.</li>
                </ul>
              </ul></li>
                <li>Preserve: &rarr; &quot;Preserve Amount&quot;</li>
                <li>Gaussian FWHM: &rarr; use defaults or modify as you wish</li>
              </ul>
            <p>&rarr; all other options: use defaults or modify as you wish</p>
            
            <p>Please note, that a subsequent smoothing is not necessary before statistics if you have used the option &quot;Normalise to MNI space&quot; with a defined Gaussian FWHM.</p>
            
            <u>Alternative approach</u>
            <p>Instead of creating your own customized DARTEL template as described above you can also make use of the customized DARTEL templates that are created with the <a href="https://www.medizin.uni-tuebingen.de/de/das-klinikum/einrichtungen/kliniken/kinderklinik/kinderheilkunde-iii/forschung-iii/software">CerebroMatic Toolbox</a> by Marko Wilke.</p>
            
            <u>Initial or re-use of customized DARTEL-templates</u>
            <p>Optionally you can also use either the externally-made or your newly created, customized DARTEL templates directly in the CAT12 Toolbox. This can be helpful if new data is age-wise close to the data used to create the DARTEL template (e.g. you have an ongoing study and some more new subjects are added to the sample). In this case, it is not absolutely necessary to always create a new template and you can simply use the previously created DARTEL template. Finally, an additional registration to MNI (ICBM) space will usually be applied:</p>
            <p>SPM &rarr; Tools &rarr; Dartel Tools &rarr; Run Dartel (Population to ICBM Registration)</p>
            
            Parameters:<br>
            DARTEL Template &rarr; select the final created template with the ending &quot;_6&quot;.

            <p>SPM &rarr; Util &rarr; Deformations</p>
            
            Parameters:<br>
            Composition &rarr; &quot;New: Deformation Field&quot;  
            <ul>
              <li>Deformation Field: &rarr; select the &quot;y_*2mni.nii&quot; file from step above.</li>
            </ul>
            Output &rarr; &quot;New: Pushforward&quot;
            <ul>
              <li>Apply to &rarr; select all &quot;Template&quot; files with the ending &quot;_0&quot; to &quot;_6&quot;.</li>
              <li>Output destination &rarr; Output directory &rarr; select directory for saving files.</li>
              <li>Field of View &rarr; Image Defined &rarr; select final &quot;Template&quot; file with the ending &quot;_6&quot;.</li>
              <li>Preserve &rarr; Preserve Concentrations (no &quot;modulation&quot;).</li>
            </ul>
            
            <p>Finally, your customized DARTEL template can also be used as the default DARTEL template within CAT12:</p>
            <p>CAT12 &rarr; Segment Data</p>
            
            Parameters:<br>

            <ul>
              <li>Volumes &lt;-X &rarr; Select the original T1 images (as in the first module &quot;Segment Data&quot; described above)</li>
              <li>Extended Options for CAT12 segmentation &rarr; &quot;Spatial normalization Template&quot; &rarr; Select normalized DARTEL Template &quot;wTemplate*_1.nii&quot;<br>
              For all other options use the same settings as in the first module, or modify as you wish.</li>
              <li>Writing Options &rarr; select the output files just like in any standard VBM analysis:</li>
            </ul>

            <p>Please note that now the output files have to be smoothed as usual with a Gaussian filter before statistical analyses. Also note that, while ROI analyses will not be disabled, their validity must be critically assessed depending on the DARTEL template used.</p>
            
            <u>Steps to create a customized Shooting template based on your own subjects</u>
            <p>The steps required to create a customized Shooting template are similar to the DARTEL template and you can use the first steps from the description above to save the affine registered segmentations for grey and white matter.</p>
            <p>SPM &rarr; Tools &rarr; Shoot Tools &rarr; Run Shooting (create Templates)</p>
            
            Parameters:<br>
            Images &rarr; select two times &quot;new: Images&quot;

            <ul>
              <li>Images: &rarr; select the &quot;rp1*-affine.nii&quot; files or create a dependency.</li>
              <li>Images: &rarr; select the &quot;rp2*-affine.nii&quot; files or create a dependency.</li>
            </ul>

            <p>SPM &rarr; Tools &rarr; Shoot Tools &rarr; Write Normalised</p>

            Parameters:<br>
            Shoot Template &rarr; select the final created template with the ending &quot;_4&quot;.

            <ul>
              <li>Select according to &rarr; &quot;Many Subjects&quot;
              <ul>
                <li>Deformation fields: &rarr; select the &quot;y_*.nii&quot; files or create a dependency.
                <ul>
                  <li>Images: &rarr; New: Images &rarr; select the &quot;rp1*-affine.nii&quot; files or create a dependency.</li>
                  <li>Images: &rarr; New: Images &rarr; select the &quot;rp2*-affine.nii&quot; files or create a dependency.</li>
                </ul>
              </ul></li>
            </ul>
            <ul>
              <li>Preserve: &rarr; &quot;Preserve Amount (modulation)&quot;</li>
              <li>Gaussian FWHM: &rarr; modify as you wish</li>
            </ul>
            
            <p>&rarr; all other options: use defaults or modify as you wish</p>
            
            <p>Please note, that a subsequent smoothing is not necessary before statistics if you have used the option &quot;Write Normalised&quot; with a defined Gaussian FWHM.</p>
            <p>Optionally you can also use either the externally-made or your newly created, customized Shooting templates directly in the CAT12 Toolbox for new data that should be processed with this template.</p>
            
            <!-- ################################################################################# -->
            <h2 id="oCA">Other variants of computational morphometry</h2>
            
            <!-- ###################################### -->
            <h4 id="dbm">Deformation-based morphometry (DBM)</h4>

            <u>Background</u>
            <p>DBM is based on the application of non-linear registration procedures to spatially normalize one brain to another one. The simplest case of spatial normalization is to correct the orientation and size of the brain. In addition to these global changes, a non-linear normalization is necessary to minimize the remaining regional differences due to local deformations. If this local adaptation is possible, the deformations now provide information about the type and localization of the structural differences between the brains and can then be analyzed.</p>
            <p>Differences between the two images are minimized and are now coded in the deformations. Finally, a map of local volume changes can be quantified by a mathematical property of these deformations - the Jacobian determinant. This parameter is well known from continuum mechanics and is usually used for the analysis of volume changes in flowing liquids or gases. The Jacobian determinant allows a direct estimation of the percentage change in volume in each voxel and can be analyzed statistically (<a href="https://doi.org/10.1006/nimg.2001.0771">Gaser et al., 2001</a>). This approach is also known as tensor-based morphometry since the Jacobian determinant represents such a tensor.</p>
            <p>A deformation-based analysis can be performed not only on the local volume changes, but also on the entire information of the deformations, which also includes the direction and strength of the local deformations (<a href="https://doi.org/10.1006/nimg.1999.0458">Gaser et al., 1999</a>; <a href="https://doi.org/10.1006/nimg.2001.0771">Gaser et al., 2001</a>). Since each voxel contains three-dimensional information, a multivariate statistical test is required for analysis. For this type of analysis, a multivariate general linear model or Hotelling&quot;s T2 test is often used (<a href="https://doi.org/10.1006/nimg.1999.0458">Gaser et al., 1999</a>).</p>
            
            <u>Additional Steps in CAT12</u>
            <p>CAT12 &rarr; Segment Data</p>

            Parameters:<br>

            <ul>
              <li>Writing options &rarr; Jacobian determinant &rarr; Normalized &rarr; Yes
              <ul>
                <li>To save the estimated volume changes, modify the writing option for the normalized Jacobian determinant to &quot;yes&quot;.</li>
              </ul></li>
            </ul><br>

            <u>Changes in statistical analysis</u>
            <p>Follow the steps for the statistical analysis as described for VBM, select the smoothed Jacobian determinants (e.g. swj_*.nii ) and change the following parameters:</p>
            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Covariates: Don't use TIV as covariate</li>
              <li>Masking
              <ul>
                <li>Threshold Masking &rarr; None</li>
                <li>Implicit Mask &rarr; Yes</li>
                <li>Explicit Mask &rarr; ../spm12/tpm/mask_ICV.nii</li>
              </ul>
            </ul>
            
            <!-- ###################################### -->
            <h4 id="sbm">Surface-based morphometry (SBM)</h4>

            <u>Background</u>
            <p>Surface-based morphometry has several advantages over the sole use of volumetric data. For example, it has been shown that using brain surface meshes for spatial registration increases the accuracy of brain registration compared to volume-based registration (<a href="https://doi.org/10.1016/j.neuroimage.2005.03.024">Desai et al., 2005</a>). Brain surface meshes also permit new forms of analyses, such as gyrification which measure surface complexity in 3D (<a href="https://doi.org/10.1016/j.neuroimage.2011.02.007">Yotter et al., 2011b</a>) or cortical thickness (<a href="https://doi.org/10.1016/j.neuroimage.2012.09.050">Dahnke et al., 2013</a>). In addition, inflation or spherical mapping of the cortical surface mesh raises the buried sulci to the surface so that mapped functional activity in these regions can be made easily visible.</p>
            
            <i>Local adaptive segmentation</i>
            <p>Gray matter regions with high iron concentration, such as the motor cortex and occipital regions, often have an increased intensity leading to misclassifications. In addition to our adaptive MAP approach for partial volume segmentation, we use an approach that allows us to adapt local intensity changes to deal with varying tissue contrasts (<a href="https://doi.org/10.1016/j.neuroimage.2012.09.050">Dahnke et al., 2012a</a>).</p>
            
            <i>Cortical thickness and central surface estimation</i>
            <p>We use a fully automated method that allows the measurement of cortical thickness and reconstruction of the central surface in one step. It uses a tissue segmentation to estimate the white matter (WM) distance and then projects the local maxima (which is equal to the cortical thickness) onto other gray matter voxels using a neighboring relationship described by the WM distance. This projection-based thickness (PBT) allows the handling of partial volume information, sulcal blurring, and sulcal asymmetries without explicit sulcus reconstruction (<a href="http://www.neuro.uni-jena.de/hbm2012/HBM2012-Dahnke02.pdf">Dahnke et al., 2012b</a>).</p>
            
            <i>Topological correction</i>
            <p>To repair topological defects, we use a novel method based on spherical harmonics (<a href="https://doi.org/10.1002/hbm.21095">Yotter et al., 2011a</a>). First of all, the original MRI intensity values are used to select either a &quot;fill&quot; or &quot;cut&quot; operation for each topological defect. We modify the spherical map of the uncorrected brain surface mesh in such a way that certain triangles are preferred when searching for the bounding triangle during reparameterization. Subsequently, a low-pass filtered alternative reconstruction based on spherical harmonics is patched into the reconstructed surface in areas where defects were previously present. </p>
            
            <i>Spherical mapping</i>
            <p>A spherical map of a cortical surface is usually necessary to reparameterize the surface mesh into a common coordinate system to enable inter-subject analysis. We use a fast algorithm to reduce area distortion, which leads to an improved reparameterization of the cortical surface mesh (<a href="https://doi.org/10.1111/j.1552-6569.2010.00484.x">Yotter et al., 2011c</a>).</p>
            
            <i>Spherical registration</i>
            <p>We have adapted the volume-based diffeomorphic DARTEL algorithm to the surface (<a href="https://doi.org/10.1016/j.neuroimage.2007.07.007">Ashburner, 2007</a>) to work with spherical maps (<a href="http://www.neuro.uni-jena.de/hbm2011/Yotter02.pdf">Yotter et al., 2011d</a>). We apply a multi-grid approach that uses reparameterized values of sulcal depth and shape index defined on the sphere to estimate a flow field that allows the deformation of a spherical grid.</p>
            
            <u>Additional Steps in CAT12</u>
            <p>CAT12 &rarr; Segment Data</p>

            Parameters:<br>

            <ul>
              <li>Writing options &rarr; Surface and thickness estimation &rarr; Yes</li>
            </ul>

            <p>Use projection-based thickness to estimate cortical thickness and to create the central cortical surface for the left and right hemisphere.</p>
            
            <p>CAT12 &rarr; Surface Tools &rarr; Resample Surfaces</p>

            Parameters:<br>

            <ul>
              <li>Surface Data &lt;-X &rarr; Select the surface data (e.g. [lr]h.thickness.*)</li>
              <li>Smoothing Filter Size in FWHM <em>[use defaults or modify]<br>
              12-15mm kernels are widely used for SBM and I recommend to start with a value of 15mm for thickness data and 20mm for folding data (e.g. gyrification, complexity).</em></li>
              <li>Split job into separate processes<br>
              <em>To use multi-threading the CAT12 segmentation job with multiple subjects can be split into separate processes that run in the background. You can even close Matlab, which will not affect the processes that will run in the background without GUI. If you don't not want to run processes in the background then set this value to 0.<br>
              Keep in mind that each process needs about 1.5..2GB of RAM, which should be considered to choose the right number of processes.<br>
              Please further note that no additional modules in the batch can be run except CAT12 segmentation. Any dependencies are broken for subsequent modules.</em></li>
            </ul>

            <u>Extract optional surface parameters</u>
            <p>You can also extract additional surface parameters that need to be resampled and smoothed with the above tool.</p>
            <p>CAT12 &rarr; Surface Tools &rarr; Surface Measures &rarr; Extract Additional Surface Parameters</p>

            Parameters:<br>

            <ul>
              <li>Central Surfaces &lt;-X &rarr; Select the central surface data (e.g. [lr]h.central.*)</li>
              <li>Gyrification<br>
              <em>Extract gyrification based on absolute mean curvature. The method is described in <a href="https://doi.org/10.1016/j.neuroimage.2005.08.049">Luders et al., 2006</a>.</em></li>
              <li>Cortical complexity (fractal dimension)<br>
              <em>Extract Cortical complexity (fractal dimension) which is described in <a href="https://doi.org/10.1016/j.neuroimage.2011.02.007">Yotter et al., 2011.</a><br>
              Warning: Estimation of cortical complexity is very slow!</em></li>
              <li>Sulcus depth
              <em>Extract sulcus depth based on the Euclidean distance between the central surface and its convex hull. In addition, sulcal depth can be transformed with sqrt-function to render the data more normally distributed, which is the recommended option for further statistical analysis.</em></li>
            </ul>

            <u>Changes in statistical analysis</u>
            <p>For statistical analysis of surface measures you can use the common 2nd level models, which are also used for VBM. Follow the steps for the statistical analysis as described for VBM and change the following parameters:</p>
            <p>CAT12 &rarr; Statistical Analysis &rarr; Basic Models</p>

            Parameters:<br>

            <ul>
              <li>Covariates: Don't use TIV as covariate</li>
              <li>Masking
              <ul>
                <li>Threshold Masking &rarr; None</li>
                <li>Implicit Mask &rarr; Yes</li>
                <li>Explicit Mask &rarr; &lt;none&gt;</li>
              </ul>
            </ul>

            <p>As input you have to select the resampled and smoothed files (see above). A thickness file of the merged left and right hemispheres that was resampled and smoothed with the default FWHM of 15mm is named as:
            <p style="text-indent: 2em;">
              S15.mesh.thickness.resampled.name.gii
            </p>
            
            where &quot;name&quot; is the original filename without extension. Please note that these files are saved in the surf-folder as default.<br>
            <p>Do not use the &quot;Estimate&quot; function in the SPM window, but the corresponding function in CAT12. This allows you to automatically overlay the results on the Freesurfer average surface:<br>
            CAT12 &rarr; Statistical Analysis &rarr; Estimate Surface Models</p>
            
            <!-- ###################################### -->
            <h4 id="roi">Region of interest (ROI) analysis</h4>

            <p>CAT12 enables the estimation of mean tissue volumes (and additional surface parameters such as cortical thickness) for different volume and surface-based atlas maps (Gaser et al., 2016). All of these results are estimated in the native space before any spatial normalization and the mean value inside the ROI is estimated. The results for each dataset are stored as XML files in the label directory. The XML file catROI[s]_*.xml contains information of all atlases as data structure for one dataset and the optional &quot;s&quot; indicates surface atlases. You can use the CAT function &quot;cat_io_xml&quot; to read the XML data as a structure.</p>
            
            <p>Please also check <a href="#atlas">Atlas creation and ROI based analysis</a> for more detailed information and a description of the available atlases.</p>

            <!-- ############################# -->
            <h5>Additional steps for surface data</h5>
            <p>While ROI-based values for VBM (volume) data are automatically stored in the label folder as an XML file it is necessary to extract these values additionally for surface data. This must be done after preprocessing the data and creating cortical surfaces. You can extract ROI-based values for cortical thickness but also for any other surface parameter that extracted with the &quot;Extract Additional Surface Parameters&quot; function:</p>
            <p>CAT12 &rarr; ROI Data &rarr; Extract ROI-based surface values</p>

            Parameters:<br>

            <ul>
              <li>(Left) Surface Data Files &lt;-X &rarr; Select surface data files such as lh.thickness.* for all subjects</li>
            </ul>

            <!-- ############################# -->
            <h4>Statistical analysis of ROI data</h4>
            <p>Finally, the XML files of several subjects can be analyzed using an existing SPM design with CAT12 &rarr; Analyze ROIs. Here, the SPM.mat file is used to get information about all corresponding label files, but also about your design (including all covariates/confounds you have modeled). In this way, the same statistical analysis saved in the SPM.mat file is applied to your ROI data. You can then select a contrast, a threshold value and a measurement type to be analyzed (e.g. Vgm, Vwm, thickness, gyrification...) and choose between different atlas maps. The results are printed and saved as thresholded log-p volume or surface map:<br>
            <div style="text-indent: 2em;">logPThreshold_NameOfContrast_NameOfAtlas_Measure.nii<br>
            <p style="text-indent: 2em;">[lr]h.logPThreshold_NameOfContrast_NameOfAtlas_Measure.gii</div>
            
            <p>These maps can be optionally visualized using<br>
            CAT12 &rarr; Display Results &rarr; Slice Overlay for volume maps or<br>
            CAT12 &rarr; Display Results &rarr; Surface Overlay<br>
            
            <p>To analyze different measures (e.g. Vgm/Vwm for volumes or thickness/gyrification for surfaces) you can use any existing volume-based analysis to extract different volume measures, or any existing surface-based analysis to extract different surface measures. To give you an example: An existing SPM.mat file with a VBM analysis of GM allows you to analyze ROI measures for both, GM as well as WM. Therefore, it is not necessary to have a SPM.mat file of a VBM analysis of WM. The same applies to surface-based analysis. If you already have an SPM.mat for the analysis of cortical thickness, you can also estimate the ROI analysis for gyrification or fractal dimension. For surfaces, however, it is necessary to extract ROI-based measures for each subject using CAT12 &rarr; ROI Data &rarr; Extract ROI-based surface values prior to this step.</p>
            <p>For ROI analysis of surfaces you can select the SPM.mat file of the analysis, either for the left or right hemisphere, or for the merged hemispheres. The design should be the same and the ROI results are always estimated for both hemispheres.</p>
            <p>Please note that if you have moved your data after estimating your original voxel- or surfaced-based statistics, the required ROI files cannot be found.</p>
            
            <!-- ############################# -->
            <h4>Optional extraction of ROI data</h4>
            <p>Finally, the XML files of several subjects can be combined and saved as CSV file using the &quot;Estimate Mean Values inside ROI&quot; function for further analysis (volumes are defined in mL):</p>
            <p>CAT12 &rarr; ROI Data &rarr; Estimate mean values inside ROI</p>

            Parameters:<br>

            <ul>
              <li>XML files &lt;-X &rarr; Select xml files for each subject that are saved in the label folder.</li>
              <li>Output file &rarr; Define output name for csv file. This name is extended by the atlas name and the name of the measure (e.g. &quot;Vgm&quot; for gray matter volume)</li>
            </ul>

            <p>For each measurement (e.g. &quot;Vgm&quot; for gray matter volume) and each atlas a separate CSV file is written. This works for both volume and surface data, but volume and surface data has to be processed separately with this function (surface-based ROI values are indicated by an additional &quot;s&quot;, e.g. &quot;&quot;catROIs_&quot;&quot;). You can use external software such as Excel or SPSS to import the resulting CSV files (volumes are defined in mL) for further analysis. Also pay attention to the different interpretations between &quot;.&quot; and &quot;,&quot; depending on your region and language settings on your system.</p>
            
            <!-- ############################# -->
            <h4>Use of atlas functions in SPM12</h4>
            <p>You can also use the volume-based atlases delivered with CAT as atlas maps with SPM atlas functions. This is particularly useful if you have used the default VBM processing pipeline, since the CAT12 atlas maps are then in the same Shooting space as your data. If you have used the default VBM processing pipeline, it is recommended to use CAT12 atlases in the Shooting space instead of the SPM Neuromorphometrics atlas. To use CAT12 atlases, you must call the cat_install_atlases function once , which copies the atlases to SPM. By default, only Neuromorphometics, LPBA40, and Hammers atlas maps are used, which are identified by a leading &quot;&quot;dartel_&quot;&quot; in the name.</p>
            <p>Atlas maps for surfaces can be used with the function CAT12 &rarr; Display Results &rarr; Surface Overlay. You can use the data cursor function to display atlas regions under the cursor. In addition, you can use the &quot;&quot;Atlas labeling&quot;&quot; function to print a list of atlas regions of the resulting clusters or overlay the atlas borders on your rendered surface.</p>
            
            <!-- ################################################################################# -->
            <h2 id="add_info">Additional information</h2>

            <!-- ###################################### -->
            <h3 id="reg_info">Spaces after registration</h3>

            <p>When preprocessing the images (see &quot;First Module: Segment Data&quot;, on pages 5-6), the decision on the normalization parameters determines the interpretation of the analysis results. Please note that some of the output options are only available in the expert mode.</p>
            
            <p>&quot;Native space&quot; creates tissue class images in spatial correspondence to the original data. Although this may be useful for estimating global tissue volumes (e.g. GM+WM+CSF=TIV) it is not suitable for performing VBM analyses due to the lack of voxel-wise correspondence in the brain). If one is interested in these global tissue volumes in the native space (&quot;raw values&quot;), it is not necessary to actually output the tissue class images in native space. The &quot;Segment Data&quot;-function automatically generates an xml file for each subject (cat_*.xml), which contains the raw values for GM, WM, and CSF. The subject-specific values can be calculated (i.e., integrated into a single text file) using the function: CAT12 &rarr; Statistical Analysis &rarr; Estimate TIV.</p>
            
            <p>&quot;Normalized&quot; creates tissue class images in spatial correspondence to the template in MNI152NLin2009cAsym space. This is useful for VBM analyses (e.g. &quot;concentration&quot; of gray matter; <a href="https://doi.org/10.1006/nimg.2001.0786">Good et al., 2001</a>).<br>
            An excellent overview about the <a href="https://www.lead-dbs.org/about-the-mni-spaces/">different MNI spaces</a> can be found on the DBS site from Andreas Horn.</p>
            
            <p>&quot;Modulated normalized&quot; creates tissue class images in alignment with the template, but multiplies (&quot;modulates&quot;) the voxel values with the Jacobian determinant (i.e., linear and non-linear components) derived from the spatial normalization. This is useful for VBM analyses and allows the comparison of the absolute amount of tissue (e.g. &quot;volume&quot; of gray matter; <a href="https://doi.org/10.1006/nimg.2001.0786">Good et al., 2001</a>). Please note that in this type of modulation you must use TIV as covariate to correct different brain sizes. An alternative approach is to use global scaling with TIV if TIV is too strongly correlated with your covariates of interest. For more information, see the section &quot;Checking for Design Orthogonality&quot;.</p>
            <p>If you use the expert mode, you can optionally choose whether you want to modulate your data for non-linear terms only, which was the default for previous VBM-toolbox versions. This produces tissue class images in alignment with the template, but the voxel values are only multiplied by the non-linear components. This is useful for VBM analyses and allows comparison of the absolute amount of tissue corrected for individual brain sizes. This option is similar to using &quot;Affine+non-linear&quot; (see above) in combination with &quot;global normalization&quot; (when building the statistical model with the traditional PET design late one). Although this type of modulation was used in as default previous VBM-toolbox versions it is no longer recommended as the use of standard modulation in combination with TIV as covariate provides more reliable results (<a href="https://doi.org/10.1016/j.neuroimage.2014.09.034">Malone et al., 2015</a>).</p>
            
            <!-- ###################################### -->
            <h3 id="naming">Naming convention of output files</h3>

            <p>Please note that the resulting files of CAT12 are organized in separate subfolders (e.g. mri, report, surf, label). If you don't want to use subfolders you can change the option &quot;cat12.extopts.subfolders&quot; in cat_default.m to &quot;0&quot;.</p>

            <!-- ############################# -->
            <h4>Images (saved in subfolder &quot;mri&quot;)</h4>

            <table class="img">
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>Segmented Images:</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>[m[0]w]p[0123]*[_affine].nii</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>Bias, noise and intensity corrected T1 image:</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>[w]m*.nii</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>Jacobian determinant:</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>wj_*.nii</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>Deformation field (inverse field):</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>y_*.nii (iy_*.nii)</p>
                </td>
              </tr>

              <tr>
                <td colspan="1" rowspan="1">
                <p></p>
                <p><b>Image space prefix:</b></p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>m</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>modulated</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>m0</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>modulated non-linear only (expert mode only)</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>w</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>warped (spatially normalized using Dartel/Shooting)</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>r</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>realigned (for longitudinal data only)</p>
                </td>
              </tr>
              
              <tr>
                <td colspan="1" rowspan="1">
                <p></p>
                <p><b>Image space extension:</b></p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>_affine</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>affine registered only</p>
                </td>
              </tr>
              
              <tr>
                <td colspan="1" rowspan="1">
                <p></p>
                <p><b>Image data prefix:</b></p>
                </td>
                <td colspan="1" rowspan="1"></td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>p</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>partial volume (PV) segmentation</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>0</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>PV label</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>1</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>GM</p>
                </td>
              </tr>
                <tr>
                <td colspan="1" rowspan="1">
                <p>2</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>WM</p>
                </td>
              </tr>
              <tr class="grey">
                <td colspan="1" rowspan="1">
                <p>3</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>CSF</p>
                </td>
              </tr>
            </table>
            
            <!-- ############################# -->
            <h4>Surfaces in native space (saved in subfolder "surf")</h4>
            <p>SURF.TYPE.*.gii</p>

            <table class="img">
              <tr>
                <td colspan="1" rowspan="1">
                <p>SURF</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>left, right hemisphere [ lh | rh ]</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>TYPE</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>surface data file [ central | sphere | thickness | gyrification | ... ]</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>central - coordinates and faces of the central surface</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>sphere - coordinates and faces of the spherical projection of the central surface</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>sphere.reg - coordinates and faces of the sphere after spherical registration</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>thickness - thickness values of the surface</p>
                <p>pbt - distance measure that is internally used for mapping</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>depth - sulcal depth based on the euclidean distance between the central surface and its convex hull</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>gyrification - gyrification values based on absolute mean curvature</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>fractaldimension - fractal dimension values (cortical complexity)</p>
                </td>
              </tr>
            </table>
            
            <!-- ############################# -->
            <h4>Surfaces in (normalized) template space (after resampling and smoothing; saved in subfolder "surf" by default)</h4>
            <p>FWHM.SURF.TYPE.RESAMP.*.gii/dat</p>

            <table class="img">
              <tr>
                <td colspan="1" rowspan="1">
                <p>FWHM</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>filtersize in FWHM after smoothing (e.g. s12)</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>SURF</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>left, right, or both hemispheres [ lh | rh | mesh ]</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>TYPE</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>surface data file [ thickness | gyrification | fractaldimension | ... ]</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>thickness - thickness values of the surface</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>depth - sulcal depth based on the euclidean distance between the central surface and its convex hull</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>gyrification - gyrification values based on absolute mean curvature</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1"></td>
                <td colspan="1" rowspan="1">
                <p>fractaldimension - fractal dimension values (cortical complexity)</p>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                <p>RESAMP</p>
                </td>
                <td colspan="1" rowspan="1">
                <p>resampling to 164k (Freesurfer) or 32k (HCP) mesh [ resampled | resampled_32k ]</p>
                </td>
              </tr>
            </table>
            
            <p>Please note that the resampled surfaces are stored in normalized space as a gifti file and an external dat-file to increase processing speed and minimize the size of the resulting SPM.mat for statistical analysis. Both files are required for each surface dataset.</p>
            
            <!-- ############################# -->
            <h4>Images and surfaces of longitudinal data</h4>
            <p>After processing longitudinal data, the filenames additionally contain a &quot;r&quot; between the original filename and the other prefixes to indicate the additional registration step.</p>
            <p>Furthermore, if you select the longitudinal model for detecting larger changes (e.g. ageing or developmental effects) the segmented images are additionally indicated by a leading &quot;mw&quot; due to the additional warping and modulation steps.</p>
            
            <u>Example:</u><br>
            mwp1r * - gray matter<br>
            mwmwp1r* - gray matter (longitudinal model for detecting larger changes)<br>

            <!-- ############################# -->
            <h4>Reports (saved in subfolder &quot;report&quot;)</h4>
            <p>Global morphometric and image quality measures are stored in the cat_*.xml file. This file also contains other useful information about software versions and options used to preprocess the data. You can use the cat_io_xml function to read data from xml-files. In addition, a report for each data set is saved as pdf-file catreport_*.pdf.</p>
            
            <!-- ############################# -->
            <h4>Regions of interest (ROI) data (saved in subfolder &quot;label&quot;)</h4>
            <p>ROI data is optionally saved as xml-file catROI [s]_*.xml. The optional &quot;s&quot; indicates surface atlases.</p>
            
            <!-- ################################################################################# -->
            <h4 id="unix">Calling CAT from the UNIX command line</h4>

            <p>You can also call CAT as a shell script from the Unix command line. This makes it possible to run the process completely in the background without graphical output and distributes all given data to parallel jobs. This can be useful if you want to run CAT on a computer cluster.</p>
            <p>You can use the shell scripts cat_batch_cat.sh or cat_batch_long.sh (for longitudinal data). Please call the scripts for more information on how to define optional defaults files, for example.</p>
            
            <!-- ############################# -->
            <h5>Standalone versions (precompiled)</h5>
            <p>The advantage of the standalone version is that no Matlab license is needed. Only the (free) Matlab Runtime R2017b (v93) has to be downloaded. However, there are some limitations (e.g. no parallelization and no interactive help in the GUI version) and the standalone version is mainly intended to run without GUI on Unix systems. Please check the <a href="https://neuro-jena.github.io/enigma-cat12/#standalone">ENIGMA CAT12</a> site fore more information and examples to call CAT12 from shell scripts.</p>
            <p>The MATLAB Compiler Runtime (MCR) enables you to run applications compiled within MATLAB using MATLAB Compiler. MCR does not require a MATLAB license and can be used to run the MATLAB compiled program on computers which do not have MATLAB installed. </p>
            <ul class="actions">
              <li><a href="https://www.neuro.uni-jena.de/cat12/cat12_latest_R2017b_MCR_Mac.zip" class="button">CAT12 Standalone for Mac</a></li>
              <li><a href="https://ssd.mathworks.com/supportfiles/downloads/R2017b/deployment_files/R2017b/installers/maci64/MCR_R2017b_maci64_installer.dmg.zip" class="button">MCR for Mac</a></li>
            </ul>
            <ul class="actions">
              <li><a href="https://www.neuro.uni-jena.de/cat12/cat12_latest_R2017b_MCR_Linux.zip" class="button">CAT12 Standalone for Linux</a></li>
              <li><a href="https://ssd.mathworks.com/supportfiles/downloads/R2017b/deployment_files/R2017b/installers/glnxa64/MCR_R2017b_glnxa64_installer.zip" class="button">MCR for Linux</a></li>
            </ul>
            <ul class="actions">
              <li><a href="https://www.neuro.uni-jena.de/cat12/cat12_latest_R2017b_MCR_Win.zip" class="button">CAT12 Standalone for Windows</a></li>
              <li><a href="https://ssd.mathworks.com/supportfiles/downloads/R2017b/deployment_files/R2017b/installers/win64/MCR_R2017b_win64_installer.exe" class="button">MCR for Windows</a></li>
            </ul>
          
            <!-- ################################################################################# -->
            <h4 id="user_stat">CAT user statistics</h4>

            <p></br>CAT12 uses the anonymized IP address (e.g. 192.168.100.xxx) for geolocation and sends information about Matlab version, CAT12 version, computer platform, and error messages to our SBM server. This is invaluable to us to get statistics about the use of CAT12 and more importantly about possible errors and helps us to fix them.</br>
            
            If you don't want to have a unique web analytics cookie identification number assigned to your computer to avoid the aggregation and analysis of data collected on this website, you can select the opt-out option at the bottom of this page.</br>
            
            Furthermore, you can also set the flag "cat.extopts.send_info" in <a href="matlab:open cat_defaults;">cat_defaults.m</a> to "0" to prevent sending any (anonymized) information to our SBM server. However, keep in mind that we need those information to fix possible errors and to get statistics about Matlab and CAT12 versions.</p>
            
            <p></br>Description of CAT12 statistics:</p>
            <ul>
              <li>Start: Information about Matlab version. This data is sent to our SBM server when CAT12 is started and provides the approximate number of (unique) users (see unique pageviews)</li>
              <li>CAT12.X: Information about CAT12 version, computer platform and unsuccessful preprocessings. This data is sent to our SBM server during preprocessing to obtain information about possible errors (see pageviews).</li>
            </ul>
              
<!--            <div id="widgetIframe"><iframe width="100%" height="300" src="http://141.35.69.218/piwik/index.php?module=Widgetize&action=iframe&forceView=1&viewDataTable=graphEvolution&disableLink=0&widget=1&moduleToWidgetize=VisitsSummary&actionToWidgetize=getEvolutionGraph&idSite=1&period=day&date=today&columns=nb_uniq_visitors&disableLink=1&widget=1&language=en" scrolling="yes" frameborder="0" marginheight="0" marginwidth="0"></iframe></div>
-->    
            <a href="http://141.35.69.218/piwik/index.php?module=CoreHome&action=index&idSite=1&period=day&date=today#?idSite=1&period=day&date=today&category=General_Actions&subcategory=Actions_SubmenuPageTitles">Here</a> you can see the CAT12 user statistics from today.
    
            <!-- ############################# -->
            <h5>Which information is sent?</h5>      
            <p>
            <ul>
              <li>Anonymized IP address (e.g. 192.168.100.xxx) is sent to the SBM server for geolocation and to get number of unique users.</li>
              <li>Information about Matlab version is sent when CAT12 is started using the following Matlab command:
                </br><i> urlread(sprintf('http://www.neuro.uni-jena.de/piwik/piwik.php?idsite=1&rec=1&action_name=%s%s%s','Start','%2F',version('-release')));</i>
              </li>
              <li>Information about CAT12 version and computer platform is sent during preprocessing if any errors occurred using the Matlab command:
                </br><i> urlread(sprintf('http://www.neuro.uni-jena.de/piwik/piwik.php?idsite=1&rec=1&action_name=%s%s%s%s%s%s%s',cat_version,'%2F',computer,'%2F',caterr.message,'%2F',str_err));</i>              
              </li>
            </ul>

            <!-- ################################################################################# -->
            <h2 id="methods">Methods</h2>

            <!-- ############################# -->
            <h4 id="vox_proc">Voxel-based processing</h4>      

            <div class="box right"><sup>*</sup> The classic SPM12 segmentation is still used in addition, but only to initially remove non-brain tissue from the image and to get a starting estimate for the segmentation.</div>

            <p>This toolbox is an extension of the segmentation in SPM12, but uses a completely different segmentation approach<b><sup>*</sup></b>.
            See also the section <a href="#process_details">CAT12 Processing Steps in Detail</a> for a detailed overview about the processing steps.</p>
            
            <i>Denoising</i>
            <p>We also use two noise reduction methods to make data processing, and the tissue segmentation in particular, more robust against noise. The first method is a spatial-adaptive Non-Local Means (SANLM) denoising filter and removes noise while maintaining edges (<a href="https://doi.org/10.1002/jmri.22003">Manjon et al., 2010</a>) and is implemented as a pre-processing step. The second method is a classical Markov Random Field (MRF) approach, which includes spatial information from adjacent voxels in the segmentation estimation (<a href="https://doi.org/10.1109/42.563663">Rajapakse et al., 1997</a>) and is part of the AMAP segmentation. The strength of the filters is automatically determined by estimating the residual noise in the image or can be set manually.</p>
            
            <i>Interpolation</i>
            <p>CAT12 uses an internal interpolation to provide more reliable results even with low resolution images and anisotropic spatial resolutions. Although interpolation cannot add more details to the images, some of the functions used benefit from the higher number of voxels and the usual strip artefacts in modulated images are greatly reduced.</p>
            
            <i>Affine Preprocessing (APP)</i>
            <p>To improve the initial SPM segmentation, an initial affine registration is applied to a bias-corrected image and the intensity range is limited to avoid problems in special protocols. If the preprocessing fails a more aggressive version is available that applies a rough bias correction and removes non-brain parts of the brain before the initial affine registration.</p>
            
            <i>Local Adaptive Segmentation (LAS)</i>
            <p>GM intensity can vary for different regions such as the motor cortex, the basal ganglia, or the occipital lobe. These changes have an anatomical background (e.g. iron content, myelenization), but are dependent on the MR-protocol and often lead to GM-underestimations at higher intensities and CSF-overestimations at lower intensities. Therefore, a local intensity transformation of all tissue classes is used to reduce these effects in the image before the final AMAP segmentation. The strength of the changes is controlled by the LASstr parameter, with 0 for no LAS, small values (0.01-0.5) for small adjustments, 0.5 for medium adjustments (default), and higher values (0.5-1) for strong adjustments.</p>
            
            <i>AMAP Segmentation</i>
            <p>The segmentation approach is based on an Adaptive Maximum A Posterior (AMAP) technique without the need for a priori information on the tissue probabilities. This means that the Tissue Probability Maps (TPM) are not constantly used in the sense of the classical Unified Segmentation approach (<a href="https://doi.org/10.1016/j.neuroimage.2005.02.018">Ashburner and Friston, 2005</a>), but only for spatial normalization, initial skull-stripping, and as initial segmentation estimate. The subsequent AMAP estimation is adaptive in the sense that local variations of the parameters (i.e., means and variance) are modelled as slowly varying spatial functions (<a href="https://doi.org/10.1109/42.563663">Rajapakse et al., 1997</a>). This accounts not only for intensity inhomogeneities, but also for other local intensity variations.</p>
            
            <i>Partial Volume Segmentation</i>
            <p>In addition, the segmentation approach uses a Partial Volume Estimation (PVE) with a simplified mixed model of a maximum of two tissue types (<a href="https://doi.org/10.1016/j.neuroimage.2004.05.007">Tohka et al., 2004</a>). We begin with an initial segmentation into three pure classes: gray matter (GM), white matter (WM), and cerebrospinal fluid (CSF) based on the AMAP estimation described above. The initial segmentation is followed by a PVE consisting of two additional mixed classes: GM-WM and GM-CSF. This results in an estimate of the amount (or fraction) of each pure tissue type that is present in each voxel (since single voxels - given their size - probably contain more than one tissue type) and thus allows for more precise segmentation.</p>
            
            <i>Skull-Stripping</i>
            <p>CAT12 provides different approaches for skull-stripping. Currently, the method with the most accurate and reliable results is an adaptive probability region-growing (APRG) method. It refines the probability maps of the SPM approach by region-growing techniques of the GCUT approach with a final surface-based optimization strategy.</p>
            <p>The SPM approach works also quite stable for the majority of data. However, in some rare cases parts of GM (i.e. in frontal lobe) might be cut. If this happens the GCUT approach is a good alternative. GCUT is a graph-cut/region-growing approach starting from the WM area.</p>
            <p>If your segmentations still contain skull and other non-brain tissue (e.g. dura) using the GCUT approach you can try to increase the strength in expert mode. The strength is defined with 0 for a more liberal and wider brain mask and 1 for a more aggressive skull-stripping. The default setting is 0.5 and has been successfully tested on a variety of different images. Thus, if parts of the brain are missing in the segmentations, the strength can be decreased.</p>
            
            <i>Cleanup</i>
            <p>CAT12 includes a new cleanup routine that uses morphological, distance and smoothing operations to remove the remaining meninges after the final segmentation. The strength of the cleanup is controlled by the cleanupstr parameter, with 0 for no cleanup, low values &lt;0.5 for light cleanup, 0.5 for medium cleanup (default), and 1 for strong cleanup.</p>
            
            <i>Spatial Normalization</i>
            <div class="box right"><sup>*</sup> Therefore, no additional MNI normalization is necessary.<br>
            <sup>**</sup> For studies investigating children data, I still recommend creating a customized DARTEL or Geodesic Shooting template. However, it should be noted that this option requires a representative sample with a sufficient number of subjects.</div>

            <p>Another important extension of the SPM12 segmentation is the integration of the Geodesic Shooting (<a href="https://doi.org/10.1016/j.neuroimage.2010.12.049">Ashburner and Friston, 2011</a>) or the older DARTEL (<a href="https://doi.org/10.1016/j.neuroimage.2007.07.007">Ashburner, 2007</a>) normalization into the toolbox by already existing DARTEL and Geodesic Shooting templates in MNI space. 
            These templates were derived from 555 healthy control subjects of the IXI-database (http://www.brain-development.org) and are available in the MNI space<b><sup>*</sup></b> for six different iteration steps of the DARTEL and Geodesic Shooting normalization. 
            Therefore, the creation of sample-specific DARTEL and Geodesic Shooting templates is no longer necessary for most studies<b><sup>**</sup>.</b><br>
            An excellent overview about the <a href="https://www.lead-dbs.org/about-the-mni-spaces/">different MNI spaces</a> can be found on the DBS site from Andreas Horn.</p>
            
            <i>White Matter Hyperintensity Correction (WMHC)</i>
            <p>The greater dependency of AMAP PVE segmentation on image intensities requires detection and handling of <i>White Matter Hyperintensities</i> (WMHs, <a href="https://dx.doi.org/10.13140/RG.2.2.26753.20326">Dahnke et al. 2019)</a>.
            An atlas-region-growing strategy is used to detect WMHs and assign them to GM (like in VBM8, default), WM, or as a separate class. 
<!--            For details see <a href="cat_methods_WMHC.html">WMHC</a>.</p> -->
            
            <i>Stroke Lesion Correction (SLC)</i></p>
            <p>To avoid improper volumetric deformations in stroke lesions, CAT allows to suppress strong (high-frequent) deformation in the Dartel/Shooting registration schemes (<a href="#Fig1">Figure 1</a>). 
            The lesions have to be set to zero (e.g., by using the  <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.maskimg');">Manual image (lesion) masking</a> batch) and the SLC flag has to be activate in the <a class="function" href="matlab:cat('expert');">expert mode</a> of CAT.
            The functions are still in development and a customized surface registration has not yet been implemented.</p> 

            <!-- ################################################################################# -->
            <h4 id="surf_proc">Surface-based preprocessing</h4>
            <p>
              CAT12 also includes the estimation of the cortical thickness and central surface of the left and right hemispheres based on the projection-based thickness (PBT) method <a href="https://neuro-jena.github.io/pdf/Dahnke-NI12.pdf">(Dahnke et al. 2012)</a>. 
              Furthermore, the surface pipeline uses topology correction <a href="https://neuro-jena.github.io/pdf/Yotter-HBM10.pdf">(Yotter et al. 2011a)</a>, spherical mapping <a href="https://neuro-jena.github.io/pdf/Yotter-JoN10.pdf">(Yotter et al. 2011b)</a> and estimation of local surface complexity <a href="https://neuro-jena.github.io/pdf/Yotter-NI11.pdf">(Yotter et al. 2011c)</a> and local gyrification <a href="https://neuro-jena.github.io/pdf/Luders-NI06.pdf">(Luders et al. 2006)</a>.
            </p> 
                        
            <i>Cortical thickness and central surface estimation</i>
            <p>
              We use a fully automated method that allows for measurement of cortical thickness and reconstructions of the central surface in one step. It uses a tissue segmentation to estimate the white matter (WM) distance, then projects the local maxima (which is equal to the cortical thickness) to other gray matter voxels by using a neighbor relationship described by the WM distance. This projection-based thickness (PBT) allows the handling of partial volume information, sulcal blurring, and sulcal asymmetries without explicit sulcus reconstruction <a href="https://neuro-jena.github.io/pdf/Dahnke-NI12.pdf">(Dahnke et al. 2012)</a></p> 
              
            <i>Topology Correction</i>
            <p>
              The initial central surface usually contains small topology defects (handles and holes) in problematic regions such as the medial temporal lobe that have to be removed for a correct spherical projection to the average surface. 
              In order to repair topological defects we use a novel method that relies on spherical harmonics <a href="https://neuro-jena.github.io/pdf/Yotter-HBM10.pdf">(Yotter et al. 2011a)</a>. First, the original MRI intensity values are used as a basis to select either a "fill" or "cut" operation for each topological defect. We modify the spherical map of the uncorrected brain surface mesh, such that certain triangles are favored while searching for the bounding triangle during reparameterization. Then, a low-pass filltered alternative reconstruction based on spherical harmonics is patched into the reconstructed surface in areas that previously contained defects
            </p>
            
            <i>Spherical Mapping</i>
            <p>
              A spherical map of a cortical surface is usually necessary to reparameterize the surface mesh into a common coordinate system to allow inter-subject analysis. We use a fast algorithm to reduce area distortion resulting in an improved reparameterization of the cortical surface mesh <a href="https://neuro-jena.github.io/pdf/Yotter-JoN10.pdf">(Yotter et al. 2011b)</a>.
            </p>
            
            <i>Spherical Registration</i>
            <p>
              We have adapted the volume-based diffeomorphic Dartel algorithm to the surface <a href="https://dx.doi.org/10.1016/j.neuroimage.2007.07.007">(Ashburner 2007)</a> to work with spherical maps <a href="https://www.academia.edu/download/30706385/Yotter02.pdf">(Yotter et al. 2011d)</a>. We apply a multi-grid approach that uses reparameterized values of sulcal depth and shape index defined on the sphere to estimate a flow field that allows deforming a spherical grid
            </p>
            
            <i>Further Surface Measures</i>
            <p>
              Besides cortical thickness, further measures of brain folding and data mapping are available after surface reconstruction in the <i>'Extract & Map Surface Data...'</i> menu. 
              <!-- folding -->
              The <a class="function" href="matlab:spm_jobman('interactive'','','spm.tools.cat.stools.surfextract')">Extract Additional Surface Parameters</a>  batch allows estimation of the folding measure by the absolute mean curvature <i>(Gyrification)</i> <a href="https://neuro-jena.github.io/pdf/Luders-NI06.pdf">(Luders et al. 2006)</a>, the depth of sulci or the measurement of local surface complexity by the fractal dimension <a href="https://neuro-jena.github.io/pdf/Yotter-NI11.pdf">(Yotter et al. 2011c).</a> 
              <!-- value mapping -->
              Moreover, 3D volume data (e.g. fMRI data) can be mapped to the individual surface to benefit from enhanced surface-based smoothing and registration. 
              The mapping can by applied to volumes from the same <a class="function" href="matlab:spm_jobman('interactive'','','spm.tools.cat.stools.vol2surf')">native space</a>, e.g., for cortical myelination measures, or <a class="function" href="matlab:spm_jobman('interactive'','','spm.tools.cat.stools.cat_surf_coregvol2surf')">nonlinear co-registered volumes,</a> such as fMRI images. This mapping can also be applied to <a class="function" href="matlab:spm_jobman('interactive'','','spm.tools.cat.stools.vol2surftemp')">normalized volumes</a> without individual surfaces to map results in MNI space to the template surface.
              <!-- link -->
<!--              See <a href="cat_tools_SBM.html">surface tools</a> for further information. -->
            </p>

            <!-- ################################################################################# -->
            <h4 id="atlas">Atlas creation and ROI based analysis</h4>
            <p>
              CAT12 allows estimation of tissue volumes (and additional surface parameters such as cortical thickness, gyrification or fractal dimension) for different volume and surface-based atlas maps.
              The mean values within a ROI for volume data (e.g. gray matter volume) are given im mL, while surface ROI values represent the mean value of the surface measures (e.g. thickness).
              The results are stored as XML files in the <em>label</em> directory. 
              The XML file <em>catROI[s]_*.xml</em> contains information of all atlases as data structure for one dataset and the optional <em>s</em> indicates surface atlases. 
              If the option "cat.output.ROI" in <a href="matlab:edit('cat_defaults');">cat_defaults.m</a> is set to "0" no ROI XML files are saved and you have to set this parameter to "1" and preprocess the data again if you are interested in ROI analysis of volume data (for surface data these XML files are always extracted after preprocessing, thus it is not necessary to do this for surface data). If this option is enabled you can select the different atlases in the batch GUI.
            </p>
            
            <!-- ############################# -->
            <h5 id="Analysis">Additional steps for surface data</h5>
            <p>
              While ROI-based values for VBM (volume) data are automatically saved in the <em>label</em> folder as XML file it is necessary to additionally extract these values for surface data (except for thickness which is automatically extracted during segmentation). This has to be done after preprocessing the data and creating cortical surfaces. 
              You can extract ROI-based values for cortical thickness but also for any other surface parameter that was extracted using the <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.stools.surf2roi');">Extract Additional Surface Parameters</a> function.   
            </p>
            
            <!-- ############################# -->
            <h5 id="stat_analysis">Statistical analysis of ROI data</h5>
            <p>
              Finally, the XML files of several subjects can be analyzed using an already existing SPM design with <a class="function" href="matlab:cat_stat_analyze_ROIs;">Analyze ROIs</a>. Here, the SPM.mat file is used in order to get information about all respective label files, but also about your design (including all covariates/confounds that you have modeled). Thus, the same statistical analysis that is saved in the SPM.mat file is applied to your ROI data. You can then select a contrast, a threshold and a measures to analyze (e.g. Vgm, Vwm, thickness, gyrification...) and can choose between different atlas maps. The results will be printed and saved as thresholded log-p volume or surface map:</p>
            <ul>
              <li>logPThreshold_NameOfContrast_NameOfAtlas_Measure.nii</li>
              <li>[lr]h.logPThreshold_NameOfContrast_NameOfAtlas_Measure.gii</li>
            </ul>
            
            <p>
              These maps can be optionally visualized using <a class="function" href="matlab:cat_vol_slice_overlay;">overlay selected slices</a> for volume maps or <a class="function" href="matlab:y=cat_surf_results;">Surface Overlay</a> for surface maps.<br>
              In order to analyze different measures (e.g. Vgm/Vwm for volumes or thickness/gyrification for surfaces) you can use any existing volume-based analysis to extract different volume measures or any existing surface-based analysis to extract different surface measures. To give an example: An existing SPM.mat file with a VBM analysis of GM allows you to analyze ROI measures for both, GM as well as WM. Thus, it is not necessary to have a SPM.mat file of a VBM analysis of WM. The same holds for surface-based analysis. If you have an existing SPM.mat for the analysis of cortical thickness you can also estimate ROI analysis for gyrification or fractal dimension. However, it is necessary to extract before ROI-based measures for each subject using <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.stools.surf2roi');">Extract Additional Surface Parameters</a>.<br>    
              For ROI analysis of surfaces you can select the SPM.mat file of the analysis either for the left or right hemisphere or the merged hemispheres. The design should be the same and the ROI results will be always estimated for both hemispheres.<br>
              Please note, that if you have moved your data after estimating your original voxel- or surfaced-based statistics the needed ROI files cannot be found.
            </p>
            
            <!-- ############################# -->
            <h5 id="Extraction">Optional extraction of ROI data</h5>
            <p>
              Optionally, the XML files of several subjects can be also combined and saved for further analysis as CSV file using the <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.calcroi');">Estimate Mean Values inside ROI</a> function. 
              For each measure (e.g. ''Vgm'' for gray matter volume) and each atlas a separate CSV file is written. This works for both volume as well as surface data, but volume and surface data has to be processed separately using this function (surface-based ROI values are indicated by an additional <em>s</em>, e.g. ''catROIs_'').    
              You can use external software such as Excel or SPSS to read the resulting CSV files for further analysis. Take also care of the different interpretation between "." and "," depending on your region and language settings on your system.
              The mean values within a ROI for volume data (e.g. gray matter volume) are given im mL, while surface ROI values represent the mean value of the surface measures (e.g. thickness).
            </p>
            
            <!-- ############################# -->
            <h5 id="Atlas">Use of atlas maps</h5>
            <p>
              Moreover, you can use the volume-based atlases that are provided with CAT also as atlas maps with <em>SPM atlas functions</em>. This is especially helpful if you have used the default VBM processing pipeline because the CAT12 atlas maps are then in the same Shooting space as your data. 
              Thus, if you have used the default VBM processing pipeline it is strongly recommended to use the CAT12 atlases in Shooting space (indicated in the name by a leading ''cat12_'') rather than the SPM Neuromorphometrics atlas.
              In order to use CAT12 atlases you have to call the <a class="function" href="matlab:cat_install_atlases">cat_install_atlases</a> function once that will copy the atlases to SPM.
              Atlas maps for surfaces can be used with <a class="function" href="matlab:y=cat_surf_results;">Surface Overlay</a>. Here, the data cursor function allows you to display atlas regions under the cursor. Furthermore, you can use the ''Atlas labeling'' function to print a list of atlas regions of the resulting clusters.
            </p>
               
            <ul>
              <li><a href="#volrois">List of volume-based atlas maps (located in templates_MNI152NLin2009cAsym)</a>
              <ul>
                <li><a href="#Neuromorphometrics">Neuromorphometrics</a></li>
                <li><a href="#LPBA">LPBA40</a></li>
                <li><a href="#Hammers">Hammers</a></li>
                <li><a href="#Cobra">Cobra</a></li>
                <li><a href="#IBSR">IBSR</a></li>
                <li><a href="#Thalamus">Thalamus</a></li>
                <li><a href="#ThalamicNuclei">Thalamic Nuclei</a></li>
                <li><a href="#Mori">Mori</a></li>
                <li><a href="#AAL3">AAL3</a></li>
                <li><a href="#Anatomy">Anatomy3</a></li>
                <li><a href="#JulichBrain">JulichBrain</a></li>
                <li><a href="#Schaefer">Local-Global Intrinsic Functional Connectivity Parcellation by Schaefer</a></li>
                <li><a href="#SUIT">SUIT</a></li>
              </ul></li>
              <li><a href="#surfrois">List of Freesurfer surface-based atlas maps (located in atlases_surfaces or atlases_surfaces_32k)</a>
              <ul>
                <li><a href="#FS_DK40">DK40</a></li>
                <li><a href="#FS_Destrieux2009">Destrieux</a></li>
                <li><a href="#FS_HCP">Human Connectome Project (HCP) Multi-Modal Parcellation</a></li>
                <li><a href="#FS_Schaefer">Local-Global Intrinsic Functional Connectivity Parcellation by Schaefer</a></li>
              </ul></li>
            </ul>
      
      
            <!-- ###################################### -->
            <h5 id="volrois">List of volume-based atlas maps in CAT12</h5>
            <p>
              We prepared different atlas maps for the MNI152NLin2009cAsym space that are stored in the <em>templates_MNI152NLin2009cAsym</em> directory. 
              For each atlas you can find a CSV file with the ROI IDs, short and full names. 
              The txt-file contains further information, terms of use, and the name of the original publications and websites. 
              If original T1 maps and subject label maps were available we used CAT to preprocess the data and map them to common space. 
              The subject dependent labels were translated to the CAT name system.<br>
              An excellent overview about the <a href="https://www.lead-dbs.org/about-the-mni-spaces/">different MNI spaces</a> can be found on the DBS site from Andreas Horn.
            </p>
            <p>
            </p>
            
            <a class="function" href="matlab:cat_vol_display_label(struct('data',{{
                fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); 
                fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','neuromorphometrics.nii');
                fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','lpba40.nii');
                fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','hammers.nii');}} ) )">Display all three volumetric atlas maps.</a> 
       
            <h6 id="Neuromorphometrics">Neuromorphometrics</h6>
            <p>
              Maximum probability tissue labels derived from the "MICCAI 2012 Grand Challenge and Workshop on Multi-Atlas Labeling" 
              (<a href="http://www.neuromorphometrics.com/2012_MICCAI_Challenge_Data.html">Details</a>). 
              These data were released under the Creative Commons Attribution-NonCommercial (CC BY-NC) with no end date. 
              Users should credit the MRI scans as originating from the <a href="http://www.oasis-brains.org/">OASIS project</a> and the labeled data as "provided by Neuromorphometrics, Inc. <a href="http://Neuromorphometrics.com/">http://Neuromorphometrics.com/</a> under academic subscription". 
              <!--These references should be included in all workshop and final publications.-->
            </p><p>
              Display Neuromorphometrics atlas as 
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','neuromorphometrics.nii')}}))">volume map</a>.
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','neuromorphometrics.txt'));">here</a>.
            <p style="text-align:center;"><img src="images/CAT_surf_atlas_neuromorphometrics.png" width=90% alt="Neuromorphometrics (2012)" ><p>

            <h6 id="LPBA">LPBA40</h6>
            <p>
              The LONI Probabilistic Brain Atlas (LPBA40) is a series of maps of brain anatomic regions <a href="#Shattuck2008">(Shattuck et al. 2008)</a>. 
              These maps were produced from a set of whole-head MRI of 40 human volunteers. 
              Each MRI was manually delineated to identify a set of 56 structures in the brain, most of which are within the cortex. 
              These delineations were then transformed into a common atlas space to produce a set of coregistered anatomical labels. 
              The original MRI data were also transformed into the atlas space.
            </p><p>
              Display LPBA40 atlas as <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','lpba40.nii')}}))">volume map</a>.
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','lpba40.txt'));">here</a>.
            <p style="text-align:center;"><img src="images/CAT_surf_atlas_lpba40.png" width=90% alt="LPBA40 (Shattuck et al. 2008)" ><p>

            <h6 id="Hammers">Hammers</h6>
            <p>
              This atlas, based on Alexander Hammers' brain atlas based on 20 subjects, made available for the Euripides project, Nov 2009 <a href="#Hammers2003">(Hammers et al. 2003</a>,<a href="#Gousias2008">Gousias et al. 2008)</a>. 
            </p><p>
              Display Hammers atlas as 
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','hammers.nii')}}))">volume map</a>.
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','hammers.txt'));">here</a>.
            <p style="text-align:center;"><img src="images/CAT_surf_atlas_hammers.png" width=90% alt="Hammers (Hammers et al. 2003)" ><p>

            <h6 id="Cobra">Cobra</h6>
            <p>
              The Cobra atlas is build from 4 atlases that are provided by the <a href="http://cobralab.ca/atlases">Computational Brain Anatomy Laboratory</a> at the Douglas Institute (CoBra Lab).
              The 4 atlases are based on high-resolution (0.3mm isotropic voxel size) images of the amygdala, hippocampus, subcortical structures and the cerebellum. Please note that the original labels were changed in order to allow a combined atlas.
            </p>
            <p>
              Display the Cobra atlas as 
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','cobra.nii')}}))">volume map</a>. 
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','cobra.txt'));">here</a>.

            <h6 id="IBSR">IBSR</h6>
            <p>
              18 subjectes of the <a href="http://www.nitrc.org/projects/ibsr">IBSR V2</a> dataset, with low quality T1 data, but good label maps. 
            </p>
            <p>
              Display IBSR atlas as 
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','ibsr.nii')}}))">volume map</a>. 
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','ibsr.txt'));">here</a>.

            <h6 id="Mori">Mori</h6>
            <p>
              This atlas is based on the <a href="http://wiki.slicer.org/slicerWiki/index.php/Slicer3:Mori-Atlas_labels">"Slicer3:Mori_Atlas_labels_JHU-MNI_SS_Type-II"</a> atlas of Version 2010-05 <a href="#Oishi">by Oishi et al. 2009</a>. 
            </p>
            <p>
              Display Mori atlas as
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','mori.nii')}}))">volume map</a>.
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','mori.txt'));">here</a>.

            <h6 id="Thalamus">Thalamus</h6>
            <p>
              This atlas is based on the <a href="https://wp.unil.ch/mial/probabilistic-atlas-of-thalamic_nuclei/">atlas of human thalamic nuclei</a> <a href="#Najdenovska">by Najdenovska et al. 2018</a>. 
            </p>
            <p>
              Display Thalamus atlas as
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','thalamus.nii')}}))">volume map</a>.
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','thalamus.txt'));">here</a>.

            <h6 id="ThalamicNuclei">Thalamic Nuclei</h6>
            <p>
              This atlas is based on the <a href="https://github.com/thalamicseg/thomas_new/">atlas of human thalamic nuclei</a> <a href="#Saranathan">by Saranathan et al. 2021</a>. 
            </p>
            <p>
              Display Thalamic nuclei atlas as
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','thalamic_nuclei.nii')}}))">volume map</a>.
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','thalamic_nuclei.txt'));">here</a>.


            <h6 id="AAL3">AAL (Automated Anatomical Labeling) version 3</h6>
            <p>
              Parcellation aligned on Collins brain <a href="#Collins1998">(Collins et al. 1998,</a><a href="#Tzourio2002">Tzourio-Mazoyer et al. 2002)</a>.
            </p>
            <p>            
              Display AAL3 atlas as <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','aal3.nii')}}))">volume map</a>
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','aal3.txt'));">here</a>.

            <h6 id="Anatomy">Anatomy version 3</h6>
            <p>
              This atlas is based on <a href="http://www.fz-juelich.de/inm/inm-1/DE/Forschung/_docs/SPMAnatomyToolbox/SPMAnatomyToolbox_node.html">probabilistic cytoarchitectonic maps and functional imaging data
            </a> by <a href="#Eickhoff2005">Eickhoff et al. 2005.</a>
            </p>
            <p>
              Display Anatomy atlas as
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','anatomy3.nii')}}))">volume map</a>.
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','anatomy3.txt'));">here</a>.

            <h6 id="JulichBrain">JulichBrain</h6>
            <p>
              This atlas is based on <a href="https://kg.ebrains.eu/search/instances/Dataset/3fde2768-e845-4fc3-a425-61e2c1fb6db7">whole-brain parcellation of the Julich-Brain Cytoarchitectonic Atlas (v2.6)</a> by <a href="#Amunts2020">Amunts et al. 2020.</a>
            </p>
            <p>
              Display Anatomy atlas as
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','julichbrain.nii')}}))">volume map</a>.
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','julichbrain.txt'));">here</a>.

            <h6 id="Schaefer">Local-Global Intrinsic Functional Connectivity Parcellation</h6>
            <p>
              These <a href="https://github.com/ThomasYeoLab/CBIG/tree/master/stable_projects/brain_parcellation/Schaefer2018_LocalGlobal">atlases</a> by <a href="#Schaefer2018">Schaefer et al. 2018</a> are available for different numbers of parcellations (100, 200, 400, 600) and are based on resting state data from 1489 subjects. 
            </p>
            <p>
              Display the Schaefer atlas with 200 parcellations and 17 networks as 
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Schaefer2018_200Parcels_17Networks_order.nii')}}))">volume map</a>. 
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','schaefer.txt'));">here</a>.

            <h6 id="SUIT">Atlas of the human cerebellum</h6>
            <p>
              This atlas by <a href="#Diedrichsen2009">Diedrichsen et al. 2009</a> is based on <a href="https://github.com/DiedrichsenLab/cerebellar_atlases">atlas of the human cerebellum</a>.
            </p>
            <p>
              Display the SUIT atlas as 
              <a class="function" href="matlab:cat_vol_display_label(struct('data',{{fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','Template_T1.nii'); fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','suit.nii')}}))">volume map</a>. 
            </p>
            You can find more information about this atlas <a href="matlab:edit(fullfile(fileparts(which('cat12')),'templates_MNI152NLin2009cAsym','suit.txt'));">here</a>.
            <br>
            
            <!-- ###################################### -->
            <h5 id="surfrois">List of surface-based atlas maps (FreeSurfer)</h5>
            <p>
              We also prepared different surface atlas maps for the Freesurfer and HCP (32k) space that are stored in the <em>atlases_surfaces(_32k)</em> directories. 
              You can find more information about the atlases in <a href="matlab:edit(fullfile(fileparts(which('cat12')),'atlases_surfaces','atlases_surfaces.man'));">atlases_surfaces.man</a>.
            </p>
            <p>
              See <a href="https://surfer.nmr.mgh.harvard.edu/fswiki/CorticalParcellation">Freesurfer WIKI</a> for further information.
            </p>
        
            <h6 id="FS_DK40">Desikan-Killiany (DK40) Atlas</h6>
            <p>
              This atlas is also known as the 'Desikan-Killiany-Tourville' (DKT) cortical atlas. 
              It is a gyral based atlas: ie, a gyrus was defined as running between the bottoms of two adjacent sulci <a href="#DK2006">(Desikan Killiany et al. 2006)</a>. 
              That is, a gyrus includes the part visible on the Pial view + adjacent banks of the sulci limiting this gyrus. 
            </p><p>
              Display DK40 atlas on FreeSurfer average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_DK40.freesurfer.annot')}},'multisurf',0,'usefsaverage',1))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.aparc_DK40.freesurfer.annot')}},'multisurf',0,'usefsaverage',1))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_DK40.freesurfer.annot')}},'multisurf',1,'usefsaverage',1))">both sides</a>
              ), or Shooting average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_DK40.freesurfer.annot')}},'multisurf',0,'usefsaverage',3))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.aparc_DK40.freesurfer.annot')}},'multisurf',0,'usefsaverage',3))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_DK40.freesurfer.annot')}},'multisurf',1,'usefsaverage',3))">both sides</a>
              ). 
            </p>
            <p style="text-align:center;"><img src="images/CAT_surf_atlas_DKT40.png" width=90% alt="Desikan Killiany Tourville et al. 2010" ><p>

            <h6 id="FS_Destrieux2009">Destrieux Atlas (2009)</h6>
            <p>
              This atlas is also known as the 'Destrieux' cortical atlas <a>(Fischl et al. 2004)</a>.
              It is based on a parcellation scheme that first divided the cortex into gyral and sulcal regions, the limit between both being given by the curvature value of the surface. 
              A gyrus only includes the cortex visible on the Pial view, the hidden cortex (banks of sulci) are marked sulcus.
            </p><p>
              Display Destrieux atlas on FreeSurfer average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_a2009s.freesurfer.annot')}},'multisurf',0,'usefsaverage',1))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.aparc_a2009s.freesurfer.annot')}},'multisurf',0,'usefsaverage',1))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_a2009s.freesurfer.annot')}},'multisurf',1,'usefsaverage',1))">both sides</a>
              ), or Shooting average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_a2009s.freesurfer.annot')}},'multisurf',0,'usefsaverage',3))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.aparc_a2009s.freesurfer.annot')}},'multisurf',0,'usefsaverage',3))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_a2009s.freesurfer.annot')}},'multisurf',1,'usefsaverage',3))">both sides</a>
              ). 
            </p>
            <p style="text-align:center;"><img src="images/CAT_surf_atlas_Destrieux.png" width=90% alt="Destrieux 2009" ><p>

            <h6 id="FS_HCP">Human Connectome Project (HCP) Multi-Modal Parcellation</h6>
            <p>
              This atlas is based on delineations based on cortical architecture, function, connectivity, and/or topography in a group of 210 healthy young adults by <a href="#Glasser2016">Glasser et al. 2016.</a>.
            </p><p>
              Display HCP atlas on FreeSurfer average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_HCP_MMP1.freesurfer.annot')}},'multisurf',0,'usefsaverage',1))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.aparc_HCP_MMP1.freesurfer.annot')}},'multisurf',0,'usefsaverage',1))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_HCP_MMP1.freesurfer.annot')}},'multisurf',1,'usefsaverage',1))">both sides</a>
              ), or Shooting average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_HCP_MMP1.freesurfer.annot')}},'multisurf',0,'usefsaverage',3))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.aparc_HCP_MMP1.freesurfer.annot')}},'multisurf',0,'usefsaverage',3))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.aparc_HCP_MMP1.freesurfer.annot')}},'multisurf',1,'usefsaverage',3))">both sides</a>
              ). 
            </p>

            <h6 id="FS_Schaefer">Local-Global Intrinsic Functional Connectivity Parcellation</h6>
            <p>
              These <a href="https://github.com/ThomasYeoLab/CBIG/tree/master/stable_projects/brain_parcellation/Schaefer2018_LocalGlobal">atlases</a> by <a href="#Schaefer2018">Schaefer et al. 2018</a> are available for different numbers of parcellations (100, 200, 400, 600) and are based on resting state data from 1489 subjects. 
            </p>
            <p>
              Display the Schaefer atlas with 200 parcellations and 17 networks on FreeSurfer average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.Schaefer2018_200Parcels_17Networks_order.annot')}},'multisurf',0,'usefsaverage',1))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.Schaefer2018_200Parcels_17Networks_order.annot')}},'multisurf',0,'usefsaverage',1))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.Schaefer2018_200Parcels_17Networks_order.annot')}},'multisurf',1,'usefsaverage',1))">both sides</a>
              ), or Shooting average surface (
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.Schaefer2018_200Parcels_17Networks_order.annot')}},'multisurf',0,'usefsaverage',3))">left</a>,  
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','rh.Schaefer2018_200Parcels_17Networks_order.annot')}},'multisurf',0,'usefsaverage',3))">right</a>,
              <a class="function" href="matlab:cat_surf_display(struct('expert',2,'data',{{fullfile(fileparts(which('cat12')),'atlases_surfaces','lh.Schaefer2018_200Parcels_17Networks_order.annot')}},'multisurf',1,'usefsaverage',3))">both sides</a>
              ). 
            </p>

            <!-- ###################################### -->
            <h5>References for ROI approach</h5>

            <b id="Collins1998">Collins et al. 1998</b>
            <p>
              Collins DL, Zijdenbos AP, Kollokian V, Sled JG, Kabani NJ, Holmes CJ, et al.<br>
              <a href="https://doi.org/10.1109/42.712135">Design and construction of a realistic digital brain phantom.</a><br>
              IEEE Transactions on Medical Imaging 1998; 17: 463-68.
            </p>

            <b id="Amunts2020">Amunts et al. 2020</b>
            <p>
              Amunts K, Mohlberg H, Bludau S, Zilles K.<br>
              <a href="https://doi.org/10.1126/science.abb4588">Julich-Brain - A 3D probabilistic atlas of human brain's cytoarchitecture.</a><br>
              Science 2020, 369, 988-99.
            </p>

            <b id="DK2006">Desikan-Killiany et al. 2006</b>
            <p>
              Desikan RS, Sgonne F, Fischl B, Quinn BT, Dickerson BC, Blacker D, et al.<br>
              <a href="https://doi.org/10.1016/j.neuroimage.2006.01.021">An automated labeling system for subdividing the human cerebral cortex on MRI scans into gyral based regions of interest.</a><br>
              NeuroImage 2006, 31(3):968-80.
           </p>

            <b id="Eickhoff2005">Eickhoff et al. 2005</b>
            <p>
              Eickhoff SB, Stephan KE, Mohlberg H, Grefkes C, Fink GR, Amunts K, Zilles K.<br>
              <a href="https://doi.org/10.1016/j.neuroimage.2004.12.034">A new SPM toolbox for combining probabilistic cytoarchitectonic maps and functional imaging data.</a><br>
              NeuroImage 2005, 25(4), 1325-1335.
           </p>

            <b id="Hammers2003">Hammers et al. 2003</b>
            <p>
              Hammers A, Allom R, Koepp MJ, Free SL, Myers R, Lemieux L, Mitchell TN, Brooks DJ, Duncan JS.<br>
              <a href="https://doi.org/10.1002/hbm.10123">Three-dimensional maximum probability atlas of the human brain, with particular reference to the temporal lobe.</a><br>
              Human Brain Mapping, 19(4), 224-247.
            </p>

            <b id="Glasser2016">Glasser et al. 2016</b>
            <p>
              Glasser MF, Coalson TS, Robinson EC, Hacker CD, Harwell J, Yacoub E, Ugurbil K, Andersson J, Beckmann CF, Jenkinson M, Smith SM, Van Essen DC.<br>
              <a href="https://doi.org/10.1038/nature18933">A multi-modal parcellation of human cerebral cortex.</a><br>
              Nature. 2016 Aug 11;536(7615):171-178.
            </p>

            <b id="Gousias2008">Gousias et al. 2008</b>
            <p>
              Gousias IS, Rueckert D, Heckemann RA, Dyet LE, Boardman JP, Edwards AD, Hammers A.<br>
              <a href="https://dx.doi.org/10.1016/j.neuroimage.2007.11.034">Automatic segmentation of brain MRIs of 2-year-olds into 83 regions of interest.</a><br>
              Neuroimage 2008 Apr 1;40(2):672-684.
            </p>

            <b id="Oishi">Oishi et al. 2009</b>
            <p>
              Oishi K, Faria A, Jiang H, Li X, Akhter K, Zhang J, Hsu JT, Miller MI, van Zijl PC, Albert M, Lyketsos CG, Woods R, Toga AW, Pike GB, Rosa-Neto P, Evans A, Mazziotta J, Mori S.<br>
              <a href="https://doi.org/10.1016/j.neuroimage.2009.01.002">Atlas-based whole brain white matter analysis using large deformation diffeomorphic metric mapping: application to normal elderly and Alzheimer's disease participants.</a><br>
              Neuroimage. 2009 46(2):486-99.
            </p>

            <b id="Najdenovska">Najdenovska et al. 2018</b>
            <p>
              Najdenovska E, Alemn-Gmez Y, Battistella G, Descoteaux M, Hagmann P, Jacquemont S, Maeder P, Thiran JP, Fornari E, Bach Cuadra M.<br>
              <a href="https://doi.org/10.1038/sdata.2018.270">In-vivo probabilistic atlas of human thalamic nuclei based on diffusion- weighted magnetic resonance imaging.</a><br>
              Sci Data. 2018 Nov 27;5:180270.
            </p>

            <b id="Saranathan">Saranathan et al. 2021</b>
            <p>
              Saranathan M, Iglehart C, Monti M, Tourdias T, Rutt B.<br>
              <a href="https://doi.org/10.1038/s41597-021-01062-y">In vivo high-resolution structural MRI-based atlas of human thalamic nuclei.</a><br>
              Sci Data. 2021 Oct 28;8(1):275.
            </p>

            <b id="Schaefer2018">Schaefer et al. 2018</b>
            <p>
              Schaefer A, Kong R, Gordon EM, Laumann TO, Zuo XN, Holmes AJ, Eickhoff SB, Yeo BTT.<br>
              <a href="https://doi.org/10.1093/cercor/bhx179">Local-Global Parcellation of the Human Cerebral Cortex from Intrinsic Functional Connectivity MRI.</a><br>
              Cereb Cortex. 2018 Sep 1;28(9):3095-3114.
            </p>

            <b id="Shattuck2008">Shattuck et al. 2008</b>
            <p>
              Shattuck DW, Mirza M, Adisetiyo V, Hojatkashani C, Salamon G, Narr KL, Poldrack RA, Bilder RM, Toga AW. <br>
              <a href="<https://doi.org/10.1016/j.neuroimage.2007.09.031">Construction of a 3D Probabilistic Atlas of Human Cortical Structures.</a><br>
              NeuroImage 39 (3): 1064-1070.<br>
            </p>


            <!-- ################################################################################# -->
            <h4 id="qc">CAT report and quality control</h4>

            <p>
              CAT now also prints image quality measurements <a href="#Dahnke:2022">(Dahnke et al. 2022)</a> and major global subjects specific measures in addition to the used preprocessing parameters.
              These data are further saved in the "cat_*.xml" files for each subject that can be read by <a class="function" href="matlab:cat_io_xml">cat_io_xml</a>.  
            </p>
            
            <h5>Image quality measures</h5>
            <p>
              Due to the wide range of rating and marking systems, the rating was defined for a percentage range and a numerical scaling that allows mapping to nominal numbers or letters with chromatic variants ("+" and "-") shown in table below. 
              The obtained quality ratings range from 0.5 (100 rating points (rps)) to 10.5 (0 rps) with values around 1 and 2 describing (very) good image quality (grad A and B) and values around 5 (grad E) and higher (grad F, < 50 rps) indicating problematic images.
              The scaling of the QMs was performed on the basis of theoretical aspects and the analysis of synthetic and real MRI data, especially the BWP (Brain Web Phantom; <a href="#Collins:1998">Collins et al. 1998</a>).
            </p> 
            <p style="text-align:center;"><img src="images/cat_qa_rating-table.jpg" width=90% height=auto alt="Quality rating" ><p>
            <p>
              The image quality measures describe the properties of the image before CAT12 processing. 
              They were estimated by using the tissue segmentation and were (nearly) independent of subject sex and health status. 
            </p>
            <ul>
              <li>
                <b>NCR (Noise Contrast Ratio):</b>
                <p>
                  The NCR measures the local standard deviation in the optimized WM segment and is scaled by the minimum tissue contrast.
                </p>
              </li>
              <li>
                <b>ICR  (Inhomogeneity Contrast Ratio):</b>
                <p>
                  The ICR is measured as the global standard deviation within the optimized WM segment and is scaled by the minimum tissue contrast. 
                </p>
              </li> 
              <li>
                <b>RES (RMS resolution):</b>
                <p>
                  To describe the resolution of an image, the RMS value of the voxel size is used. 
                  Outliers with exceptionally low resolutions in one of the <it>x y z</it> dimensions are weighted much stronger than outliers with high resolutions, resulting in an asymmetric penalization. 
                </p>
              </li>
            </ul>
            <p>
              The resulting ratings were combined as weighted average image quality rating <b>IQR</b> <a href="#Dahnke:2022">(Dahnke et al. 2022)</a>. 
              Tests of different databases such as ADNI, IXI, INDI, OASIS, PPMI etc. demonstrated that published data got good quality ratings in general. 
              Please note that <it>excellent</it> rating is defined for extraordinary good images that can be achieved by averaging several ultra high resolution scans on high field systems (e.g. <a href="#Winterburn:2013">Winterburn et al. 2013</a>), 
              and that typical scientific (clinical) data is expected to get just <it>good</it> to <it>satisfactory</it> ratings.
            </p>
            <p style="text-align:center;"><img src="images/cat_qa_rating-distribution.png" width=80% height=auto alt="Quality distribution of large projects" ><p>
            <p>
              Low image quality can lead to underestimation of the GM in most preprocessings <a href="#Reuter:2015">(Reuter et al. 2015</a>, <a href="#Dahnke:2022">Dahnke et al. 2022)</a>.
              The following figure shows the effect of motion artifacts on IQR and the relative GM volume rGMV of a children dataset processed by 5 different tissue segmentations.
            </p> 
            <p style="text-align:center;"><img src="images/cat_qa_expert.png" width=90% height=auto alt="Quality rating" ><p>
                          
            <h5>References for quality control</h5>
            <b id="Collins:1998">Collins et al. 1998</b>
            <p>
              Collins DL, Zijdenbos AP, Kollokian V, Sled JG, Kabani NJ, Holmes CJ, Evans AC. </br>
              <a href="https://doi.org/10.1109/42.712135">
                Design and construction of a realistic digital brain phantom.</br>
              </a>
              IEEE Transactions on Medical Imaging 1998;  17(3), 463-468.
            </p>
            <b id="Dahnke:2022">Dahnke et al. 2022</b>
            <p>
              Dahnke R, Ziegler G, Grokreutz J, Gaser C.</br> 
              Retrospective quality assurance in T1 images.</br> 
              In preparation.
            </p>
            <b id="Reuter:2015">Reuter et al. 2015</b>
            <p>
              Reuter M, Tisdall MD, Qureshi A, Buckner RL, van der Kouwe AJW, Fischl B.</br> 
              <a href="https://doi.org/10.1016/j.neuroimage.2014.12.006">
                Head motion during MRI acquisition reduces gray matter volume and thickness estimates.</br> 
              </a>
              NeuroImage 2015, 107, 107-115.
            </p>
            <b id="Winterburn:2014">Winterburn et al. 2013</b>
            <p>
              Winterburn JL, Pruessner JC, Chavez S, Schira, MM, Lobaugh NJ, Voineskos AN, Chakravarty MM.</br> 
              <a href="https://doi.org/10.1016/j.neuroimage.2013.02.003">
                A novel in vivo atlas of human hippocampal subfields using high-resolution 3 T magnetic resonance imaging.</br> 
              </a>
              NeuroImage 2013, 74, 254-265. 
            </p>

            <!-- ################################################################################# -->
<!--
            <h2 id="faq">FAQ</h2>

            <details>            
              <summary><u>Can I overlay more than one result on the surface?</u></summary>
              Use the following command to allow RGB overlay of up to 3 results: <a class="function" href="matlab:y=cat_surf_results('rgb',spm_select([1 3],'mesh'));">cat_surf_results('rgb',spm_select([1 3],'mesh'));</a><br>
              Please note that the surface maps should be thresholded (i.e. using <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.T2x');">Transform and Threshold SPM-maps</a>)              
            </details>            
            
            <details>            
              <summary><u>The old "Check Sample Homogeneity" tool was quite useful for finding duplicate subjects in large samples. The new homogeneity tool, which uses Z-score, no longer supports this.</u></summary>
              Estimating the Z-score is much faster than calculating the covariance matrix between all scans, especially for larger samples. However, the old tool is still available <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.check_homogeneity');">here</a>.
            </details>            

-->
            <!-- ################################################################################# -->
            <h2 id="cite">Citing CAT12</h2>

            <p>If you use CAT12, please cite the following references in your work:</p>
            
            <p><u>CAT12 (in General)</u><br>
            Gaser C, Dahnke R, Kurth K, Luders E, Alzheimer&quot;s Disease Neuroimaging Initiative. <a href="https://www.biorxiv.org/content/10.1101/2022.06.11.495736">
            A Computational Anatomy Toolbox for the Analysis of Structural MRI Data.</a> bioRxiv.</p>

            <p><u>Surface Estimation</u><br>
            Dahnke R, Yotter RA, Gaser C. <a href="https://doi.org/10.1016/j.neuroimage.2012.09.050">
            Cortical thickness and central surface estimation.</a> Neuroimage. 2013 Jan 15;65:336-48.</p>
            <p>Yotter RA, Dahnke R, Thompson PM, Gaser C. <a href="https://doi.org/10.1002/hbm.21095">
            Topological correction of brain surface meshes using spherical harmonics.</a> Hum Brain Mapp. 2011 Jul;32(7):1109-24.</p>

            <p><u>Cortical Gyrification</u><br>
            Luders E, Thompson PM, Narr KL, Toga AW, Jancke L, Gaser C. <a href="https://doi.org/10.1016/j.neuroimage.2005.08.049">
            A curvature-based approach to estimate local gyrification on the cortical surface.</a> Neuroimage. 2006 Feb 15;29(4):1224-30.</p>
            <p>Cortical Complexity (Fractal Dimension)<br>
            Yotter RA, Nenadic I, Ziegler G, Thompson PM, Gaser C. <a href="https://doi.org/10.1016/j.neuroimage.2011.02.007">
            Local cortical surface complexity maps from spherical harmonic reconstructions.</a> Neuroimage. 2011 Jun 1;56(3):961-73.</p>

            <p><u>Gray Matter Asymmetry</u><br>
            Kurth F, Gaser C, Luders E. <a href="https://doi.org/10.1038/nprot.2015.014">
            A 12-step user guide for analyzing voxel-wise gray matter asymmetries in statistical parametric mapping (SPM).</a> Nat Protoc. 2015 Feb;10(2):293-304.</p>

            <p><u>Anatomical Automatic Labeling Atlas (AAL)</u><br>
            Tzourio-Mazoyer N, Landeau B, Papathanassiou D, Crivello F, Etard O, Delcroix N, et al. <a href="https://doi.org/10.1006/nimg.2001.0978">
            Automated anatomical labelling of activations in spm using a macroscopic anatomical parcellation of the MNI MRI single subject brain.</a> Neuroimage 2002; 15: 273-289.</p>
            <p>Rolls ET, Huang C, Lin C, Feng J, Joliot M. <a href="https://doi.org/10.1016/j.neuroimage.2019.116189">
            Automated anatomical labelling atlas 3.</a> Neuroimage 2020; 206:116189.</p>
            
            <p><u>Thalamus Atlas</u><br>
            Najdenovska E, Alemn-Gmez Y, Battistella G, Descoteaux M, Hagmann P, Jacquemont S, Maeder P, Thiran JP, Fornari E, Bach Cuadra M. <a href="https://doi.org/10.1038/sdata.2018.270">
            In-vivo probabilistic atlas of human thalamic nuclei based on diffusion- weighted magnetic resonance imaging.</a> Sci Data. 2018 Nov 27;5:180270.</p>

            <p><u>Thalamic Nucei Atlas</u><br>
            Saranathan M, Iglehart C, Monti M, Tourdias T, Rutt B. <a href="https://doi.org/10.1038/s41597-021-01062-y">
            In vivo high-resolution structural MRI-based atlas of human thalamic nuclei.</a> Sci Data. 2021 Oct 28;8(1):275.</p>

            <p><u>Hammers Atlas</u><br>
            Gousias IS, Rueckert D, Heckemann RA, Dyet LE, Boardman JP, Edwards AD, Hammers A. <a href="https://dx.doi.org/10.1016/j.neuroimage.2007.11.034">
            Automatic segmentation of brain MRIs of 2-year-olds into 83 regions of interest.</a> Neuroimage 2008 Apr 1;40(2):672-684.</p>

            <p><u>Mori Atlas</u><br>
            Oishi K, Faria A, Jiang H, Li X, Akhter K, Zhang J, Hsu JT, Miller MI, van Zijl PC, Albert M, Lyketsos CG, Woods R, Toga AW, Pike GB, Rosa-Neto P, Evans A, Mazziotta J, Mori S. <a href="https://doi.org/10.1016/j.neuroimage.2009.01.002">
            Atlas-based whole brain white matter analysis using large deformation diffeomorphic metric mapping: application to normal elderly and Alzheimer's disease participants.</a> Neuroimage. 2009 46(2):486-99.</p>

            <p><u>Anatomy Atlas</u><br>
            Eickhoff SB, Stephan KE, Mohlberg H, Grefkes C, Fink GR, Amunts K, Zilles K. <a href="https://doi.org/10.1016/j.neuroimage.2004.12.034">
            A new SPM toolbox for combining probabilistic cytoarchitectonic maps and functional imaging data.</a> NeuroImage 2005, 25(4), 1325-1335.</p>

            <p><u>JulichBrain Atlas</u><br>
            Amunts K, Mohlberg H, Bludau S, Zilles K. <a href="https://doi.org/10.1126/science.abb4588">
            Julich-Brain - A 3D probabilistic atlas of human brain's cytoarchitecture.</a> Science 2020, 369, 988-99.</p>

            <p><u>CoBra Atlas: Hippocampus</u><br>
            Winterburn JL, Pruessner JC, Chavez S, Schira MM, Lobaugh NJ, Voineskos AN, Chakravarty MM. <a href="https://doi.org/10.1016/j.neuroimage.2013.02.003">
            A novel in vivo atlas of human hippocampal subfields using high-resolution 3 T magnetic resonance imaging.</a> Neuroimage. 2013 Jul 1;74:254-65.</p>

            <p><u>CoBra Atlas: Amygdala</u><br>
            Entis JJ, Doerga P, Barrett LF, Dickerson BC. <a href="https://doi.org/10.1016/j.neuroimage.2011.12.073">
            A reliable protocol for the manual segmentation of the human amygdala and its subregions using ultra-high resolution MRI.</a> Neuroimage. 2012 Apr 2;60(2):1226-35.</p>
            
            <p><u>CoBra Atlas: Subcortical Areas</u><br>
            Tullo S, Devenyi GA, Patel R, Park MTM, Collins DL, Chakravarty MM. <a href="https://doi.org/10.1038/sdata.2018.107">
            Warping an atlas derived from serial histology to 5 high-resolution MRIs.</a> Sci Data. 2018 Jun 19;5:180107.</p>
            
            <p><u>CoBra Atlas: Cerebellum</u><br>
            Park MT, Pipitone J, Baer LH, Winterburn JL, Shah Y, Chavez S, Schira MM,Lobaugh NJ, Lerch JP, Voineskos AN, Chakravarty MM. <a href="https://doi.org/10.1016/j.neuroimage.2014.03.037">
            Derivation of high-resolution MRI atlases of the human cerebellum at 3T and segmentation using multiple automatically generated templates.</a> Neuroimage. 2014 Jul 15;95:217-31.</p>
            
            <p><u>LONI Probabilistic Brain Atlas (LPBA40)</u><br>
            Shattuck DW, Mirza M, Adisetiyo V, Hojatkashani C, Salamon G, Narr KL, Poldrack RA, Bilder RM, Toga AW. <a href="https://doi.org/10.1016/j.neuroimage.2007.09.031">
            Construction of a 3D probabilistic atlas of human cortical structures.</a> Neuroimage. 2008 Feb 1;39(3):1064-80.</p>
            
            <p><u>Mori atlas</u><br>
            Oishi K, Faria A, Jiang H, Li X, Akhter K, Zhang J, Hsu JT, Miller MI, van Zijl PC, Albert M, Lyketsos CG, Woods R, Toga AW, Pike GB, Rosa-Neto P, Evans A, Mazziotta J, Mori S. <a href="https://doi.org/10.1016/j.neuroimage.2009.01.002">
            Atlas-based whole brain white matter analysis using large deformation diffeomorphic metric mapping: application to normal elderly and Alzheimer&quot;s disease participants.</a> Neuroimage. 2009 Jun;46(2):486-99.</p>
            
            <p><u>Desikan-Killiany Atlas (DK40)</u><br>
            Desikan RS, Sgonne F, Fischl B, Quinn BT, Dickerson BC, Blacker D, Buckner RL, Dale AM, Maguire RP, Hyman BT, Albert MS, Killiany RJ. <a href="https://doi.org/10.1016/j.neuroimage.2006.01.021">
            An automated labeling system for subdividing the human cerebral cortex on MRI scans into gyral based regions of interest.</a> Neuroimage. 2006 Jul 1;31(3):968-80.</p>
            
            <p><u>Destrieux Atlas</u><br>
            Destrieux C, Fischl B, Dale A, Halgren E. <a href="https://doi.org/10.1016/j.neuroimage.2010.06.010">
            Automatic parcellation of human cortical gyri and sulci using standard anatomical nomenclature.</a> Neuroimage. 2010 Oct 15;53(1):1-15.</p>
            
            <p><u>Human Connectome Project (HCP) Multi-Modal Parcellation</u><br>
            Glasser MF, Coalson TS, Robinson EC, Hacker CD, Harwell J, Yacoub E, Ugurbil K, Andersson J, Beckmann CF, Jenkinson M, Smith SM, Van Essen DC. <a href="https://doi.org/10.1038/nature18933">
            A multi-modal parcellation of human cerebral cortex.</a> Nature. 2016 Aug 11;536(7615):171-178.</p>
            
            <p><u>Local-Global Intrinsic Functional Connectivity Parcellation</u><br>
            Schaefer A, Kong R, Gordon EM, Laumann TO, Zuo XN, Holmes AJ, Eickhoff SB, Yeo BTT. <a href="https://doi.org/10.1093/cercor/bhx179">
            Local-Global Parcellation of the Human Cerebral Cortex from Intrinsic Functional Connectivity MRI.</a> Cereb Cortex. 2018 Sep 1;28(9):3095-3114.</p>
            
            
            <!-- ################################################################################# -->
            <h2 id="refs">References</h2>

            <p>J. Ashburner, K.J. Friston (2005). <a href="https://doi.org/10.1016/j.neuroimage.2005.02.018">
            Unified segmentation.</a> Neuroimage 26(3):839-51.</p>
            
            <p>J. Ashburner (2007): <a href="https://doi.org/10.1016/j.neuroimage.2007.07.007">A fast diffeomorphic image registration algorithm.</a> Neuroimage 38(1):95-113.</p>
            
            <p>J. Ashburner, K.J. Friston (2011). <a href="https://doi.org/10.1016/j.neuroimage.2010.12.049">
            Diffeomorphic registration using geodesic shooting and Gauss-Newton optimisation.</a> Neuroimage 55(3):954-967.</p>
            
            <p>J. Ashburner, G.R. Ridgway (2012). <a href="https://doi.org/10.3389/fnins.2012.00197">
            Symmetric diffeomorphic modeling of longitudinal structural MRI.</a> Front. Neurosci. 6: 197.</p>
            
            <p>E. Luders, P.M. Thompson, K.L. Narr, A.W. Toga, L. Jancke, C. Gaser (2006). <a href="https://doi.org/10.1016/j.neuroimage.2005.08.049">
            A curvature-based approach to estimate local gyrification on the cortical surface.</a> Neuroimage 29(4): 1224-30.</p>
            
            <p>C. Gaser, H.-P. Volz, S. Kiebel, S. Riehemann, H. Sauer (1999). <a href="https://doi.org/10.1006/nimg.1999.0458">
            Detecting structural changes in whole brain based on nonlinear deformations - application to schizophrenia research.</a> Neuroimage 10:107-113.</p>
            
            <p>C. Gaser, I. Nenadic, B. Buchsbaum, E. Hazlett, M. S. Buchsbaum (2001). <a href="https://doi.org/10.1006/nimg.2001.0771">
            Deformation-based morphometry and its relation to conventional volumetry of brain lateral ventricles in MRI.</a> Neuroimage 13:1140-1145.</p>
            
            <p>C. Gaser, R. Dahnke, P.M. Thompson, F. Kurth, E. Luders, Alzheimer&quot;s Disease Neuroimaging Initiative. <a href="https://www.biorxiv.org/content/10.1101/2022.06.11.495736">
            A Computational Anatomy Toolbox for the Analysis of Structural MRI Data.</a> bioRxiv</p>
            
            <p>R. Dahnke, R. Yotter, C. Gaser (2012a). <a href="https://doi.org/10.1016/j.neuroimage.2012.09.050">
            Cortical thickness and central surface estimation.</a> Neuroimage 65: 336-348.</p>
            <p>R. Dahnke, G. Ziegler, C. Gaser (2012b). <a href="http://www.neuro.uni-jena.de/hbm2012/HBM2012-Dahnke02.pdf">Local Adaptive Segmentation.</a> OHBM 2012</p>
            
            <p>R. Desai, E. Liebenthal, E.T. Possing, E. Waldron, J.R. Binder (2005). <a href="https://doi.org/10.1016/j.neuroimage.2005.03.024">
            Volumetric vs. surface-based alignment for localization of auditory cortex activation.</a> Neuroimage 26(4):1019-29.</p>
            
            <p>C.D. Good, I.S. Johnsrude, J. Ashburner, R.N. Henson, K.J. Friston, R.S. Frackowiak (2001). <a href="https://doi.org/10.1006/nimg.2001.0786">
            A voxel-based morphometric study of ageing in 465 normal adult human brains.</a> Neuroimage 14(1 Pt 1):21-36.</p>
            
            <p>I.B. Malone, K.K. Leung, S. Clegg, J. Barnes, J.L. Whitwell, J. Ashburner, N.C. Fox, G.R. Ridgway (2015). <a href="https://doi.org/10.1016/j.neuroimage.2014.09.034">
            Accurate automatic estimation of total intracranial volume: a nuisance variable with less nuisance.</a> Neuroimage 104:366-72.</p>
            
            <p>J. Manjon, P Coupe, L. Marti-Bonmati, D.L. Collins, M. Robles (2010). <a href="https://doi.org/10.1002/jmri.22003">
            Adaptive Non-Local Means Denoising of MR Images With Spatially Varying Noise Levels.</a> Journal of Magnetic Resonance Imaging 31: 192-203.</p>
            
            <p>J.C. Rajapakse, J.N. Giedd, J.L. Rapoport (1997). <a href="https://doi.org/10.1109/42.563663">
            Statistical Approach to Segmentation of Single-Channel Cerebral MR Images.</a> IEEE Trans. Med. Imag. 16(2):176-186.</p>
            
            <p>M. Reuter, B. Fischl (2011). <a href="https://doi.org/10.1016/j.neuroimage.2011.02.076">
            Avoiding asymmetry-induced bias in longitudinal image processing.</a> Neuroimage 57: 19-21.</p>
            
            <p>M. Reuter, H.D. Rosas, B. Fischl (2010). <a href="https://doi.org/10.1016/j.neuroimage.2010.07.020">
            Highly accurate inverse consistent registration: a robust approach.</a> Neuroimage 53: 1181-1196.</p>
            
            <p>J. Tohka, A. Zijdenbos, A. Evans (2004). <a href="https://doi.org/10.1016/j.neuroimage.2004.05.007">
            Fast and robust parameter estimation for statistical partial volume models in brain MRI.</a> Neuroimage 23(1):84-97.</p>
            
            <p>R.A. Yotter, R. Dahnke, P.M. Thompson, C. Gaser (2011a). <a href="https://doi.org/10.1002/hbm.21095">
            Topological Correction of Brain Surface Meshes Using Spherical Harmonics.</a> Human Brain Mapping 32(7): 1109-24. </p>
            
            <p>R.A. Yotter, G. Ziegler, I. Nenadic, P.M. Thompson, C. Gaser (2011b). <a href="https://doi.org/10.1016/j.neuroimage.2011.02.007">
            Local cortical surface complexity maps from spherical harmonic reconstructions.</a> Neuroimage 56(3): 961-973. </p>
            
            <p>R.A. Yotter, P.M. Thompson, C. Gaser (2011c). <a href="https://doi.org/10.1111/j.1552-6569.2010.00484.x">
            Algorithms to Improve the Re-Parameterization of Spherical Mappings of Brain.</a> Journal of Neuroimaging 21(2):e134-47. </p>
            
            <p>R.A. Yotter, G. Ziegler, P.M. Thompson, C. Gaser (2011d). <a href="http://www.neuro.uni-jena.de/hbm2011/Yotter02.pdf">
            Diffeometric Anatomical Registration on the Surface.</a> OHBM 2011</p>

            <p class="hl">04-11-2022<br>
            Christian Gaser <a href="mailto:christian.gaser@uni-jena.de">christian.gaser@uni-jena.de</a><br>
            Florian Kurth <a href="mailto:f.kurth@auckland.ac.nz">f.kurth@auckland.ac.nz</a><br>
            Robert Dahnke <a href="mailto:robert.dahnke@uni-jena.de">robert.dahnke@uni-jena.de</a></p>
            
            </div>
          </section>

        </div>
      </div>

      <!-- Sidebar -->
      <div id="sidebar">
        <div class="inner">

          <!-- Menu -->
            <nav id="menu">
              <ul>
                <li><a href="#intro">Introduction and Overview</a></li>
                <li>
                  <span class="opener">Quick start guide</span>
                  <ul>
                    <li><a href="#vbm_data">VBM data</a></li>
                    <li><a href="#add_surf">Additional surface data</a></li>
                    <li><a href="#add_opts">Additional options</a></li>
                    <li><a href="#errors">Errors during preprocessing</a></li>
                  </ul>
                </li>
                <li><a href="#version">Version information</a></li>
                <li>
                  <span class="opener">How to start</span>
                  <ul>
                    <li><a href="#download">Download and installation</a></li>
                    <li><a href="#starting">Starting the toolbox</a></li>
                    <li><a href="#basic_vbm">Basic VBM analysis (overview)</a></li>
                  </ul>
                </li>
                <li>
                  <span class="opener">Overview of CAT12 processing</span>
                  <ul>
                    <li><a href="#major_process">CAT12 major processing steps</a></li>
                    <li><a href="#process_details">CAT12 processing steps in detail</a></li>
                  </ul>
                </li>
                
                    
                <li>
                  <span class="opener">Preprocessing Data</span>
                  <ul>
                    <li><a href="#module1">First module: Segment Data</a></li>
                    <li><a href="#module2">Second module: display slices (optionally)</a></li>
                    <li><a href="#module3">Third module: Estimate total intracranial volume (TIV)</a></li>
                    <li><a href="#module4">Fourth module: Check sample homogeneity</a></li>
                    <li><a href="#module5">Fifth module: Smooth</a></li>
                  </ul>
                </li>

                <li>
                  <span class="opener">Building the statistical model</span>
                  <ul>
                    <li><a href="#stat_options">General notes and options for statistical models</a></li>
                    <li><a href="#two_sample">Two-sample T-test</a></li>
                    <li><a href="#full_fact">Full factorial model (for a 2x2 Anova)</a></li>
                    <li><a href="#mult_regress">Multiple regression (linear)</a></li>
                    <li><a href="#mult_regress_poly">Multiple regression (polynomial)</a></li>
                    <li><a href="#full_fact_interact">Full factorial model (interaction)</a></li>
                    <li><a href="#full_fact_poly">Full factorial model (polynomial interaction)</a></li>
                    <li><a href="#estimate">Estimating the statistical model</a></li>
                    <li><a href="#ortho">Checking for design orthogonality</a></li>
                    <li><a href="#contrasts">Defining contrasts</a></li>
                  </ul>
                </li>

                <li>
                  <span class="opener">CAT12 for longitudinal data</span>
                  <ul>
                    <li><a href="#long_opt">Optional change of parameters for preprocessing</a></li>
                    <li><a href="#long_process">Preprocessing of longitudinal data</a></li>
                    <li><a href="#long_one">Longitudinal data in one group</a></li>
                    <li><a href="#long_two">Longitudinal data in two (or more) groups</a></li>
                    <li><a href="#long_two_interact">Longitudinal data in two (or more) groups with interaction of covariate by group</a></li>
                    <li><a href="#long_contrast">Contrasts for longitudinal models</a></li>
                  </ul>
                </li>

                <li>
                  <span class="opener">Processing of data such as children</span>
                  <ul>
                    <li><a href="#tpm">Customized tissue probability maps</a></li>
                    <li><a href="#cust_templates">Customized Dartel- or Shooting-Template</a></li>
                  </ul>
                </li>

                <li>
                  <span class="opener">Other variants of computational morphometry</span>
                  <ul>
                    <li><a href="#dbm">Deformation-based morphometry (DBM)</a></li>
                    <li><a href="#sbm">Surface-based morphometry (SBM)</a></li>
                    <li><a href="#roi">Region of interest (ROI) analysis</a></li>
                  </ul>
                </li>

                <li>
                  <span class="opener">Additional information</span>
                  <ul>
                    <li><a href="#reg_info">Spaces after registration</a></li>
                    <li><a href="#naming">Naming convention of output files</a></li>
                    <li><a href="#unix">Calling CAT from the UNIX command line</a></li>
                    <li><a href="#user_stat">CAT user statistics</a></li>
                  </ul>
                </li>

                <li>
                  <span class="opener">Methods</span>
                  <ul>
                    <li><a href="#vox_proc">Voxel-based processing</a></li>
                    <li><a href="#surf_proc">Surface-based processing</a></li>
                    <li><a href="#atlas">Atlas creation and ROI based analysis</a></li>
                    <li><a href="#qc">Quality control</a></li>
                  </ul>
                </li>

<!--
                <li>
                  <span class="opener">Additional tools</span>
                  <ul>
                    <li><a href="#vbm_tool">VBM tools</a></li>
                    <li><a href="#sbm_tool">Surface tools</a></li>
                    <li><a href="#roi_tool">ROI tools</a></li>
                  </ul>
                </li>

                <li><a href="#faq">FAQ</a></li>
-->
                <li><a href="#cite">Citing CAT</a></li>
                <li><a href="#refs">References</a></li>
<!--
                <li>
                  <span class="opener"><a href="supplement.html">Supplement</a></span>
                  <ul>
                    <li><a href="supplement.html#error">Error management</a></li>
                    <li><a href="supplement.html#validation">CAT validation</a></li>
                  </ul>
                </li>
-->
              </ul>
            </nav>

          </div>
        </div>
      </div>

      <!-- Scripts -->
      <script src="js/jquery.min.js"></script>
      <script src="js/browser.min.js"></script>
      <script src="js/breakpoints.min.js"></script>
      <script src="js/util.js"></script>
      <script src="js/main.js"></script>

  </body>
</html>