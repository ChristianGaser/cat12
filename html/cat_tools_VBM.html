<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>CAT12 - Computational Anatomy Toolbox for SPM12</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="stylesheet" type="text/css" href="spm.css" />
    <link rel="stylesheet" type="text/css" href="../spm.css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  
  <body>
    <div id="header" style="background: black url('images/research.jpg') right;">
      <h1><a href="matlab:web('http://www.neuro.uni-jena.de/','-browser');">Structural Brain Mapping Group</a></h1>
      <p>
          <a href="matlab:web('http://dbm.neuro.uni-jena.de/people/christian-gaser','-browser');">Christian Gaser</a> |
          <a href="matlab:web('http://www.neuro.uniklinikum-jena.de','-browser');">Department of Neurology</a> | 
          <a href="matlab:web('http://www.psychiatrie.uniklinikum-jena.de','-browser');">Department of Psychiatry</a> | 
          <a href="matlab:web('http://www.uni-jena.de/en/start_en.html','-browser');">University of Jena</a>
      </p>
      <div id="breadcrumbs">
        <a href="cat.html">CAT</a> > <a href="cat_tools.html">Tools</a> > <a href="cat_tools_VBM.html">Additional volume-based functions</a>
      </div>
    </div>
	
  
    <div id="content">
    
      <h2>Additional volume-based Functions</h2>

      <ul>
        <li><a href="#SANLM">NLM noise filter</a></li>
        <!--
        <li><a href="#ISARNLM">ISARNLM noise filter</a>/li>
        <li><a href="#NLMUS">NLM Upsampling</a>/li>
        -->
        <li><a href="#cat_vol_correct_slice_scaling">Correction of slice-artifacts</a></li>
        <li><a href="#morphops">Morphological operations</a></li>
        <li><a href="#calc_kappa">Kappa and RMS error estimation for test and ground truth images</a></li>
        <li><a href="#data_trimming">Image trimming</a></li> 
        <li><a href="#data_converter">Image data type converter</a></li> 
    </ul>
    
    
        
      <h3><a id="SANLM" class="function" href="matlab:cat_vol_sanlm;">NLM noise filter</a></h3>
      <p>
        The Spatial Adaptive Non Local Means (SANLM) <a  href="#Manjón:2008">(Manjón:2008)</a> is part of the CAT preprocessing but can also be applied to other image modalities. Moreover, most processing pipelines benefit from the denoising.
      </p><p>
        You can use the SANLM filter by calling the <a class="function" href="matlab:cat_vol_sanlm;">cat_vol_sanlm</a> function. 
        See <a class="function" href="matlab:help cat_vol_sanlm;">help cat_vol_sanlm</a> for further options.
      </p>
      <!--
        Update for ISARNLM filter options with example images.  
      -->
      <p style="text-align:center;"><img src="images/background_noise.png" width=80% height=auto alt="Noise and its reduction" ><p>
               
        
      <!-- 
        Internal function that requires c-functions and is just tested on MAC right now.
      -->
      <!--
      <li>
        <h4><a class="function" href="matlab:cat_vol_sanlm;">NLM Filter</a></h4>
        <p>
          The Non Local Means UpSampling (NLMUS) <a  href="#Manjón:2010">(Manjón:2010)</a> is not part of the standard CAT preprocessing. 
        </p><p>
          You can use the NLMUS by calling the <a class="function" href="matlab:cat_vol_nlmus;">cat_vol_nlmus</a> function. 
          See <a class="function" href="matlab:help cat_vol_nlmus;">help cat_vol_nlmus</a> for further options.
        </p>
      </li>
      <br />
      -->
        
      <h3 id="cat_vol_correct_slice_scaling">Correction of slice-artifacts</h3>
      <p>
        For images with slice-artifacts you can use the <a class="function" href="matlab:cat_vol_correct_slice_scaling;">CAT slice corrections</a> (see image).
        You can specify the filter direction and the strength of the filtering. 
        Try to correct only the affected direction. 
        Do not use this correction, if you don't have such kind of artifacts, because it may introduce errors in this case!
      </p>
      <p style="text-align:center;"><img src="images/cat_vol_correct_slice_scaling_768.png" width=80% height=auto alt="Noise and its reduction" ><p>
        
        
      <h3 id="morphops">Morphological operations</h3>
      <p>
        Morphological operations like erosion, dilation, closing and opening of a binary image are available with the <i>cat_vol_morph</i> function. 
        See <a class="function" href="matlab:help cat_vol_morph;">help cat_vol_morph</a> for further information.
      </p>
      <p style="text-align:center;"><img src="images/background_morphops.png" width=80% height=auto alt="Noise and its reduction" ><p>
        
        
        <!--
        <li>
          <h4>Voxeldistance</h4>
          <p>
            Simple voxelbased distance function to replace MATLAB Image Processing Toolbox <i>bwdist</i> function. See <i>help vbdist</i> for help.
          </p><p>
            ... image ... 
          </p>
        </li>
        
        
        <li>
          <h4>3D median filter</h4>
          <p>
            See <i>help cat_vol_median3</i> for help.
          </p><p>
            ... image ... 
          </p>
        </li>
        
        
        
        <li>
          <h4>3d Laplacian filter. </h4>
          <p>
            See <i>help cat_vol_laplace3</i> and <i>help cat_vol_laplace3R</i> for help.
          </p><p>
            ... image ... 
          </p>
        </li>
        -->

      <h3 id="calc_kappa">Kappa and RMS error estimation for test and ground truth data</h3>
      <p>
        The function <a class="function" href="matlab:cat_tst_calc_kappa;">cat_tst_calc_kappa</a> allows the estimation of Cohen's Kappa measure <a  href="#Cohen:1960">(Cohen:1960)</a> and of the RMS error for a set of images with one (e.g. brain mask) or three classes (segment image <i>Yp0</i>). 
        The first input is given by a set of test images, whereas the second input has to be one ground truth image for all or for each test image.
        The output is also saved as <i>*.csv</i> file. <br />
        See <a href="matlab:help cat_tst_calc_kappa;">help cat_tst_calc_kappa</a> for further information.
      <p>
      <!-- Other functions such as ... simgrow, downcut, resize, etc. are not for public use -->
    
    
    <h3 id="data_trimming">Image trimming</h3>
      <p>
        Some images contain large area of air around the head that increases memory and processing time by factor 2 to 6. Although this is not critical in most datasets, the co-registration of high resolution images can result in unfavorable large field of view. The <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.datatrimming')">head trimming tool</a> allows to remove useless air around the image and co-registered volumes. 
      <p>


     <h3 id="data_converter">Image data type converter</h3>
      <p>
        MR volumes often require large amounts of disk-space and the use of lower data precision can help to save disk space. For instance atlas maps with integer values need no double precision and you can use the <a class="function" href="matlab:spm_jobman('interactive','','spm.tools.cat.tools.spmtype')">data type converter</a> to optimize your data. Furthermore, even integer data types allow floating point values. For instance the tissue classification of CAT creates maps with uint8 precision and a data range between 0 and 1 with a step size of ~0.01.
      <p>      
    
      <h3>References:</h3>
      <ul>
        <li>
          <b id="Manjón:2008">Manjón:2008</b>
          <p>
            Manjón JV, Carbonell-Caballero J, Lull JJ, García-Martí G, Martí-Bonmatí L, Robles M.</br>
            MRI denoising using non-local means. </br>
            <a href="matlab:web('https://doi.org/10.1016/j.media.2008.02.004','-browser')">Medical Image Analysis, 2008, 12(4), 514-523.</a>
          </p>
        </li>
        <!--
        <li>
          <b id="Manjón:2010">Manjón:2010</b>
          <p>
            Manjón JV, Carbonell-Caballero J, Lull JJ, García-Martí G, Martí-Bonmatí L, Robles M.
            MRI denoising using non-local means. 
            <a href="matlab:web('https://doi.org/10.1016/j.media.2008.02.004','-browser')">Medical Image Analysis, 2008, 12(4), 514-523.</a>
          </p>
        </li>
        -->
        <li>
          <b id="Cohen:1960">Cohen:1960</b>
          <p>
            Cohen J. A</br>
            Coefficient of Agreement for Nominal Scales. </br>
            Educational and Psychological Measurement, April 1960, Vol. 20 No. 1 37-46.
          </p>
        </li>
      </ul>
    
    <div id="content"><a href="cat_tools.html">< Tools</a></div>  
    <div id="footer">
      <p>Copyright (C) Structural Brain Mapping Group &lt;<a href="mailto:christian.gaser@uni-jena.de">christian.gaser@uni-jena.de</a>&gt;</p>
    </div>
  </body>
</html>
