function [C,XML] = vbm_io_colormaps(Cname,ncolors)
  
  % number of colors:
  if ~exist('Cname','var')
    Cname = 'marks+';
  end
  if ~exist('ncolors','var')
    ncolors = [];
  else 
    if ncolors<1   
      error('MATLAB:vbm_io_colormaps','Need at least one Color');
    elseif ncolors>2^12
      error('MATLAB:vbm_io_colormaps', ...
       'Wow, why do you want to create a rainbow???. Please use less colors or chagne me.\n');
    end
  end
  
  
  % load basic colormap
  switch Cname
    case 'marks+', 
      C = [ 
            0.0000    0.5000    0.0000  % 1 - excellent (dark green)
            0.4000    0.6000    0.1000  % 2 - good      (green)
            1.0000    0.6000    0.4000  % 3 - ok        (yellow-orange)
            1.0000    0.3000    0.0000  % 4 - bad       (red-yellow)
            0.8000    0.2000    0.0000  % 5 - very bad  (red)
            0.6000    0.0000    0.0000  % 6 - unusable  (dark red)
          ];
    case 'marks',
      C = [ %JET
            0.0000    0.0000    0.5625  % 4 - -3              (dark blue)
            0.0000    0.0000    1.0000  % 3 - -2              (blue)
            0.0000    1.0000    1.0000  % 2 - -1              (cyan)
            0.0000    1.0000    0.0000  % 1 -  0 normal case  (green)
            1.0000    1.0000    0.0000  % 2 - +1              (yellow)
            1.0000    0.0000    0.0000  % 3 - +2              (red)
            0.5104    0.0000    0.0000  % 4 - +3              (dark red)
          ];
    % vbm-output
    % GMT output
    % ...
    case 'BCGWHw'
     C = BCGWHw;
    case 'BCGWHn'
     C = BCGWHn;
    
    otherwise, error('MATLAB:vbm_io_colormaps','Unknown Colormap ''%s''\n',Cname);
  end
  if isempty(ncolors), ncolors = size(C,1); end
  
  % interpolate colormap
  if size(C,1)~=ncolors;
    ss    = 1/ncolors;
    [X,Y] = meshgrid(1:ss:size(C,1),1:3);
    C     = interp2(1:size(C,1),1:3,C',X,Y)'; 
    XML   = cellstr([ dec2hex(round(min(255,max(0,C(:,1)*255)))), ...
             dec2hex(round(min(255,max(0,C(:,2)*255)))), ...
             dec2hex(round(min(255,max(0,C(:,3)*255)))) ]);
  end
 
  
end
function C=BCGWHn
  C = [
    0.0392    0.1412    0.4157
    0.0349    0.2366    0.4806
    0.0305    0.3320    0.5455
    0.0261    0.4275    0.6105
    0.0218    0.5229    0.6754
    0.0174    0.6183    0.7403
    0.0131    0.7137    0.8052
    0.0087    0.8092    0.8702
    0.0044    0.9046    0.9351
         0    1.0000    1.0000
         0    0.9163    0.8333
         0    0.8327    0.6667
         0    0.7490    0.5000
         0    0.6653    0.3333
         0    0.5817    0.1667
         0    0.4980         0
         0    0.5984         0
         0    0.6988         0
         0    0.7992         0
         0    0.8996         0
         0    1.0000         0
    0.3333    1.0000         0
    0.6667    1.0000         0
    1.0000    1.0000         0
    1.0000    0.8902         0
    1.0000    0.7804         0
    1.0000    0.6706         0
    1.0000    0.5608         0
    1.0000    0.4510         0
    0.9333    0.3007         0
    0.8667    0.1503         0
    0.8000         0         0
    0.8154    0.0462    0.0603
    0.8308    0.0923    0.1207
    0.8462    0.1385    0.1810
    0.8615    0.1846    0.2413
    0.8769    0.2308    0.3017
    0.8923    0.2769    0.3620
    0.9077    0.3231    0.4223
    0.9231    0.3692    0.4827
    0.9385    0.4154    0.5430
    0.9538    0.4615    0.6033
    0.9692    0.5077    0.6637
    0.9846    0.5538    0.7240
    1.0000    0.6000    0.7843
    0.9974    0.6214    0.7935
    0.9948    0.6429    0.8026
    0.9922    0.6643    0.8118
    0.9895    0.6858    0.8209
    0.9869    0.7072    0.8301
    0.9843    0.7286    0.8392
    0.9817    0.7501    0.8484
    0.9791    0.7715    0.8575
    0.9765    0.7929    0.8667
    0.9739    0.8144    0.8758
    0.9712    0.8358    0.8850
    0.9686    0.8573    0.8941
    0.9660    0.8787    0.9033
    0.9634    0.9001    0.9124
    0.9608    0.9216    0.9216
  ]; 
end
function C=BCGWHw
  C = [
    1.0000    1.0000    1.0000
    0.9569    0.9739    0.9935
    0.9137    0.9477    0.9869
    0.8706    0.9216    0.9804
    0.8386    0.9216    0.9837
    0.8065    0.9216    0.9869
    0.7745    0.9216    0.9902
    0.7425    0.9216    0.9935
    0.7105    0.9216    0.9967
    0.6784    0.9216    1.0000
    0.5654    0.8510    0.8333
    0.4523    0.7804    0.6667
    0.3392    0.7098    0.5000
    0.2261    0.6392    0.3333
    0.1131    0.5686    0.1667
         0    0.4980         0
         0    0.5984         0
         0    0.6988         0
         0    0.7992         0
         0    0.8996         0
         0    1.0000         0
    0.3333    1.0000         0
    0.6667    1.0000         0
    1.0000    1.0000         0
    1.0000    0.8902         0
    1.0000    0.7804         0
    1.0000    0.6706         0
    1.0000    0.5608         0
    1.0000    0.4510         0
    0.9333    0.3007         0
    0.8667    0.1503         0
    0.8000         0         0
    0.8400         0         0
    0.8800         0         0
    0.9200         0         0
    0.9600         0         0
    1.0000         0         0
    1.0000    0.1200    0.1569
    1.0000    0.2400    0.3137
    1.0000    0.3600    0.4706
    1.0000    0.4800    0.6275
    1.0000    0.6000    0.7843
    0.9749    0.5400    0.7808
    0.9498    0.4800    0.7773
    0.9247    0.4200    0.7737
    0.8996    0.3600    0.7702
    0.8745    0.3000    0.7667
    0.8494    0.2400    0.7631
    0.8243    0.1800    0.7596
    0.7992    0.1200    0.7561
    0.7741    0.0600    0.7525
    0.7490         0    0.7490
    0.6992         0    0.6992
    0.6493         0    0.6493
    0.5994         0    0.5994
    0.5496         0    0.5496
    0.4997         0    0.4997
    0.4499         0    0.4499
    0.4000         0    0.4000
         0         0         0
  ]; 
end
